function q_(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var jl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ng(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Dg={exports:{}},_u={},Lg={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yl=Symbol.for("react.element"),K_=Symbol.for("react.portal"),X_=Symbol.for("react.fragment"),Y_=Symbol.for("react.strict_mode"),J_=Symbol.for("react.profiler"),Q_=Symbol.for("react.provider"),Z_=Symbol.for("react.context"),e2=Symbol.for("react.forward_ref"),t2=Symbol.for("react.suspense"),r2=Symbol.for("react.memo"),n2=Symbol.for("react.lazy"),_p=Symbol.iterator;function a2(e){return e===null||typeof e!="object"?null:(e=_p&&e[_p]||e["@@iterator"],typeof e=="function"?e:null)}var Bg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ug=Object.assign,Mg={};function Ns(e,t,r){this.props=e,this.context=t,this.refs=Mg,this.updater=r||Bg}Ns.prototype.isReactComponent={};Ns.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ns.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jg(){}jg.prototype=Ns.prototype;function bh(e,t,r){this.props=e,this.context=t,this.refs=Mg,this.updater=r||Bg}var Ch=bh.prototype=new jg;Ch.constructor=bh;Ug(Ch,Ns.prototype);Ch.isPureReactComponent=!0;var kp=Array.isArray,$g=Object.prototype.hasOwnProperty,Ah={current:null},zg={key:!0,ref:!0,__self:!0,__source:!0};function Wg(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)$g.call(t,n)&&!zg.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:yl,type:e,key:i,ref:s,props:a,_owner:Ah.current}}function i2(e,t){return{$$typeof:yl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Fh(e){return typeof e=="object"&&e!==null&&e.$$typeof===yl}function s2(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Sp=/\/+/g;function nf(e,t){return typeof e=="object"&&e!==null&&e.key!=null?s2(""+e.key):t.toString(36)}function _c(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case yl:case K_:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+nf(s,0):n,kp(a)?(r="",e!=null&&(r=e.replace(Sp,"$&/")+"/"),_c(a,t,r,"",function(c){return c})):a!=null&&(Fh(a)&&(a=i2(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(Sp,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",kp(e))for(var o=0;o<e.length;o++){i=e[o];var l=n+nf(i,o);s+=_c(i,t,r,l,a)}else if(l=a2(e),typeof l=="function")for(e=l.call(e),o=0;!(i=e.next()).done;)i=i.value,l=n+nf(i,o++),s+=_c(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function $l(e,t,r){if(e==null)return e;var n=[],a=0;return _c(e,n,"","",function(i){return t.call(r,i,a++)}),n}function o2(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ar={current:null},kc={transition:null},l2={ReactCurrentDispatcher:Ar,ReactCurrentBatchConfig:kc,ReactCurrentOwner:Ah};function Hg(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:$l,forEach:function(e,t,r){$l(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return $l(e,function(){t++}),t},toArray:function(e){return $l(e,function(t){return t})||[]},only:function(e){if(!Fh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=Ns;Ye.Fragment=X_;Ye.Profiler=J_;Ye.PureComponent=bh;Ye.StrictMode=Y_;Ye.Suspense=t2;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=l2;Ye.act=Hg;Ye.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ug({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=Ah.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)$g.call(t,l)&&!zg.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:yl,type:e.type,key:a,ref:i,props:n,_owner:s}};Ye.createContext=function(e){return e={$$typeof:Z_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Q_,_context:e},e.Consumer=e};Ye.createElement=Wg;Ye.createFactory=function(e){var t=Wg.bind(null,e);return t.type=e,t};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:e2,render:e}};Ye.isValidElement=Fh;Ye.lazy=function(e){return{$$typeof:n2,_payload:{_status:-1,_result:e},_init:o2}};Ye.memo=function(e,t){return{$$typeof:r2,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=kc.transition;kc.transition={};try{e()}finally{kc.transition=t}};Ye.unstable_act=Hg;Ye.useCallback=function(e,t){return Ar.current.useCallback(e,t)};Ye.useContext=function(e){return Ar.current.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e){return Ar.current.useDeferredValue(e)};Ye.useEffect=function(e,t){return Ar.current.useEffect(e,t)};Ye.useId=function(){return Ar.current.useId()};Ye.useImperativeHandle=function(e,t,r){return Ar.current.useImperativeHandle(e,t,r)};Ye.useInsertionEffect=function(e,t){return Ar.current.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return Ar.current.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return Ar.current.useMemo(e,t)};Ye.useReducer=function(e,t,r){return Ar.current.useReducer(e,t,r)};Ye.useRef=function(e){return Ar.current.useRef(e)};Ye.useState=function(e){return Ar.current.useState(e)};Ye.useSyncExternalStore=function(e,t,r){return Ar.current.useSyncExternalStore(e,t,r)};Ye.useTransition=function(){return Ar.current.useTransition()};Ye.version="18.3.1";Lg.exports=Ye;var fe=Lg.exports;const Ph=Ng(fe),c2=q_({__proto__:null,default:Ph},[fe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u2=fe,f2=Symbol.for("react.element"),h2=Symbol.for("react.fragment"),d2=Object.prototype.hasOwnProperty,p2=u2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m2={key:!0,ref:!0,__self:!0,__source:!0};function Vg(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)d2.call(t,n)&&!m2.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:f2,type:e,key:i,ref:s,props:a,_owner:p2.current}}_u.Fragment=h2;_u.jsx=Vg;_u.jsxs=Vg;Dg.exports=_u;var D=Dg.exports,r0={},Gg={exports:{}},Xr={},qg={exports:{}},Kg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(oe,j){var ae=oe.length;oe.push(j);e:for(;0<ae;){var q=ae-1>>>1,b=oe[q];if(0<a(b,j))oe[q]=j,oe[ae]=b,ae=q;else break e}}function r(oe){return oe.length===0?null:oe[0]}function n(oe){if(oe.length===0)return null;var j=oe[0],ae=oe.pop();if(ae!==j){oe[0]=ae;e:for(var q=0,b=oe.length,H=b>>>1;q<H;){var U=2*(q+1)-1,B=oe[U],ee=U+1,xe=oe[ee];if(0>a(B,ae))ee<b&&0>a(xe,B)?(oe[q]=xe,oe[ee]=ae,q=ee):(oe[q]=B,oe[U]=ae,q=U);else if(ee<b&&0>a(xe,ae))oe[q]=xe,oe[ee]=ae,q=ee;else break e}}return j}function a(oe,j){var ae=oe.sortIndex-j.sortIndex;return ae!==0?ae:oe.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,f=null,p=3,h=!1,m=!1,d=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(oe){for(var j=r(c);j!==null;){if(j.callback===null)n(c);else if(j.startTime<=oe)n(c),j.sortIndex=j.expirationTime,t(l,j);else break;j=r(c)}}function _(oe){if(d=!1,w(oe),!m)if(r(l)!==null)m=!0,ne(S);else{var j=r(c);j!==null&&Q(_,j.startTime-oe)}}function S(oe,j){m=!1,d&&(d=!1,g(R),R=-1),h=!0;var ae=p;try{for(w(j),f=r(l);f!==null&&(!(f.expirationTime>j)||oe&&!X());){var q=f.callback;if(typeof q=="function"){f.callback=null,p=f.priorityLevel;var b=q(f.expirationTime<=j);j=e.unstable_now(),typeof b=="function"?f.callback=b:f===r(l)&&n(l),w(j)}else n(l);f=r(l)}if(f!==null)var H=!0;else{var U=r(c);U!==null&&Q(_,U.startTime-j),H=!1}return H}finally{f=null,p=ae,h=!1}}var E=!1,k=null,R=-1,C=5,N=-1;function X(){return!(e.unstable_now()-N<C)}function A(){if(k!==null){var oe=e.unstable_now();N=oe;var j=!0;try{j=k(!0,oe)}finally{j?V():(E=!1,k=null)}}else E=!1}var V;if(typeof x=="function")V=function(){x(A)};else if(typeof MessageChannel<"u"){var T=new MessageChannel,K=T.port2;T.port1.onmessage=A,V=function(){K.postMessage(null)}}else V=function(){v(A,0)};function ne(oe){k=oe,E||(E=!0,V())}function Q(oe,j){R=v(function(){oe(e.unstable_now())},j)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(oe){oe.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,ne(S))},e.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<oe?Math.floor(1e3/oe):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(oe){switch(p){case 1:case 2:case 3:var j=3;break;default:j=p}var ae=p;p=j;try{return oe()}finally{p=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(oe,j){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var ae=p;p=oe;try{return j()}finally{p=ae}},e.unstable_scheduleCallback=function(oe,j,ae){var q=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?q+ae:q):ae=q,oe){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=ae+b,oe={id:u++,callback:j,priorityLevel:oe,startTime:ae,expirationTime:b,sortIndex:-1},ae>q?(oe.sortIndex=ae,t(c,oe),r(l)===null&&oe===r(c)&&(d?(g(R),R=-1):d=!0,Q(_,ae-q))):(oe.sortIndex=b,t(l,oe),m||h||(m=!0,ne(S))),oe},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(oe){var j=p;return function(){var ae=p;p=j;try{return oe.apply(this,arguments)}finally{p=ae}}}})(Kg);qg.exports=Kg;var g2=qg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v2=fe,Gr=g2;function Ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Xg=new Set,Do={};function Ai(e,t){Es(e,t),Es(e+"Capture",t)}function Es(e,t){for(Do[e]=t,e=0;e<t.length;e++)Xg.add(t[e])}var ea=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),n0=Object.prototype.hasOwnProperty,x2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ep={},Tp={};function w2(e){return n0.call(Tp,e)?!0:n0.call(Ep,e)?!1:x2.test(e)?Tp[e]=!0:(Ep[e]=!0,!1)}function y2(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function _2(e,t,r,n){if(t===null||typeof t>"u"||y2(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Fr(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var lr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){lr[e]=new Fr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];lr[t]=new Fr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){lr[e]=new Fr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){lr[e]=new Fr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){lr[e]=new Fr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){lr[e]=new Fr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){lr[e]=new Fr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){lr[e]=new Fr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){lr[e]=new Fr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Rh=/[\-:]([a-z])/g;function Oh(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Rh,Oh);lr[t]=new Fr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Rh,Oh);lr[t]=new Fr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Rh,Oh);lr[t]=new Fr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){lr[e]=new Fr(e,1,!1,e.toLowerCase(),null,!1,!1)});lr.xlinkHref=new Fr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){lr[e]=new Fr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ih(e,t,r,n){var a=lr.hasOwnProperty(t)?lr[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(_2(t,r,a,n)&&(r=null),n||a===null?w2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var aa=v2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zl=Symbol.for("react.element"),Qi=Symbol.for("react.portal"),Zi=Symbol.for("react.fragment"),Nh=Symbol.for("react.strict_mode"),a0=Symbol.for("react.profiler"),Yg=Symbol.for("react.provider"),Jg=Symbol.for("react.context"),Dh=Symbol.for("react.forward_ref"),i0=Symbol.for("react.suspense"),s0=Symbol.for("react.suspense_list"),Lh=Symbol.for("react.memo"),ha=Symbol.for("react.lazy"),Qg=Symbol.for("react.offscreen"),bp=Symbol.iterator;function Xs(e){return e===null||typeof e!="object"?null:(e=bp&&e[bp]||e["@@iterator"],typeof e=="function"?e:null)}var Ct=Object.assign,af;function io(e){if(af===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);af=t&&t[1]||""}return`
`+af+e}var sf=!1;function of(e,t){if(!e||sf)return"";sf=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l=`
`+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{sf=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?io(e):""}function k2(e){switch(e.tag){case 5:return io(e.type);case 16:return io("Lazy");case 13:return io("Suspense");case 19:return io("SuspenseList");case 0:case 2:case 15:return e=of(e.type,!1),e;case 11:return e=of(e.type.render,!1),e;case 1:return e=of(e.type,!0),e;default:return""}}function o0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Zi:return"Fragment";case Qi:return"Portal";case a0:return"Profiler";case Nh:return"StrictMode";case i0:return"Suspense";case s0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Jg:return(e.displayName||"Context")+".Consumer";case Yg:return(e._context.displayName||"Context")+".Provider";case Dh:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Lh:return t=e.displayName||null,t!==null?t:o0(e.type)||"Memo";case ha:t=e._payload,e=e._init;try{return o0(e(t))}catch{}}return null}function S2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return o0(t);case 8:return t===Nh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Na(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Zg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function E2(e){var t=Zg(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Wl(e){e._valueTracker||(e._valueTracker=E2(e))}function ev(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Zg(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ic(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function l0(e,t){var r=t.checked;return Ct({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Cp(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Na(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function tv(e,t){t=t.checked,t!=null&&Ih(e,"checked",t,!1)}function c0(e,t){tv(e,t);var r=Na(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?u0(e,t.type,r):t.hasOwnProperty("defaultValue")&&u0(e,t.type,Na(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ap(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function u0(e,t,r){(t!=="number"||Ic(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var so=Array.isArray;function ds(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Na(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function f0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ee(91));return Ct({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Fp(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ee(92));if(so(r)){if(1<r.length)throw Error(Ee(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Na(r)}}function rv(e,t){var r=Na(t.value),n=Na(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Pp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function nv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function h0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?nv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Hl,av=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Hl=Hl||document.createElement("div"),Hl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Hl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Lo(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var po={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},T2=["Webkit","ms","Moz","O"];Object.keys(po).forEach(function(e){T2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),po[t]=po[e]})});function iv(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||po.hasOwnProperty(e)&&po[e]?(""+t).trim():t+"px"}function sv(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=iv(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var b2=Ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function d0(e,t){if(t){if(b2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ee(62))}}function p0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var m0=null;function Bh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var g0=null,ps=null,ms=null;function Rp(e){if(e=Sl(e)){if(typeof g0!="function")throw Error(Ee(280));var t=e.stateNode;t&&(t=bu(t),g0(e.stateNode,e.type,t))}}function ov(e){ps?ms?ms.push(e):ms=[e]:ps=e}function lv(){if(ps){var e=ps,t=ms;if(ms=ps=null,Rp(e),t)for(e=0;e<t.length;e++)Rp(t[e])}}function cv(e,t){return e(t)}function uv(){}var lf=!1;function fv(e,t,r){if(lf)return e(t,r);lf=!0;try{return cv(e,t,r)}finally{lf=!1,(ps!==null||ms!==null)&&(uv(),lv())}}function Bo(e,t){var r=e.stateNode;if(r===null)return null;var n=bu(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ee(231,t,typeof r));return r}var v0=!1;if(ea)try{var Ys={};Object.defineProperty(Ys,"passive",{get:function(){v0=!0}}),window.addEventListener("test",Ys,Ys),window.removeEventListener("test",Ys,Ys)}catch{v0=!1}function C2(e,t,r,n,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var mo=!1,Nc=null,Dc=!1,x0=null,A2={onError:function(e){mo=!0,Nc=e}};function F2(e,t,r,n,a,i,s,o,l){mo=!1,Nc=null,C2.apply(A2,arguments)}function P2(e,t,r,n,a,i,s,o,l){if(F2.apply(this,arguments),mo){if(mo){var c=Nc;mo=!1,Nc=null}else throw Error(Ee(198));Dc||(Dc=!0,x0=c)}}function Fi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function hv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Op(e){if(Fi(e)!==e)throw Error(Ee(188))}function R2(e){var t=e.alternate;if(!t){if(t=Fi(e),t===null)throw Error(Ee(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Op(a),e;if(i===n)return Op(a),t;i=i.sibling}throw Error(Ee(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(Ee(189))}}if(r.alternate!==n)throw Error(Ee(190))}if(r.tag!==3)throw Error(Ee(188));return r.stateNode.current===r?e:t}function dv(e){return e=R2(e),e!==null?pv(e):null}function pv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=pv(e);if(t!==null)return t;e=e.sibling}return null}var mv=Gr.unstable_scheduleCallback,Ip=Gr.unstable_cancelCallback,O2=Gr.unstable_shouldYield,I2=Gr.unstable_requestPaint,Dt=Gr.unstable_now,N2=Gr.unstable_getCurrentPriorityLevel,Uh=Gr.unstable_ImmediatePriority,gv=Gr.unstable_UserBlockingPriority,Lc=Gr.unstable_NormalPriority,D2=Gr.unstable_LowPriority,vv=Gr.unstable_IdlePriority,ku=null,Bn=null;function L2(e){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(ku,e,void 0,(e.current.flags&128)===128)}catch{}}var En=Math.clz32?Math.clz32:M2,B2=Math.log,U2=Math.LN2;function M2(e){return e>>>=0,e===0?32:31-(B2(e)/U2|0)|0}var Vl=64,Gl=4194304;function oo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Bc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=oo(o):(i&=s,i!==0&&(n=oo(i)))}else s=r&~a,s!==0?n=oo(s):i!==0&&(n=oo(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-En(t),a=1<<r,n|=e[r],t&=~a;return n}function j2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $2(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-En(i),o=1<<s,l=a[s];l===-1?(!(o&r)||o&n)&&(a[s]=j2(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}function w0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function xv(){var e=Vl;return Vl<<=1,!(Vl&4194240)&&(Vl=64),e}function cf(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function _l(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-En(t),e[t]=r}function z2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-En(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Mh(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-En(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var ct=0;function wv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var yv,jh,_v,kv,Sv,y0=!1,ql=[],Ta=null,ba=null,Ca=null,Uo=new Map,Mo=new Map,ma=[],W2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Np(e,t){switch(e){case"focusin":case"focusout":Ta=null;break;case"dragenter":case"dragleave":ba=null;break;case"mouseover":case"mouseout":Ca=null;break;case"pointerover":case"pointerout":Uo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mo.delete(t.pointerId)}}function Js(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Sl(t),t!==null&&jh(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function H2(e,t,r,n,a){switch(t){case"focusin":return Ta=Js(Ta,e,t,r,n,a),!0;case"dragenter":return ba=Js(ba,e,t,r,n,a),!0;case"mouseover":return Ca=Js(Ca,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Uo.set(i,Js(Uo.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Mo.set(i,Js(Mo.get(i)||null,e,t,r,n,a)),!0}return!1}function Ev(e){var t=ai(e.target);if(t!==null){var r=Fi(t);if(r!==null){if(t=r.tag,t===13){if(t=hv(r),t!==null){e.blockedOn=t,Sv(e.priority,function(){_v(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Sc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=_0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);m0=n,r.target.dispatchEvent(n),m0=null}else return t=Sl(r),t!==null&&jh(t),e.blockedOn=r,!1;t.shift()}return!0}function Dp(e,t,r){Sc(e)&&r.delete(t)}function V2(){y0=!1,Ta!==null&&Sc(Ta)&&(Ta=null),ba!==null&&Sc(ba)&&(ba=null),Ca!==null&&Sc(Ca)&&(Ca=null),Uo.forEach(Dp),Mo.forEach(Dp)}function Qs(e,t){e.blockedOn===t&&(e.blockedOn=null,y0||(y0=!0,Gr.unstable_scheduleCallback(Gr.unstable_NormalPriority,V2)))}function jo(e){function t(a){return Qs(a,e)}if(0<ql.length){Qs(ql[0],e);for(var r=1;r<ql.length;r++){var n=ql[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ta!==null&&Qs(Ta,e),ba!==null&&Qs(ba,e),Ca!==null&&Qs(Ca,e),Uo.forEach(t),Mo.forEach(t),r=0;r<ma.length;r++)n=ma[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ma.length&&(r=ma[0],r.blockedOn===null);)Ev(r),r.blockedOn===null&&ma.shift()}var gs=aa.ReactCurrentBatchConfig,Uc=!0;function G2(e,t,r,n){var a=ct,i=gs.transition;gs.transition=null;try{ct=1,$h(e,t,r,n)}finally{ct=a,gs.transition=i}}function q2(e,t,r,n){var a=ct,i=gs.transition;gs.transition=null;try{ct=4,$h(e,t,r,n)}finally{ct=a,gs.transition=i}}function $h(e,t,r,n){if(Uc){var a=_0(e,t,r,n);if(a===null)wf(e,t,n,Mc,r),Np(e,n);else if(H2(a,e,t,r,n))n.stopPropagation();else if(Np(e,n),t&4&&-1<W2.indexOf(e)){for(;a!==null;){var i=Sl(a);if(i!==null&&yv(i),i=_0(e,t,r,n),i===null&&wf(e,t,n,Mc,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else wf(e,t,n,null,r)}}var Mc=null;function _0(e,t,r,n){if(Mc=null,e=Bh(n),e=ai(e),e!==null)if(t=Fi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=hv(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Mc=e,null}function Tv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(N2()){case Uh:return 1;case gv:return 4;case Lc:case D2:return 16;case vv:return 536870912;default:return 16}default:return 16}}var xa=null,zh=null,Ec=null;function bv(){if(Ec)return Ec;var e,t=zh,r=t.length,n,a="value"in xa?xa.value:xa.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return Ec=a.slice(e,1<n?1-n:void 0)}function Tc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Kl(){return!0}function Lp(){return!1}function Yr(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Kl:Lp,this.isPropagationStopped=Lp,this}return Ct(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Kl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Kl)},persist:function(){},isPersistent:Kl}),t}var Ds={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wh=Yr(Ds),kl=Ct({},Ds,{view:0,detail:0}),K2=Yr(kl),uf,ff,Zs,Su=Ct({},kl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hh,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zs&&(Zs&&e.type==="mousemove"?(uf=e.screenX-Zs.screenX,ff=e.screenY-Zs.screenY):ff=uf=0,Zs=e),uf)},movementY:function(e){return"movementY"in e?e.movementY:ff}}),Bp=Yr(Su),X2=Ct({},Su,{dataTransfer:0}),Y2=Yr(X2),J2=Ct({},kl,{relatedTarget:0}),hf=Yr(J2),Q2=Ct({},Ds,{animationName:0,elapsedTime:0,pseudoElement:0}),Z2=Yr(Q2),ek=Ct({},Ds,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),tk=Yr(ek),rk=Ct({},Ds,{data:0}),Up=Yr(rk),nk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ak={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ik={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sk(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ik[e])?!!t[e]:!1}function Hh(){return sk}var ok=Ct({},kl,{key:function(e){if(e.key){var t=nk[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Tc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ak[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hh,charCode:function(e){return e.type==="keypress"?Tc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Tc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),lk=Yr(ok),ck=Ct({},Su,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mp=Yr(ck),uk=Ct({},kl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hh}),fk=Yr(uk),hk=Ct({},Ds,{propertyName:0,elapsedTime:0,pseudoElement:0}),dk=Yr(hk),pk=Ct({},Su,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),mk=Yr(pk),gk=[9,13,27,32],Vh=ea&&"CompositionEvent"in window,go=null;ea&&"documentMode"in document&&(go=document.documentMode);var vk=ea&&"TextEvent"in window&&!go,Cv=ea&&(!Vh||go&&8<go&&11>=go),jp=" ",$p=!1;function Av(e,t){switch(e){case"keyup":return gk.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var es=!1;function xk(e,t){switch(e){case"compositionend":return Fv(t);case"keypress":return t.which!==32?null:($p=!0,jp);case"textInput":return e=t.data,e===jp&&$p?null:e;default:return null}}function wk(e,t){if(es)return e==="compositionend"||!Vh&&Av(e,t)?(e=bv(),Ec=zh=xa=null,es=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cv&&t.locale!=="ko"?null:t.data;default:return null}}var yk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!yk[e.type]:t==="textarea"}function Pv(e,t,r,n){ov(n),t=jc(t,"onChange"),0<t.length&&(r=new Wh("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var vo=null,$o=null;function _k(e){$v(e,0)}function Eu(e){var t=ns(e);if(ev(t))return e}function kk(e,t){if(e==="change")return t}var Rv=!1;if(ea){var df;if(ea){var pf="oninput"in document;if(!pf){var Wp=document.createElement("div");Wp.setAttribute("oninput","return;"),pf=typeof Wp.oninput=="function"}df=pf}else df=!1;Rv=df&&(!document.documentMode||9<document.documentMode)}function Hp(){vo&&(vo.detachEvent("onpropertychange",Ov),$o=vo=null)}function Ov(e){if(e.propertyName==="value"&&Eu($o)){var t=[];Pv(t,$o,e,Bh(e)),fv(_k,t)}}function Sk(e,t,r){e==="focusin"?(Hp(),vo=t,$o=r,vo.attachEvent("onpropertychange",Ov)):e==="focusout"&&Hp()}function Ek(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Eu($o)}function Tk(e,t){if(e==="click")return Eu(t)}function bk(e,t){if(e==="input"||e==="change")return Eu(t)}function Ck(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var An=typeof Object.is=="function"?Object.is:Ck;function zo(e,t){if(An(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!n0.call(t,a)||!An(e[a],t[a]))return!1}return!0}function Vp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Gp(e,t){var r=Vp(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Vp(r)}}function Iv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Iv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Nv(){for(var e=window,t=Ic();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ic(e.document)}return t}function Gh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ak(e){var t=Nv(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Iv(r.ownerDocument.documentElement,r)){if(n!==null&&Gh(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Gp(r,i);var s=Gp(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Fk=ea&&"documentMode"in document&&11>=document.documentMode,ts=null,k0=null,xo=null,S0=!1;function qp(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;S0||ts==null||ts!==Ic(n)||(n=ts,"selectionStart"in n&&Gh(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),xo&&zo(xo,n)||(xo=n,n=jc(k0,"onSelect"),0<n.length&&(t=new Wh("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ts)))}function Xl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var rs={animationend:Xl("Animation","AnimationEnd"),animationiteration:Xl("Animation","AnimationIteration"),animationstart:Xl("Animation","AnimationStart"),transitionend:Xl("Transition","TransitionEnd")},mf={},Dv={};ea&&(Dv=document.createElement("div").style,"AnimationEvent"in window||(delete rs.animationend.animation,delete rs.animationiteration.animation,delete rs.animationstart.animation),"TransitionEvent"in window||delete rs.transitionend.transition);function Tu(e){if(mf[e])return mf[e];if(!rs[e])return e;var t=rs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Dv)return mf[e]=t[r];return e}var Lv=Tu("animationend"),Bv=Tu("animationiteration"),Uv=Tu("animationstart"),Mv=Tu("transitionend"),jv=new Map,Kp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ja(e,t){jv.set(e,t),Ai(t,[e])}for(var gf=0;gf<Kp.length;gf++){var vf=Kp[gf],Pk=vf.toLowerCase(),Rk=vf[0].toUpperCase()+vf.slice(1);ja(Pk,"on"+Rk)}ja(Lv,"onAnimationEnd");ja(Bv,"onAnimationIteration");ja(Uv,"onAnimationStart");ja("dblclick","onDoubleClick");ja("focusin","onFocus");ja("focusout","onBlur");ja(Mv,"onTransitionEnd");Es("onMouseEnter",["mouseout","mouseover"]);Es("onMouseLeave",["mouseout","mouseover"]);Es("onPointerEnter",["pointerout","pointerover"]);Es("onPointerLeave",["pointerout","pointerover"]);Ai("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ai("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ai("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ai("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ai("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ai("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ok=new Set("cancel close invalid load scroll toggle".split(" ").concat(lo));function Xp(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,P2(n,t,void 0,e),e.currentTarget=null}function $v(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Xp(a,o,c),i=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Xp(a,o,c),i=l}}}if(Dc)throw e=x0,Dc=!1,x0=null,e}function pt(e,t){var r=t[A0];r===void 0&&(r=t[A0]=new Set);var n=e+"__bubble";r.has(n)||(zv(t,e,2,!1),r.add(n))}function xf(e,t,r){var n=0;t&&(n|=4),zv(r,e,n,t)}var Yl="_reactListening"+Math.random().toString(36).slice(2);function Wo(e){if(!e[Yl]){e[Yl]=!0,Xg.forEach(function(r){r!=="selectionchange"&&(Ok.has(r)||xf(r,!1,e),xf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Yl]||(t[Yl]=!0,xf("selectionchange",!1,t))}}function zv(e,t,r,n){switch(Tv(t)){case 1:var a=G2;break;case 4:a=q2;break;default:a=$h}r=a.bind(null,t,r,e),a=void 0,!v0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function wf(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=ai(o),s===null)return;if(l=s.tag,l===5||l===6){n=i=s;continue e}o=o.parentNode}}n=n.return}fv(function(){var c=i,u=Bh(r),f=[];e:{var p=jv.get(e);if(p!==void 0){var h=Wh,m=e;switch(e){case"keypress":if(Tc(r)===0)break e;case"keydown":case"keyup":h=lk;break;case"focusin":m="focus",h=hf;break;case"focusout":m="blur",h=hf;break;case"beforeblur":case"afterblur":h=hf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Bp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Y2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=fk;break;case Lv:case Bv:case Uv:h=Z2;break;case Mv:h=dk;break;case"scroll":h=K2;break;case"wheel":h=mk;break;case"copy":case"cut":case"paste":h=tk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Mp}var d=(t&4)!==0,v=!d&&e==="scroll",g=d?p!==null?p+"Capture":null:p;d=[];for(var x=c,w;x!==null;){w=x;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,g!==null&&(_=Bo(x,g),_!=null&&d.push(Ho(x,_,w)))),v)break;x=x.return}0<d.length&&(p=new h(p,m,null,r,u),f.push({event:p,listeners:d}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==m0&&(m=r.relatedTarget||r.fromElement)&&(ai(m)||m[ta]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=c,m=m?ai(m):null,m!==null&&(v=Fi(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=c),h!==m)){if(d=Bp,_="onMouseLeave",g="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(d=Mp,_="onPointerLeave",g="onPointerEnter",x="pointer"),v=h==null?p:ns(h),w=m==null?p:ns(m),p=new d(_,x+"leave",h,r,u),p.target=v,p.relatedTarget=w,_=null,ai(u)===c&&(d=new d(g,x+"enter",m,r,u),d.target=w,d.relatedTarget=v,_=d),v=_,h&&m)t:{for(d=h,g=m,x=0,w=d;w;w=Ui(w))x++;for(w=0,_=g;_;_=Ui(_))w++;for(;0<x-w;)d=Ui(d),x--;for(;0<w-x;)g=Ui(g),w--;for(;x--;){if(d===g||g!==null&&d===g.alternate)break t;d=Ui(d),g=Ui(g)}d=null}else d=null;h!==null&&Yp(f,p,h,d,!1),m!==null&&v!==null&&Yp(f,v,m,d,!0)}}e:{if(p=c?ns(c):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var S=kk;else if(zp(p))if(Rv)S=bk;else{S=Ek;var E=Sk}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=Tk);if(S&&(S=S(e,c))){Pv(f,S,r,u);break e}E&&E(e,p,c),e==="focusout"&&(E=p._wrapperState)&&E.controlled&&p.type==="number"&&u0(p,"number",p.value)}switch(E=c?ns(c):window,e){case"focusin":(zp(E)||E.contentEditable==="true")&&(ts=E,k0=c,xo=null);break;case"focusout":xo=k0=ts=null;break;case"mousedown":S0=!0;break;case"contextmenu":case"mouseup":case"dragend":S0=!1,qp(f,r,u);break;case"selectionchange":if(Fk)break;case"keydown":case"keyup":qp(f,r,u)}var k;if(Vh)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else es?Av(e,r)&&(R="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(R="onCompositionStart");R&&(Cv&&r.locale!=="ko"&&(es||R!=="onCompositionStart"?R==="onCompositionEnd"&&es&&(k=bv()):(xa=u,zh="value"in xa?xa.value:xa.textContent,es=!0)),E=jc(c,R),0<E.length&&(R=new Up(R,e,null,r,u),f.push({event:R,listeners:E}),k?R.data=k:(k=Fv(r),k!==null&&(R.data=k)))),(k=vk?xk(e,r):wk(e,r))&&(c=jc(c,"onBeforeInput"),0<c.length&&(u=new Up("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=k))}$v(f,t)})}function Ho(e,t,r){return{instance:e,listener:t,currentTarget:r}}function jc(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Bo(e,r),i!=null&&n.unshift(Ho(e,i,a)),i=Bo(e,t),i!=null&&n.push(Ho(e,i,a))),e=e.return}return n}function Ui(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Yp(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=Bo(r,i),l!=null&&s.unshift(Ho(r,l,o))):a||(l=Bo(r,i),l!=null&&s.push(Ho(r,l,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var Ik=/\r\n?/g,Nk=/\u0000|\uFFFD/g;function Jp(e){return(typeof e=="string"?e:""+e).replace(Ik,`
`).replace(Nk,"")}function Jl(e,t,r){if(t=Jp(t),Jp(e)!==t&&r)throw Error(Ee(425))}function $c(){}var E0=null,T0=null;function b0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var C0=typeof setTimeout=="function"?setTimeout:void 0,Dk=typeof clearTimeout=="function"?clearTimeout:void 0,Qp=typeof Promise=="function"?Promise:void 0,Lk=typeof queueMicrotask=="function"?queueMicrotask:typeof Qp<"u"?function(e){return Qp.resolve(null).then(e).catch(Bk)}:C0;function Bk(e){setTimeout(function(){throw e})}function yf(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),jo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);jo(t)}function Aa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Zp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ls=Math.random().toString(36).slice(2),Dn="__reactFiber$"+Ls,Vo="__reactProps$"+Ls,ta="__reactContainer$"+Ls,A0="__reactEvents$"+Ls,Uk="__reactListeners$"+Ls,Mk="__reactHandles$"+Ls;function ai(e){var t=e[Dn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ta]||r[Dn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Zp(e);e!==null;){if(r=e[Dn])return r;e=Zp(e)}return t}e=r,r=e.parentNode}return null}function Sl(e){return e=e[Dn]||e[ta],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ns(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ee(33))}function bu(e){return e[Vo]||null}var F0=[],as=-1;function $a(e){return{current:e}}function gt(e){0>as||(e.current=F0[as],F0[as]=null,as--)}function dt(e,t){as++,F0[as]=e.current,e.current=t}var Da={},yr=$a(Da),Ir=$a(!1),gi=Da;function Ts(e,t){var r=e.type.contextTypes;if(!r)return Da;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Nr(e){return e=e.childContextTypes,e!=null}function zc(){gt(Ir),gt(yr)}function em(e,t,r){if(yr.current!==Da)throw Error(Ee(168));dt(yr,t),dt(Ir,r)}function Wv(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Ee(108,S2(e)||"Unknown",a));return Ct({},r,n)}function Wc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Da,gi=yr.current,dt(yr,e),dt(Ir,Ir.current),!0}function tm(e,t,r){var n=e.stateNode;if(!n)throw Error(Ee(169));r?(e=Wv(e,t,gi),n.__reactInternalMemoizedMergedChildContext=e,gt(Ir),gt(yr),dt(yr,e)):gt(Ir),dt(Ir,r)}var qn=null,Cu=!1,_f=!1;function Hv(e){qn===null?qn=[e]:qn.push(e)}function jk(e){Cu=!0,Hv(e)}function za(){if(!_f&&qn!==null){_f=!0;var e=0,t=ct;try{var r=qn;for(ct=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}qn=null,Cu=!1}catch(a){throw qn!==null&&(qn=qn.slice(e+1)),mv(Uh,za),a}finally{ct=t,_f=!1}}return null}var is=[],ss=0,Hc=null,Vc=0,an=[],sn=0,vi=null,Kn=1,Xn="";function Ja(e,t){is[ss++]=Vc,is[ss++]=Hc,Hc=e,Vc=t}function Vv(e,t,r){an[sn++]=Kn,an[sn++]=Xn,an[sn++]=vi,vi=e;var n=Kn;e=Xn;var a=32-En(n)-1;n&=~(1<<a),r+=1;var i=32-En(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,Kn=1<<32-En(t)+a|r<<a|n,Xn=i+e}else Kn=1<<i|r<<a|n,Xn=e}function qh(e){e.return!==null&&(Ja(e,1),Vv(e,1,0))}function Kh(e){for(;e===Hc;)Hc=is[--ss],is[ss]=null,Vc=is[--ss],is[ss]=null;for(;e===vi;)vi=an[--sn],an[sn]=null,Xn=an[--sn],an[sn]=null,Kn=an[--sn],an[sn]=null}var Hr=null,Wr=null,yt=!1,kn=null;function Gv(e,t){var r=on(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function rm(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Hr=e,Wr=Aa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Hr=e,Wr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=vi!==null?{id:Kn,overflow:Xn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=on(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Hr=e,Wr=null,!0):!1;default:return!1}}function P0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function R0(e){if(yt){var t=Wr;if(t){var r=t;if(!rm(e,t)){if(P0(e))throw Error(Ee(418));t=Aa(r.nextSibling);var n=Hr;t&&rm(e,t)?Gv(n,r):(e.flags=e.flags&-4097|2,yt=!1,Hr=e)}}else{if(P0(e))throw Error(Ee(418));e.flags=e.flags&-4097|2,yt=!1,Hr=e}}}function nm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Hr=e}function Ql(e){if(e!==Hr)return!1;if(!yt)return nm(e),yt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!b0(e.type,e.memoizedProps)),t&&(t=Wr)){if(P0(e))throw qv(),Error(Ee(418));for(;t;)Gv(e,t),t=Aa(t.nextSibling)}if(nm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Wr=Aa(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Wr=null}}else Wr=Hr?Aa(e.stateNode.nextSibling):null;return!0}function qv(){for(var e=Wr;e;)e=Aa(e.nextSibling)}function bs(){Wr=Hr=null,yt=!1}function Xh(e){kn===null?kn=[e]:kn.push(e)}var $k=aa.ReactCurrentBatchConfig;function eo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ee(309));var n=r.stateNode}if(!n)throw Error(Ee(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(Ee(284));if(!r._owner)throw Error(Ee(290,e))}return e}function Zl(e,t){throw e=Object.prototype.toString.call(t),Error(Ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function am(e){var t=e._init;return t(e._payload)}function Kv(e){function t(g,x){if(e){var w=g.deletions;w===null?(g.deletions=[x],g.flags|=16):w.push(x)}}function r(g,x){if(!e)return null;for(;x!==null;)t(g,x),x=x.sibling;return null}function n(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function a(g,x){return g=Oa(g,x),g.index=0,g.sibling=null,g}function i(g,x,w){return g.index=w,e?(w=g.alternate,w!==null?(w=w.index,w<x?(g.flags|=2,x):w):(g.flags|=2,x)):(g.flags|=1048576,x)}function s(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,x,w,_){return x===null||x.tag!==6?(x=Af(w,g.mode,_),x.return=g,x):(x=a(x,w),x.return=g,x)}function l(g,x,w,_){var S=w.type;return S===Zi?u(g,x,w.props.children,_,w.key):x!==null&&(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ha&&am(S)===x.type)?(_=a(x,w.props),_.ref=eo(g,x,w),_.return=g,_):(_=Oc(w.type,w.key,w.props,null,g.mode,_),_.ref=eo(g,x,w),_.return=g,_)}function c(g,x,w,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=Ff(w,g.mode,_),x.return=g,x):(x=a(x,w.children||[]),x.return=g,x)}function u(g,x,w,_,S){return x===null||x.tag!==7?(x=ci(w,g.mode,_,S),x.return=g,x):(x=a(x,w),x.return=g,x)}function f(g,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Af(""+x,g.mode,w),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case zl:return w=Oc(x.type,x.key,x.props,null,g.mode,w),w.ref=eo(g,null,x),w.return=g,w;case Qi:return x=Ff(x,g.mode,w),x.return=g,x;case ha:var _=x._init;return f(g,_(x._payload),w)}if(so(x)||Xs(x))return x=ci(x,g.mode,w,null),x.return=g,x;Zl(g,x)}return null}function p(g,x,w,_){var S=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:o(g,x,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case zl:return w.key===S?l(g,x,w,_):null;case Qi:return w.key===S?c(g,x,w,_):null;case ha:return S=w._init,p(g,x,S(w._payload),_)}if(so(w)||Xs(w))return S!==null?null:u(g,x,w,_,null);Zl(g,w)}return null}function h(g,x,w,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(w)||null,o(x,g,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case zl:return g=g.get(_.key===null?w:_.key)||null,l(x,g,_,S);case Qi:return g=g.get(_.key===null?w:_.key)||null,c(x,g,_,S);case ha:var E=_._init;return h(g,x,w,E(_._payload),S)}if(so(_)||Xs(_))return g=g.get(w)||null,u(x,g,_,S,null);Zl(x,_)}return null}function m(g,x,w,_){for(var S=null,E=null,k=x,R=x=0,C=null;k!==null&&R<w.length;R++){k.index>R?(C=k,k=null):C=k.sibling;var N=p(g,k,w[R],_);if(N===null){k===null&&(k=C);break}e&&k&&N.alternate===null&&t(g,k),x=i(N,x,R),E===null?S=N:E.sibling=N,E=N,k=C}if(R===w.length)return r(g,k),yt&&Ja(g,R),S;if(k===null){for(;R<w.length;R++)k=f(g,w[R],_),k!==null&&(x=i(k,x,R),E===null?S=k:E.sibling=k,E=k);return yt&&Ja(g,R),S}for(k=n(g,k);R<w.length;R++)C=h(k,g,R,w[R],_),C!==null&&(e&&C.alternate!==null&&k.delete(C.key===null?R:C.key),x=i(C,x,R),E===null?S=C:E.sibling=C,E=C);return e&&k.forEach(function(X){return t(g,X)}),yt&&Ja(g,R),S}function d(g,x,w,_){var S=Xs(w);if(typeof S!="function")throw Error(Ee(150));if(w=S.call(w),w==null)throw Error(Ee(151));for(var E=S=null,k=x,R=x=0,C=null,N=w.next();k!==null&&!N.done;R++,N=w.next()){k.index>R?(C=k,k=null):C=k.sibling;var X=p(g,k,N.value,_);if(X===null){k===null&&(k=C);break}e&&k&&X.alternate===null&&t(g,k),x=i(X,x,R),E===null?S=X:E.sibling=X,E=X,k=C}if(N.done)return r(g,k),yt&&Ja(g,R),S;if(k===null){for(;!N.done;R++,N=w.next())N=f(g,N.value,_),N!==null&&(x=i(N,x,R),E===null?S=N:E.sibling=N,E=N);return yt&&Ja(g,R),S}for(k=n(g,k);!N.done;R++,N=w.next())N=h(k,g,R,N.value,_),N!==null&&(e&&N.alternate!==null&&k.delete(N.key===null?R:N.key),x=i(N,x,R),E===null?S=N:E.sibling=N,E=N);return e&&k.forEach(function(A){return t(g,A)}),yt&&Ja(g,R),S}function v(g,x,w,_){if(typeof w=="object"&&w!==null&&w.type===Zi&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case zl:e:{for(var S=w.key,E=x;E!==null;){if(E.key===S){if(S=w.type,S===Zi){if(E.tag===7){r(g,E.sibling),x=a(E,w.props.children),x.return=g,g=x;break e}}else if(E.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ha&&am(S)===E.type){r(g,E.sibling),x=a(E,w.props),x.ref=eo(g,E,w),x.return=g,g=x;break e}r(g,E);break}else t(g,E);E=E.sibling}w.type===Zi?(x=ci(w.props.children,g.mode,_,w.key),x.return=g,g=x):(_=Oc(w.type,w.key,w.props,null,g.mode,_),_.ref=eo(g,x,w),_.return=g,g=_)}return s(g);case Qi:e:{for(E=w.key;x!==null;){if(x.key===E)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){r(g,x.sibling),x=a(x,w.children||[]),x.return=g,g=x;break e}else{r(g,x);break}else t(g,x);x=x.sibling}x=Ff(w,g.mode,_),x.return=g,g=x}return s(g);case ha:return E=w._init,v(g,x,E(w._payload),_)}if(so(w))return m(g,x,w,_);if(Xs(w))return d(g,x,w,_);Zl(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(r(g,x.sibling),x=a(x,w),x.return=g,g=x):(r(g,x),x=Af(w,g.mode,_),x.return=g,g=x),s(g)):r(g,x)}return v}var Cs=Kv(!0),Xv=Kv(!1),Gc=$a(null),qc=null,os=null,Yh=null;function Jh(){Yh=os=qc=null}function Qh(e){var t=Gc.current;gt(Gc),e._currentValue=t}function O0(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function vs(e,t){qc=e,Yh=os=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Or=!0),e.firstContext=null)}function fn(e){var t=e._currentValue;if(Yh!==e)if(e={context:e,memoizedValue:t,next:null},os===null){if(qc===null)throw Error(Ee(308));os=e,qc.dependencies={lanes:0,firstContext:e}}else os=os.next=e;return t}var ii=null;function Zh(e){ii===null?ii=[e]:ii.push(e)}function Yv(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Zh(t)):(r.next=a.next,a.next=r),t.interleaved=r,ra(e,n)}function ra(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var da=!1;function ed(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Jn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fa(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,rt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ra(e,r)}return a=n.interleaved,a===null?(t.next=t,Zh(n)):(t.next=a.next,a.next=t),n.interleaved=t,ra(e,r)}function bc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Mh(e,r)}}function im(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Kc(e,t,r,n){var a=e.updateQueue;da=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var f=a.baseState;s=0,u=c=l=null,o=i;do{var p=o.lane,h=o.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,d=o;switch(p=t,h=r,d.tag){case 1:if(m=d.payload,typeof m=="function"){f=m.call(h,f,p);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=d.payload,p=typeof m=="function"?m.call(h,f,p):m,p==null)break e;f=Ct({},f,p);break e;case 2:da=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=h,l=f):u=u.next=h,s|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(u===null&&(l=f),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);wi|=s,e.lanes=s,e.memoizedState=f}}function sm(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Ee(191,a));a.call(n)}}}var El={},Un=$a(El),Go=$a(El),qo=$a(El);function si(e){if(e===El)throw Error(Ee(174));return e}function td(e,t){switch(dt(qo,t),dt(Go,e),dt(Un,El),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:h0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=h0(t,e)}gt(Un),dt(Un,t)}function As(){gt(Un),gt(Go),gt(qo)}function Qv(e){si(qo.current);var t=si(Un.current),r=h0(t,e.type);t!==r&&(dt(Go,e),dt(Un,r))}function rd(e){Go.current===e&&(gt(Un),gt(Go))}var Et=$a(0);function Xc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var kf=[];function nd(){for(var e=0;e<kf.length;e++)kf[e]._workInProgressVersionPrimary=null;kf.length=0}var Cc=aa.ReactCurrentDispatcher,Sf=aa.ReactCurrentBatchConfig,xi=0,bt=null,Ht=null,Yt=null,Yc=!1,wo=!1,Ko=0,zk=0;function ur(){throw Error(Ee(321))}function ad(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!An(e[r],t[r]))return!1;return!0}function id(e,t,r,n,a,i){if(xi=i,bt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Cc.current=e===null||e.memoizedState===null?Gk:qk,e=r(n,a),wo){i=0;do{if(wo=!1,Ko=0,25<=i)throw Error(Ee(301));i+=1,Yt=Ht=null,t.updateQueue=null,Cc.current=Kk,e=r(n,a)}while(wo)}if(Cc.current=Jc,t=Ht!==null&&Ht.next!==null,xi=0,Yt=Ht=bt=null,Yc=!1,t)throw Error(Ee(300));return e}function sd(){var e=Ko!==0;return Ko=0,e}function Nn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?bt.memoizedState=Yt=e:Yt=Yt.next=e,Yt}function hn(){if(Ht===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=Ht.next;var t=Yt===null?bt.memoizedState:Yt.next;if(t!==null)Yt=t,Ht=e;else{if(e===null)throw Error(Ee(310));Ht=e,e={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},Yt===null?bt.memoizedState=Yt=e:Yt=Yt.next=e}return Yt}function Xo(e,t){return typeof t=="function"?t(e):t}function Ef(e){var t=hn(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var n=Ht,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,l=null,c=i;do{var u=c.lane;if((xi&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,s=n):l=l.next=f,bt.lanes|=u,wi|=u}c=c.next}while(c!==null&&c!==i);l===null?s=n:l.next=o,An(n,t.memoizedState)||(Or=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,bt.lanes|=i,wi|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Tf(e){var t=hn(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);An(i,t.memoizedState)||(Or=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Zv(){}function ex(e,t){var r=bt,n=hn(),a=t(),i=!An(n.memoizedState,a);if(i&&(n.memoizedState=a,Or=!0),n=n.queue,od(nx.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Yt!==null&&Yt.memoizedState.tag&1){if(r.flags|=2048,Yo(9,rx.bind(null,r,n,a,t),void 0,null),er===null)throw Error(Ee(349));xi&30||tx(r,t,a)}return a}function tx(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function rx(e,t,r,n){t.value=r,t.getSnapshot=n,ax(t)&&ix(e)}function nx(e,t,r){return r(function(){ax(t)&&ix(e)})}function ax(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!An(e,r)}catch{return!0}}function ix(e){var t=ra(e,1);t!==null&&Tn(t,e,1,-1)}function om(e){var t=Nn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xo,lastRenderedState:e},t.queue=e,e=e.dispatch=Vk.bind(null,bt,e),[t.memoizedState,e]}function Yo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function sx(){return hn().memoizedState}function Ac(e,t,r,n){var a=Nn();bt.flags|=e,a.memoizedState=Yo(1|t,r,void 0,n===void 0?null:n)}function Au(e,t,r,n){var a=hn();n=n===void 0?null:n;var i=void 0;if(Ht!==null){var s=Ht.memoizedState;if(i=s.destroy,n!==null&&ad(n,s.deps)){a.memoizedState=Yo(t,r,i,n);return}}bt.flags|=e,a.memoizedState=Yo(1|t,r,i,n)}function lm(e,t){return Ac(8390656,8,e,t)}function od(e,t){return Au(2048,8,e,t)}function ox(e,t){return Au(4,2,e,t)}function lx(e,t){return Au(4,4,e,t)}function cx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ux(e,t,r){return r=r!=null?r.concat([e]):null,Au(4,4,cx.bind(null,t,e),r)}function ld(){}function fx(e,t){var r=hn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&ad(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function hx(e,t){var r=hn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&ad(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function dx(e,t,r){return xi&21?(An(r,t)||(r=xv(),bt.lanes|=r,wi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Or=!0),e.memoizedState=r)}function Wk(e,t){var r=ct;ct=r!==0&&4>r?r:4,e(!0);var n=Sf.transition;Sf.transition={};try{e(!1),t()}finally{ct=r,Sf.transition=n}}function px(){return hn().memoizedState}function Hk(e,t,r){var n=Ra(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},mx(e))gx(t,r);else if(r=Yv(e,t,r,n),r!==null){var a=br();Tn(r,e,n,a),vx(r,t,n)}}function Vk(e,t,r){var n=Ra(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(mx(e))gx(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,An(o,s)){var l=t.interleaved;l===null?(a.next=a,Zh(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=Yv(e,t,a,n),r!==null&&(a=br(),Tn(r,e,n,a),vx(r,t,n))}}function mx(e){var t=e.alternate;return e===bt||t!==null&&t===bt}function gx(e,t){wo=Yc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function vx(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Mh(e,r)}}var Jc={readContext:fn,useCallback:ur,useContext:ur,useEffect:ur,useImperativeHandle:ur,useInsertionEffect:ur,useLayoutEffect:ur,useMemo:ur,useReducer:ur,useRef:ur,useState:ur,useDebugValue:ur,useDeferredValue:ur,useTransition:ur,useMutableSource:ur,useSyncExternalStore:ur,useId:ur,unstable_isNewReconciler:!1},Gk={readContext:fn,useCallback:function(e,t){return Nn().memoizedState=[e,t===void 0?null:t],e},useContext:fn,useEffect:lm,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ac(4194308,4,cx.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ac(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ac(4,2,e,t)},useMemo:function(e,t){var r=Nn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Nn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Hk.bind(null,bt,e),[n.memoizedState,e]},useRef:function(e){var t=Nn();return e={current:e},t.memoizedState=e},useState:om,useDebugValue:ld,useDeferredValue:function(e){return Nn().memoizedState=e},useTransition:function(){var e=om(!1),t=e[0];return e=Wk.bind(null,e[1]),Nn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=bt,a=Nn();if(yt){if(r===void 0)throw Error(Ee(407));r=r()}else{if(r=t(),er===null)throw Error(Ee(349));xi&30||tx(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,lm(nx.bind(null,n,i,e),[e]),n.flags|=2048,Yo(9,rx.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Nn(),t=er.identifierPrefix;if(yt){var r=Xn,n=Kn;r=(n&~(1<<32-En(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ko++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=zk++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},qk={readContext:fn,useCallback:fx,useContext:fn,useEffect:od,useImperativeHandle:ux,useInsertionEffect:ox,useLayoutEffect:lx,useMemo:hx,useReducer:Ef,useRef:sx,useState:function(){return Ef(Xo)},useDebugValue:ld,useDeferredValue:function(e){var t=hn();return dx(t,Ht.memoizedState,e)},useTransition:function(){var e=Ef(Xo)[0],t=hn().memoizedState;return[e,t]},useMutableSource:Zv,useSyncExternalStore:ex,useId:px,unstable_isNewReconciler:!1},Kk={readContext:fn,useCallback:fx,useContext:fn,useEffect:od,useImperativeHandle:ux,useInsertionEffect:ox,useLayoutEffect:lx,useMemo:hx,useReducer:Tf,useRef:sx,useState:function(){return Tf(Xo)},useDebugValue:ld,useDeferredValue:function(e){var t=hn();return Ht===null?t.memoizedState=e:dx(t,Ht.memoizedState,e)},useTransition:function(){var e=Tf(Xo)[0],t=hn().memoizedState;return[e,t]},useMutableSource:Zv,useSyncExternalStore:ex,useId:px,unstable_isNewReconciler:!1};function xn(e,t){if(e&&e.defaultProps){t=Ct({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function I0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ct({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Fu={isMounted:function(e){return(e=e._reactInternals)?Fi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=br(),a=Ra(e),i=Jn(n,a);i.payload=t,r!=null&&(i.callback=r),t=Fa(e,i,a),t!==null&&(Tn(t,e,a,n),bc(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=br(),a=Ra(e),i=Jn(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Fa(e,i,a),t!==null&&(Tn(t,e,a,n),bc(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=br(),n=Ra(e),a=Jn(r,n);a.tag=2,t!=null&&(a.callback=t),t=Fa(e,a,n),t!==null&&(Tn(t,e,n,r),bc(t,e,n))}};function cm(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!zo(r,n)||!zo(a,i):!0}function xx(e,t,r){var n=!1,a=Da,i=t.contextType;return typeof i=="object"&&i!==null?i=fn(i):(a=Nr(t)?gi:yr.current,n=t.contextTypes,i=(n=n!=null)?Ts(e,a):Da),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Fu,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function um(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Fu.enqueueReplaceState(t,t.state,null)}function N0(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},ed(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=fn(i):(i=Nr(t)?gi:yr.current,a.context=Ts(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(I0(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Fu.enqueueReplaceState(a,a.state,null),Kc(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Fs(e,t){try{var r="",n=t;do r+=k2(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function bf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function D0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Xk=typeof WeakMap=="function"?WeakMap:Map;function wx(e,t,r){r=Jn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Zc||(Zc=!0,V0=n),D0(e,t)},r}function yx(e,t,r){r=Jn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){D0(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){D0(e,t),typeof n!="function"&&(Pa===null?Pa=new Set([this]):Pa.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function fm(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Xk;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=cS.bind(null,e,t,r),t.then(e,e))}function hm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function dm(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Jn(-1,1),t.tag=2,Fa(r,t,1))),r.lanes|=1),e)}var Yk=aa.ReactCurrentOwner,Or=!1;function Sr(e,t,r,n){t.child=e===null?Xv(t,null,r,n):Cs(t,e.child,r,n)}function pm(e,t,r,n,a){r=r.render;var i=t.ref;return vs(t,a),n=id(e,t,r,n,i,a),r=sd(),e!==null&&!Or?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,na(e,t,a)):(yt&&r&&qh(t),t.flags|=1,Sr(e,t,n,a),t.child)}function mm(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!gd(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,_x(e,t,i,n,a)):(e=Oc(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:zo,r(s,n)&&e.ref===t.ref)return na(e,t,a)}return t.flags|=1,e=Oa(i,n),e.ref=t.ref,e.return=t,t.child=e}function _x(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(zo(i,n)&&e.ref===t.ref)if(Or=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(Or=!0);else return t.lanes=e.lanes,na(e,t,a)}return L0(e,t,r,n,a)}function kx(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},dt(cs,Ur),Ur|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,dt(cs,Ur),Ur|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,dt(cs,Ur),Ur|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,dt(cs,Ur),Ur|=n;return Sr(e,t,a,r),t.child}function Sx(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function L0(e,t,r,n,a){var i=Nr(r)?gi:yr.current;return i=Ts(t,i),vs(t,a),r=id(e,t,r,n,i,a),n=sd(),e!==null&&!Or?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,na(e,t,a)):(yt&&n&&qh(t),t.flags|=1,Sr(e,t,r,a),t.child)}function gm(e,t,r,n,a){if(Nr(r)){var i=!0;Wc(t)}else i=!1;if(vs(t,a),t.stateNode===null)Fc(e,t),xx(t,r,n),N0(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=r.contextType;typeof c=="object"&&c!==null?c=fn(c):(c=Nr(r)?gi:yr.current,c=Ts(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==c)&&um(t,s,n,c),da=!1;var p=t.memoizedState;s.state=p,Kc(t,n,s,a),l=t.memoizedState,o!==n||p!==l||Ir.current||da?(typeof u=="function"&&(I0(t,r,u,n),l=t.memoizedState),(o=da||cm(t,r,o,n,p,l,c))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Jv(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:xn(t.type,o),s.props=c,f=t.pendingProps,p=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=fn(l):(l=Nr(r)?gi:yr.current,l=Ts(t,l));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==f||p!==l)&&um(t,s,n,l),da=!1,p=t.memoizedState,s.state=p,Kc(t,n,s,a);var m=t.memoizedState;o!==f||p!==m||Ir.current||da?(typeof h=="function"&&(I0(t,r,h,n),m=t.memoizedState),(c=da||cm(t,r,c,n,p,m,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,m,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,m,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),s.props=n,s.state=m,s.context=l,n=c):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return B0(e,t,r,n,i,a)}function B0(e,t,r,n,a,i){Sx(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&tm(t,r,!1),na(e,t,i);n=t.stateNode,Yk.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Cs(t,e.child,null,i),t.child=Cs(t,null,o,i)):Sr(e,t,o,i),t.memoizedState=n.state,a&&tm(t,r,!0),t.child}function Ex(e){var t=e.stateNode;t.pendingContext?em(e,t.pendingContext,t.pendingContext!==t.context):t.context&&em(e,t.context,!1),td(e,t.containerInfo)}function vm(e,t,r,n,a){return bs(),Xh(a),t.flags|=256,Sr(e,t,r,n),t.child}var U0={dehydrated:null,treeContext:null,retryLane:0};function M0(e){return{baseLanes:e,cachePool:null,transitions:null}}function Tx(e,t,r){var n=t.pendingProps,a=Et.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),dt(Et,a&1),e===null)return R0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Ou(s,n,0,null),e=ci(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=M0(r),t.memoizedState=U0,e):cd(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return Jk(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Oa(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=Oa(o,i):(i=ci(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?M0(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=U0,n}return i=e.child,e=i.sibling,n=Oa(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function cd(e,t){return t=Ou({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ec(e,t,r,n){return n!==null&&Xh(n),Cs(t,e.child,null,r),e=cd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Jk(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=bf(Error(Ee(422))),ec(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Ou({mode:"visible",children:n.children},a,0,null),i=ci(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Cs(t,e.child,null,s),t.child.memoizedState=M0(s),t.memoizedState=U0,i);if(!(t.mode&1))return ec(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(Ee(419)),n=bf(i,n,void 0),ec(e,t,s,n)}if(o=(s&e.childLanes)!==0,Or||o){if(n=er,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,ra(e,a),Tn(n,e,a,-1))}return md(),n=bf(Error(Ee(421))),ec(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=uS.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Wr=Aa(a.nextSibling),Hr=t,yt=!0,kn=null,e!==null&&(an[sn++]=Kn,an[sn++]=Xn,an[sn++]=vi,Kn=e.id,Xn=e.overflow,vi=t),t=cd(t,n.children),t.flags|=4096,t)}function xm(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),O0(e.return,t,r)}function Cf(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function bx(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Sr(e,t,n.children,r),n=Et.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&xm(e,r,t);else if(e.tag===19)xm(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(dt(Et,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Xc(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Cf(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Xc(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Cf(t,!0,r,null,i);break;case"together":Cf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Fc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function na(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),wi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ee(153));if(t.child!==null){for(e=t.child,r=Oa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Oa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Qk(e,t,r){switch(t.tag){case 3:Ex(t),bs();break;case 5:Qv(t);break;case 1:Nr(t.type)&&Wc(t);break;case 4:td(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;dt(Gc,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(dt(Et,Et.current&1),t.flags|=128,null):r&t.child.childLanes?Tx(e,t,r):(dt(Et,Et.current&1),e=na(e,t,r),e!==null?e.sibling:null);dt(Et,Et.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return bx(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),dt(Et,Et.current),n)break;return null;case 22:case 23:return t.lanes=0,kx(e,t,r)}return na(e,t,r)}var Cx,j0,Ax,Fx;Cx=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};j0=function(){};Ax=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,si(Un.current);var i=null;switch(r){case"input":a=l0(e,a),n=l0(e,n),i=[];break;case"select":a=Ct({},a,{value:void 0}),n=Ct({},n,{value:void 0}),i=[];break;case"textarea":a=f0(e,a),n=f0(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=$c)}d0(r,n);var s;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Do.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Do.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&pt("scroll",e),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};Fx=function(e,t,r,n){r!==n&&(t.flags|=4)};function to(e,t){if(!yt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function fr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Zk(e,t,r){var n=t.pendingProps;switch(Kh(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fr(t),null;case 1:return Nr(t.type)&&zc(),fr(t),null;case 3:return n=t.stateNode,As(),gt(Ir),gt(yr),nd(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ql(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,kn!==null&&(K0(kn),kn=null))),j0(e,t),fr(t),null;case 5:rd(t);var a=si(qo.current);if(r=t.type,e!==null&&t.stateNode!=null)Ax(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ee(166));return fr(t),null}if(e=si(Un.current),Ql(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Dn]=t,n[Vo]=i,e=(t.mode&1)!==0,r){case"dialog":pt("cancel",n),pt("close",n);break;case"iframe":case"object":case"embed":pt("load",n);break;case"video":case"audio":for(a=0;a<lo.length;a++)pt(lo[a],n);break;case"source":pt("error",n);break;case"img":case"image":case"link":pt("error",n),pt("load",n);break;case"details":pt("toggle",n);break;case"input":Cp(n,i),pt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},pt("invalid",n);break;case"textarea":Fp(n,i),pt("invalid",n)}d0(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Jl(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Jl(n.textContent,o,e),a=["children",""+o]):Do.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&pt("scroll",n)}switch(r){case"input":Wl(n),Ap(n,i,!0);break;case"textarea":Wl(n),Pp(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=$c)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=nv(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Dn]=t,e[Vo]=n,Cx(e,t,!1,!1),t.stateNode=e;e:{switch(s=p0(r,n),r){case"dialog":pt("cancel",e),pt("close",e),a=n;break;case"iframe":case"object":case"embed":pt("load",e),a=n;break;case"video":case"audio":for(a=0;a<lo.length;a++)pt(lo[a],e);a=n;break;case"source":pt("error",e),a=n;break;case"img":case"image":case"link":pt("error",e),pt("load",e),a=n;break;case"details":pt("toggle",e),a=n;break;case"input":Cp(e,n),a=l0(e,n),pt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Ct({},n,{value:void 0}),pt("invalid",e);break;case"textarea":Fp(e,n),a=f0(e,n),pt("invalid",e);break;default:a=n}d0(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?sv(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&av(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Lo(e,l):typeof l=="number"&&Lo(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Do.hasOwnProperty(i)?l!=null&&i==="onScroll"&&pt("scroll",e):l!=null&&Ih(e,i,l,s))}switch(r){case"input":Wl(e),Ap(e,n,!1);break;case"textarea":Wl(e),Pp(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Na(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?ds(e,!!n.multiple,i,!1):n.defaultValue!=null&&ds(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=$c)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return fr(t),null;case 6:if(e&&t.stateNode!=null)Fx(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ee(166));if(r=si(qo.current),si(Un.current),Ql(t)){if(n=t.stateNode,r=t.memoizedProps,n[Dn]=t,(i=n.nodeValue!==r)&&(e=Hr,e!==null))switch(e.tag){case 3:Jl(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Jl(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Dn]=t,t.stateNode=n}return fr(t),null;case 13:if(gt(Et),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(yt&&Wr!==null&&t.mode&1&&!(t.flags&128))qv(),bs(),t.flags|=98560,i=!1;else if(i=Ql(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Ee(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ee(317));i[Dn]=t}else bs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;fr(t),i=!1}else kn!==null&&(K0(kn),kn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Et.current&1?Gt===0&&(Gt=3):md())),t.updateQueue!==null&&(t.flags|=4),fr(t),null);case 4:return As(),j0(e,t),e===null&&Wo(t.stateNode.containerInfo),fr(t),null;case 10:return Qh(t.type._context),fr(t),null;case 17:return Nr(t.type)&&zc(),fr(t),null;case 19:if(gt(Et),i=t.memoizedState,i===null)return fr(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)to(i,!1);else{if(Gt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Xc(e),s!==null){for(t.flags|=128,to(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return dt(Et,Et.current&1|2),t.child}e=e.sibling}i.tail!==null&&Dt()>Ps&&(t.flags|=128,n=!0,to(i,!1),t.lanes=4194304)}else{if(!n)if(e=Xc(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),to(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!yt)return fr(t),null}else 2*Dt()-i.renderingStartTime>Ps&&r!==1073741824&&(t.flags|=128,n=!0,to(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Dt(),t.sibling=null,r=Et.current,dt(Et,n?r&1|2:r&1),t):(fr(t),null);case 22:case 23:return pd(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ur&1073741824&&(fr(t),t.subtreeFlags&6&&(t.flags|=8192)):fr(t),null;case 24:return null;case 25:return null}throw Error(Ee(156,t.tag))}function eS(e,t){switch(Kh(t),t.tag){case 1:return Nr(t.type)&&zc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return As(),gt(Ir),gt(yr),nd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return rd(t),null;case 13:if(gt(Et),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ee(340));bs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return gt(Et),null;case 4:return As(),null;case 10:return Qh(t.type._context),null;case 22:case 23:return pd(),null;case 24:return null;default:return null}}var tc=!1,mr=!1,tS=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function ls(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ft(e,t,n)}else r.current=null}function $0(e,t,r){try{r()}catch(n){Ft(e,t,n)}}var wm=!1;function rS(e,t){if(E0=Uc,e=Nv(),Gh(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,c=0,u=0,f=e,p=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(o=s+a),f!==i||n!==0&&f.nodeType!==3||(l=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++c===a&&(o=s),p===i&&++u===n&&(l=s),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(T0={focusedElem:e,selectionRange:r},Uc=!1,Ie=t;Ie!==null;)if(t=Ie,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ie=e;else for(;Ie!==null;){t=Ie;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var d=m.memoizedProps,v=m.memoizedState,g=t.stateNode,x=g.getSnapshotBeforeUpdate(t.elementType===t.type?d:xn(t.type,d),v);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ee(163))}}catch(_){Ft(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,Ie=e;break}Ie=t.return}return m=wm,wm=!1,m}function yo(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&$0(t,r,i)}a=a.next}while(a!==n)}}function Pu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function z0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Px(e){var t=e.alternate;t!==null&&(e.alternate=null,Px(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Dn],delete t[Vo],delete t[A0],delete t[Uk],delete t[Mk])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Rx(e){return e.tag===5||e.tag===3||e.tag===4}function ym(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Rx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function W0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=$c));else if(n!==4&&(e=e.child,e!==null))for(W0(e,t,r),e=e.sibling;e!==null;)W0(e,t,r),e=e.sibling}function H0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(H0(e,t,r),e=e.sibling;e!==null;)H0(e,t,r),e=e.sibling}var ar=null,yn=!1;function ua(e,t,r){for(r=r.child;r!==null;)Ox(e,t,r),r=r.sibling}function Ox(e,t,r){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(ku,r)}catch{}switch(r.tag){case 5:mr||ls(r,t);case 6:var n=ar,a=yn;ar=null,ua(e,t,r),ar=n,yn=a,ar!==null&&(yn?(e=ar,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ar.removeChild(r.stateNode));break;case 18:ar!==null&&(yn?(e=ar,r=r.stateNode,e.nodeType===8?yf(e.parentNode,r):e.nodeType===1&&yf(e,r),jo(e)):yf(ar,r.stateNode));break;case 4:n=ar,a=yn,ar=r.stateNode.containerInfo,yn=!0,ua(e,t,r),ar=n,yn=a;break;case 0:case 11:case 14:case 15:if(!mr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&$0(r,t,s),a=a.next}while(a!==n)}ua(e,t,r);break;case 1:if(!mr&&(ls(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ft(r,t,o)}ua(e,t,r);break;case 21:ua(e,t,r);break;case 22:r.mode&1?(mr=(n=mr)||r.memoizedState!==null,ua(e,t,r),mr=n):ua(e,t,r);break;default:ua(e,t,r)}}function _m(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new tS),t.forEach(function(n){var a=fS.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function mn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:ar=o.stateNode,yn=!1;break e;case 3:ar=o.stateNode.containerInfo,yn=!0;break e;case 4:ar=o.stateNode.containerInfo,yn=!0;break e}o=o.return}if(ar===null)throw Error(Ee(160));Ox(i,s,a),ar=null,yn=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Ft(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ix(t,e),t=t.sibling}function Ix(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mn(t,e),Fn(e),n&4){try{yo(3,e,e.return),Pu(3,e)}catch(d){Ft(e,e.return,d)}try{yo(5,e,e.return)}catch(d){Ft(e,e.return,d)}}break;case 1:mn(t,e),Fn(e),n&512&&r!==null&&ls(r,r.return);break;case 5:if(mn(t,e),Fn(e),n&512&&r!==null&&ls(r,r.return),e.flags&32){var a=e.stateNode;try{Lo(a,"")}catch(d){Ft(e,e.return,d)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&tv(a,i),p0(o,s);var c=p0(o,i);for(s=0;s<l.length;s+=2){var u=l[s],f=l[s+1];u==="style"?sv(a,f):u==="dangerouslySetInnerHTML"?av(a,f):u==="children"?Lo(a,f):Ih(a,u,f,c)}switch(o){case"input":c0(a,i);break;case"textarea":rv(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?ds(a,!!i.multiple,h,!1):p!==!!i.multiple&&(i.defaultValue!=null?ds(a,!!i.multiple,i.defaultValue,!0):ds(a,!!i.multiple,i.multiple?[]:"",!1))}a[Vo]=i}catch(d){Ft(e,e.return,d)}}break;case 6:if(mn(t,e),Fn(e),n&4){if(e.stateNode===null)throw Error(Ee(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(d){Ft(e,e.return,d)}}break;case 3:if(mn(t,e),Fn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{jo(t.containerInfo)}catch(d){Ft(e,e.return,d)}break;case 4:mn(t,e),Fn(e);break;case 13:mn(t,e),Fn(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(hd=Dt())),n&4&&_m(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(mr=(c=mr)||u,mn(t,e),mr=c):mn(t,e),Fn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ie=e,u=e.child;u!==null;){for(f=Ie=u;Ie!==null;){switch(p=Ie,h=p.child,p.tag){case 0:case 11:case 14:case 15:yo(4,p,p.return);break;case 1:ls(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(d){Ft(n,r,d)}}break;case 5:ls(p,p.return);break;case 22:if(p.memoizedState!==null){Sm(f);continue}}h!==null?(h.return=p,Ie=h):Sm(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,c?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,l=f.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=iv("display",s))}catch(d){Ft(e,e.return,d)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(d){Ft(e,e.return,d)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:mn(t,e),Fn(e),n&4&&_m(e);break;case 21:break;default:mn(t,e),Fn(e)}}function Fn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Rx(r)){var n=r;break e}r=r.return}throw Error(Ee(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Lo(a,""),n.flags&=-33);var i=ym(e);H0(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=ym(e);W0(e,o,s);break;default:throw Error(Ee(161))}}catch(l){Ft(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function nS(e,t,r){Ie=e,Nx(e)}function Nx(e,t,r){for(var n=(e.mode&1)!==0;Ie!==null;){var a=Ie,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||tc;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||mr;o=tc;var c=mr;if(tc=s,(mr=l)&&!c)for(Ie=a;Ie!==null;)s=Ie,l=s.child,s.tag===22&&s.memoizedState!==null?Em(a):l!==null?(l.return=s,Ie=l):Em(a);for(;i!==null;)Ie=i,Nx(i),i=i.sibling;Ie=a,tc=o,mr=c}km(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Ie=i):km(e)}}function km(e){for(;Ie!==null;){var t=Ie;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:mr||Pu(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!mr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:xn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&sm(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}sm(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&jo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ee(163))}mr||t.flags&512&&z0(t)}catch(p){Ft(t,t.return,p)}}if(t===e){Ie=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ie=r;break}Ie=t.return}}function Sm(e){for(;Ie!==null;){var t=Ie;if(t===e){Ie=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ie=r;break}Ie=t.return}}function Em(e){for(;Ie!==null;){var t=Ie;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Pu(4,t)}catch(l){Ft(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Ft(t,a,l)}}var i=t.return;try{z0(t)}catch(l){Ft(t,i,l)}break;case 5:var s=t.return;try{z0(t)}catch(l){Ft(t,s,l)}}}catch(l){Ft(t,t.return,l)}if(t===e){Ie=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ie=o;break}Ie=t.return}}var aS=Math.ceil,Qc=aa.ReactCurrentDispatcher,ud=aa.ReactCurrentOwner,cn=aa.ReactCurrentBatchConfig,rt=0,er=null,zt=null,or=0,Ur=0,cs=$a(0),Gt=0,Jo=null,wi=0,Ru=0,fd=0,_o=null,Rr=null,hd=0,Ps=1/0,Vn=null,Zc=!1,V0=null,Pa=null,rc=!1,wa=null,eu=0,ko=0,G0=null,Pc=-1,Rc=0;function br(){return rt&6?Dt():Pc!==-1?Pc:Pc=Dt()}function Ra(e){return e.mode&1?rt&2&&or!==0?or&-or:$k.transition!==null?(Rc===0&&(Rc=xv()),Rc):(e=ct,e!==0||(e=window.event,e=e===void 0?16:Tv(e.type)),e):1}function Tn(e,t,r,n){if(50<ko)throw ko=0,G0=null,Error(Ee(185));_l(e,r,n),(!(rt&2)||e!==er)&&(e===er&&(!(rt&2)&&(Ru|=r),Gt===4&&ga(e,or)),Dr(e,n),r===1&&rt===0&&!(t.mode&1)&&(Ps=Dt()+500,Cu&&za()))}function Dr(e,t){var r=e.callbackNode;$2(e,t);var n=Bc(e,e===er?or:0);if(n===0)r!==null&&Ip(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Ip(r),t===1)e.tag===0?jk(Tm.bind(null,e)):Hv(Tm.bind(null,e)),Lk(function(){!(rt&6)&&za()}),r=null;else{switch(wv(n)){case 1:r=Uh;break;case 4:r=gv;break;case 16:r=Lc;break;case 536870912:r=vv;break;default:r=Lc}r=zx(r,Dx.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Dx(e,t){if(Pc=-1,Rc=0,rt&6)throw Error(Ee(327));var r=e.callbackNode;if(xs()&&e.callbackNode!==r)return null;var n=Bc(e,e===er?or:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=tu(e,n);else{t=n;var a=rt;rt|=2;var i=Bx();(er!==e||or!==t)&&(Vn=null,Ps=Dt()+500,li(e,t));do try{oS();break}catch(o){Lx(e,o)}while(!0);Jh(),Qc.current=i,rt=a,zt!==null?t=0:(er=null,or=0,t=Gt)}if(t!==0){if(t===2&&(a=w0(e),a!==0&&(n=a,t=q0(e,a))),t===1)throw r=Jo,li(e,0),ga(e,n),Dr(e,Dt()),r;if(t===6)ga(e,n);else{if(a=e.current.alternate,!(n&30)&&!iS(a)&&(t=tu(e,n),t===2&&(i=w0(e),i!==0&&(n=i,t=q0(e,i))),t===1))throw r=Jo,li(e,0),ga(e,n),Dr(e,Dt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Ee(345));case 2:Qa(e,Rr,Vn);break;case 3:if(ga(e,n),(n&130023424)===n&&(t=hd+500-Dt(),10<t)){if(Bc(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){br(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=C0(Qa.bind(null,e,Rr,Vn),t);break}Qa(e,Rr,Vn);break;case 4:if(ga(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-En(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=Dt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*aS(n/1960))-n,10<n){e.timeoutHandle=C0(Qa.bind(null,e,Rr,Vn),n);break}Qa(e,Rr,Vn);break;case 5:Qa(e,Rr,Vn);break;default:throw Error(Ee(329))}}}return Dr(e,Dt()),e.callbackNode===r?Dx.bind(null,e):null}function q0(e,t){var r=_o;return e.current.memoizedState.isDehydrated&&(li(e,t).flags|=256),e=tu(e,t),e!==2&&(t=Rr,Rr=r,t!==null&&K0(t)),e}function K0(e){Rr===null?Rr=e:Rr.push.apply(Rr,e)}function iS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!An(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ga(e,t){for(t&=~fd,t&=~Ru,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-En(t),n=1<<r;e[r]=-1,t&=~n}}function Tm(e){if(rt&6)throw Error(Ee(327));xs();var t=Bc(e,0);if(!(t&1))return Dr(e,Dt()),null;var r=tu(e,t);if(e.tag!==0&&r===2){var n=w0(e);n!==0&&(t=n,r=q0(e,n))}if(r===1)throw r=Jo,li(e,0),ga(e,t),Dr(e,Dt()),r;if(r===6)throw Error(Ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Qa(e,Rr,Vn),Dr(e,Dt()),null}function dd(e,t){var r=rt;rt|=1;try{return e(t)}finally{rt=r,rt===0&&(Ps=Dt()+500,Cu&&za())}}function yi(e){wa!==null&&wa.tag===0&&!(rt&6)&&xs();var t=rt;rt|=1;var r=cn.transition,n=ct;try{if(cn.transition=null,ct=1,e)return e()}finally{ct=n,cn.transition=r,rt=t,!(rt&6)&&za()}}function pd(){Ur=cs.current,gt(cs)}function li(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Dk(r)),zt!==null)for(r=zt.return;r!==null;){var n=r;switch(Kh(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&zc();break;case 3:As(),gt(Ir),gt(yr),nd();break;case 5:rd(n);break;case 4:As();break;case 13:gt(Et);break;case 19:gt(Et);break;case 10:Qh(n.type._context);break;case 22:case 23:pd()}r=r.return}if(er=e,zt=e=Oa(e.current,null),or=Ur=t,Gt=0,Jo=null,fd=Ru=wi=0,Rr=_o=null,ii!==null){for(t=0;t<ii.length;t++)if(r=ii[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}ii=null}return e}function Lx(e,t){do{var r=zt;try{if(Jh(),Cc.current=Jc,Yc){for(var n=bt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Yc=!1}if(xi=0,Yt=Ht=bt=null,wo=!1,Ko=0,ud.current=null,r===null||r.return===null){Gt=1,Jo=t,zt=null;break}e:{var i=e,s=r.return,o=r,l=t;if(t=or,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=hm(s);if(h!==null){h.flags&=-257,dm(h,s,o,i,t),h.mode&1&&fm(i,c,t),t=h,l=c;var m=t.updateQueue;if(m===null){var d=new Set;d.add(l),t.updateQueue=d}else m.add(l);break e}else{if(!(t&1)){fm(i,c,t),md();break e}l=Error(Ee(426))}}else if(yt&&o.mode&1){var v=hm(s);if(v!==null){!(v.flags&65536)&&(v.flags|=256),dm(v,s,o,i,t),Xh(Fs(l,o));break e}}i=l=Fs(l,o),Gt!==4&&(Gt=2),_o===null?_o=[i]:_o.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var g=wx(i,l,t);im(i,g);break e;case 1:o=l;var x=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Pa===null||!Pa.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=yx(i,o,t);im(i,_);break e}}i=i.return}while(i!==null)}Mx(r)}catch(S){t=S,zt===r&&r!==null&&(zt=r=r.return);continue}break}while(!0)}function Bx(){var e=Qc.current;return Qc.current=Jc,e===null?Jc:e}function md(){(Gt===0||Gt===3||Gt===2)&&(Gt=4),er===null||!(wi&268435455)&&!(Ru&268435455)||ga(er,or)}function tu(e,t){var r=rt;rt|=2;var n=Bx();(er!==e||or!==t)&&(Vn=null,li(e,t));do try{sS();break}catch(a){Lx(e,a)}while(!0);if(Jh(),rt=r,Qc.current=n,zt!==null)throw Error(Ee(261));return er=null,or=0,Gt}function sS(){for(;zt!==null;)Ux(zt)}function oS(){for(;zt!==null&&!O2();)Ux(zt)}function Ux(e){var t=$x(e.alternate,e,Ur);e.memoizedProps=e.pendingProps,t===null?Mx(e):zt=t,ud.current=null}function Mx(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=eS(r,t),r!==null){r.flags&=32767,zt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Gt=6,zt=null;return}}else if(r=Zk(r,t,Ur),r!==null){zt=r;return}if(t=t.sibling,t!==null){zt=t;return}zt=t=e}while(t!==null);Gt===0&&(Gt=5)}function Qa(e,t,r){var n=ct,a=cn.transition;try{cn.transition=null,ct=1,lS(e,t,r,n)}finally{cn.transition=a,ct=n}return null}function lS(e,t,r,n){do xs();while(wa!==null);if(rt&6)throw Error(Ee(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ee(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(z2(e,i),e===er&&(zt=er=null,or=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||rc||(rc=!0,zx(Lc,function(){return xs(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=cn.transition,cn.transition=null;var s=ct;ct=1;var o=rt;rt|=4,ud.current=null,rS(e,r),Ix(r,e),Ak(T0),Uc=!!E0,T0=E0=null,e.current=r,nS(r),I2(),rt=o,ct=s,cn.transition=i}else e.current=r;if(rc&&(rc=!1,wa=e,eu=a),i=e.pendingLanes,i===0&&(Pa=null),L2(r.stateNode),Dr(e,Dt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Zc)throw Zc=!1,e=V0,V0=null,e;return eu&1&&e.tag!==0&&xs(),i=e.pendingLanes,i&1?e===G0?ko++:(ko=0,G0=e):ko=0,za(),null}function xs(){if(wa!==null){var e=wv(eu),t=cn.transition,r=ct;try{if(cn.transition=null,ct=16>e?16:e,wa===null)var n=!1;else{if(e=wa,wa=null,eu=0,rt&6)throw Error(Ee(331));var a=rt;for(rt|=4,Ie=e.current;Ie!==null;){var i=Ie,s=i.child;if(Ie.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ie=c;Ie!==null;){var u=Ie;switch(u.tag){case 0:case 11:case 15:yo(8,u,i)}var f=u.child;if(f!==null)f.return=u,Ie=f;else for(;Ie!==null;){u=Ie;var p=u.sibling,h=u.return;if(Px(u),u===c){Ie=null;break}if(p!==null){p.return=h,Ie=p;break}Ie=h}}}var m=i.alternate;if(m!==null){var d=m.child;if(d!==null){m.child=null;do{var v=d.sibling;d.sibling=null,d=v}while(d!==null)}}Ie=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,Ie=s;else e:for(;Ie!==null;){if(i=Ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:yo(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,Ie=g;break e}Ie=i.return}}var x=e.current;for(Ie=x;Ie!==null;){s=Ie;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,Ie=w;else e:for(s=x;Ie!==null;){if(o=Ie,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Pu(9,o)}}catch(S){Ft(o,o.return,S)}if(o===s){Ie=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,Ie=_;break e}Ie=o.return}}if(rt=a,za(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(ku,e)}catch{}n=!0}return n}finally{ct=r,cn.transition=t}}return!1}function bm(e,t,r){t=Fs(r,t),t=wx(e,t,1),e=Fa(e,t,1),t=br(),e!==null&&(_l(e,1,t),Dr(e,t))}function Ft(e,t,r){if(e.tag===3)bm(e,e,r);else for(;t!==null;){if(t.tag===3){bm(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Pa===null||!Pa.has(n))){e=Fs(r,e),e=yx(t,e,1),t=Fa(t,e,1),e=br(),t!==null&&(_l(t,1,e),Dr(t,e));break}}t=t.return}}function cS(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=br(),e.pingedLanes|=e.suspendedLanes&r,er===e&&(or&r)===r&&(Gt===4||Gt===3&&(or&130023424)===or&&500>Dt()-hd?li(e,0):fd|=r),Dr(e,t)}function jx(e,t){t===0&&(e.mode&1?(t=Gl,Gl<<=1,!(Gl&130023424)&&(Gl=4194304)):t=1);var r=br();e=ra(e,t),e!==null&&(_l(e,t,r),Dr(e,r))}function uS(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),jx(e,r)}function fS(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ee(314))}n!==null&&n.delete(t),jx(e,r)}var $x;$x=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ir.current)Or=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Or=!1,Qk(e,t,r);Or=!!(e.flags&131072)}else Or=!1,yt&&t.flags&1048576&&Vv(t,Vc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Fc(e,t),e=t.pendingProps;var a=Ts(t,yr.current);vs(t,r),a=id(null,t,n,e,a,r);var i=sd();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Nr(n)?(i=!0,Wc(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,ed(t),a.updater=Fu,t.stateNode=a,a._reactInternals=t,N0(t,n,e,r),t=B0(null,t,n,!0,i,r)):(t.tag=0,yt&&i&&qh(t),Sr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Fc(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=dS(n),e=xn(n,e),a){case 0:t=L0(null,t,n,e,r);break e;case 1:t=gm(null,t,n,e,r);break e;case 11:t=pm(null,t,n,e,r);break e;case 14:t=mm(null,t,n,xn(n.type,e),r);break e}throw Error(Ee(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:xn(n,a),L0(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:xn(n,a),gm(e,t,n,a,r);case 3:e:{if(Ex(t),e===null)throw Error(Ee(387));n=t.pendingProps,i=t.memoizedState,a=i.element,Jv(e,t),Kc(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Fs(Error(Ee(423)),t),t=vm(e,t,n,r,a);break e}else if(n!==a){a=Fs(Error(Ee(424)),t),t=vm(e,t,n,r,a);break e}else for(Wr=Aa(t.stateNode.containerInfo.firstChild),Hr=t,yt=!0,kn=null,r=Xv(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(bs(),n===a){t=na(e,t,r);break e}Sr(e,t,n,r)}t=t.child}return t;case 5:return Qv(t),e===null&&R0(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,b0(n,a)?s=null:i!==null&&b0(n,i)&&(t.flags|=32),Sx(e,t),Sr(e,t,s,r),t.child;case 6:return e===null&&R0(t),null;case 13:return Tx(e,t,r);case 4:return td(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Cs(t,null,n,r):Sr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:xn(n,a),pm(e,t,n,a,r);case 7:return Sr(e,t,t.pendingProps,r),t.child;case 8:return Sr(e,t,t.pendingProps.children,r),t.child;case 12:return Sr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,dt(Gc,n._currentValue),n._currentValue=s,i!==null)if(An(i.value,s)){if(i.children===a.children&&!Ir.current){t=na(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=Jn(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),O0(i.return,r,t),o.lanes|=r;break}l=l.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(Ee(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),O0(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Sr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,vs(t,r),a=fn(a),n=n(a),t.flags|=1,Sr(e,t,n,r),t.child;case 14:return n=t.type,a=xn(n,t.pendingProps),a=xn(n.type,a),mm(e,t,n,a,r);case 15:return _x(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:xn(n,a),Fc(e,t),t.tag=1,Nr(n)?(e=!0,Wc(t)):e=!1,vs(t,r),xx(t,n,a),N0(t,n,a,r),B0(null,t,n,!0,e,r);case 19:return bx(e,t,r);case 22:return kx(e,t,r)}throw Error(Ee(156,t.tag))};function zx(e,t){return mv(e,t)}function hS(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function on(e,t,r,n){return new hS(e,t,r,n)}function gd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function dS(e){if(typeof e=="function")return gd(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Dh)return 11;if(e===Lh)return 14}return 2}function Oa(e,t){var r=e.alternate;return r===null?(r=on(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Oc(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")gd(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Zi:return ci(r.children,a,i,t);case Nh:s=8,a|=8;break;case a0:return e=on(12,r,t,a|2),e.elementType=a0,e.lanes=i,e;case i0:return e=on(13,r,t,a),e.elementType=i0,e.lanes=i,e;case s0:return e=on(19,r,t,a),e.elementType=s0,e.lanes=i,e;case Qg:return Ou(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Yg:s=10;break e;case Jg:s=9;break e;case Dh:s=11;break e;case Lh:s=14;break e;case ha:s=16,n=null;break e}throw Error(Ee(130,e==null?e:typeof e,""))}return t=on(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function ci(e,t,r,n){return e=on(7,e,n,t),e.lanes=r,e}function Ou(e,t,r,n){return e=on(22,e,n,t),e.elementType=Qg,e.lanes=r,e.stateNode={isHidden:!1},e}function Af(e,t,r){return e=on(6,e,null,t),e.lanes=r,e}function Ff(e,t,r){return t=on(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function pS(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cf(0),this.expirationTimes=cf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cf(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function vd(e,t,r,n,a,i,s,o,l){return e=new pS(e,t,r,o,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=on(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ed(i),e}function mS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Wx(e){if(!e)return Da;e=e._reactInternals;e:{if(Fi(e)!==e||e.tag!==1)throw Error(Ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Nr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ee(171))}if(e.tag===1){var r=e.type;if(Nr(r))return Wv(e,r,t)}return t}function Hx(e,t,r,n,a,i,s,o,l){return e=vd(r,n,!0,e,a,i,s,o,l),e.context=Wx(null),r=e.current,n=br(),a=Ra(r),i=Jn(n,a),i.callback=t??null,Fa(r,i,a),e.current.lanes=a,_l(e,a,n),Dr(e,n),e}function Iu(e,t,r,n){var a=t.current,i=br(),s=Ra(a);return r=Wx(r),t.context===null?t.context=r:t.pendingContext=r,t=Jn(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Fa(a,t,s),e!==null&&(Tn(e,a,s,i),bc(e,a,s)),s}function ru(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Cm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function xd(e,t){Cm(e,t),(e=e.alternate)&&Cm(e,t)}function gS(){return null}var Vx=typeof reportError=="function"?reportError:function(e){console.error(e)};function wd(e){this._internalRoot=e}Nu.prototype.render=wd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ee(409));Iu(e,t,null,null)};Nu.prototype.unmount=wd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;yi(function(){Iu(null,e,null,null)}),t[ta]=null}};function Nu(e){this._internalRoot=e}Nu.prototype.unstable_scheduleHydration=function(e){if(e){var t=kv();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ma.length&&t!==0&&t<ma[r].priority;r++);ma.splice(r,0,e),r===0&&Ev(e)}};function yd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Du(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Am(){}function vS(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var c=ru(s);i.call(c)}}var s=Hx(t,n,e,0,null,!1,!1,"",Am);return e._reactRootContainer=s,e[ta]=s.current,Wo(e.nodeType===8?e.parentNode:e),yi(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=ru(l);o.call(c)}}var l=vd(e,0,!1,null,null,!1,!1,"",Am);return e._reactRootContainer=l,e[ta]=l.current,Wo(e.nodeType===8?e.parentNode:e),yi(function(){Iu(t,l,r,n)}),l}function Lu(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=ru(s);o.call(l)}}Iu(t,s,e,a)}else s=vS(r,t,e,a,n);return ru(s)}yv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=oo(t.pendingLanes);r!==0&&(Mh(t,r|1),Dr(t,Dt()),!(rt&6)&&(Ps=Dt()+500,za()))}break;case 13:yi(function(){var n=ra(e,1);if(n!==null){var a=br();Tn(n,e,1,a)}}),xd(e,1)}};jh=function(e){if(e.tag===13){var t=ra(e,134217728);if(t!==null){var r=br();Tn(t,e,134217728,r)}xd(e,134217728)}};_v=function(e){if(e.tag===13){var t=Ra(e),r=ra(e,t);if(r!==null){var n=br();Tn(r,e,t,n)}xd(e,t)}};kv=function(){return ct};Sv=function(e,t){var r=ct;try{return ct=e,t()}finally{ct=r}};g0=function(e,t,r){switch(t){case"input":if(c0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=bu(n);if(!a)throw Error(Ee(90));ev(n),c0(n,a)}}}break;case"textarea":rv(e,r);break;case"select":t=r.value,t!=null&&ds(e,!!r.multiple,t,!1)}};cv=dd;uv=yi;var xS={usingClientEntryPoint:!1,Events:[Sl,ns,bu,ov,lv,dd]},ro={findFiberByHostInstance:ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wS={bundleType:ro.bundleType,version:ro.version,rendererPackageName:ro.rendererPackageName,rendererConfig:ro.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:aa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=dv(e),e===null?null:e.stateNode},findFiberByHostInstance:ro.findFiberByHostInstance||gS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nc.isDisabled&&nc.supportsFiber)try{ku=nc.inject(wS),Bn=nc}catch{}}Xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xS;Xr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yd(t))throw Error(Ee(200));return mS(e,t,null,r)};Xr.createRoot=function(e,t){if(!yd(e))throw Error(Ee(299));var r=!1,n="",a=Vx;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=vd(e,1,!1,null,null,r,!1,n,a),e[ta]=t.current,Wo(e.nodeType===8?e.parentNode:e),new wd(t)};Xr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ee(188)):(e=Object.keys(e).join(","),Error(Ee(268,e)));return e=dv(t),e=e===null?null:e.stateNode,e};Xr.flushSync=function(e){return yi(e)};Xr.hydrate=function(e,t,r){if(!Du(t))throw Error(Ee(200));return Lu(null,e,t,!0,r)};Xr.hydrateRoot=function(e,t,r){if(!yd(e))throw Error(Ee(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=Vx;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=Hx(t,null,e,1,r??null,a,!1,i,s),e[ta]=t.current,Wo(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Nu(t)};Xr.render=function(e,t,r){if(!Du(t))throw Error(Ee(200));return Lu(null,e,t,!1,r)};Xr.unmountComponentAtNode=function(e){if(!Du(e))throw Error(Ee(40));return e._reactRootContainer?(yi(function(){Lu(null,null,e,!1,function(){e._reactRootContainer=null,e[ta]=null})}),!0):!1};Xr.unstable_batchedUpdates=dd;Xr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Du(r))throw Error(Ee(200));if(e==null||e._reactInternals===void 0)throw Error(Ee(38));return Lu(e,t,r,!1,n)};Xr.version="18.3.1-next-f1338f8080-20240426";function Gx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Gx)}catch(e){console.error(e)}}Gx(),Gg.exports=Xr;var yS=Gg.exports,Fm=yS;r0.createRoot=Fm.createRoot,r0.hydrateRoot=Fm.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qo(){return Qo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qo.apply(this,arguments)}var ya;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ya||(ya={}));const Pm="popstate";function _S(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:s,hash:o}=n.location;return X0("",{pathname:i,search:s,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:nu(a)}return SS(t,r,null,e)}function Lt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function _d(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function kS(){return Math.random().toString(36).substr(2,8)}function Rm(e,t){return{usr:e.state,key:e.key,idx:t}}function X0(e,t,r,n){return r===void 0&&(r=null),Qo({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Bs(t):t,{state:r,key:t&&t.key||n||kS()})}function nu(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Bs(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function SS(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,o=ya.Pop,l=null,c=u();c==null&&(c=0,s.replaceState(Qo({},s.state,{idx:c}),""));function u(){return(s.state||{idx:null}).idx}function f(){o=ya.Pop;let v=u(),g=v==null?null:v-c;c=v,l&&l({action:o,location:d.location,delta:g})}function p(v,g){o=ya.Push;let x=X0(d.location,v,g);c=u()+1;let w=Rm(x,c),_=d.createHref(x);try{s.pushState(w,"",_)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;a.location.assign(_)}i&&l&&l({action:o,location:d.location,delta:1})}function h(v,g){o=ya.Replace;let x=X0(d.location,v,g);c=u();let w=Rm(x,c),_=d.createHref(x);s.replaceState(w,"",_),i&&l&&l({action:o,location:d.location,delta:0})}function m(v){let g=a.location.origin!=="null"?a.location.origin:a.location.href,x=typeof v=="string"?v:nu(v);return x=x.replace(/ $/,"%20"),Lt(g,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,g)}let d={get action(){return o},get location(){return e(a,s)},listen(v){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(Pm,f),l=v,()=>{a.removeEventListener(Pm,f),l=null}},createHref(v){return t(a,v)},createURL:m,encodeLocation(v){let g=m(v);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:p,replace:h,go(v){return s.go(v)}};return d}var Om;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Om||(Om={}));function ES(e,t,r){return r===void 0&&(r="/"),TS(e,t,r)}function TS(e,t,r,n){let a=typeof t=="string"?Bs(t):t,i=kd(a.pathname||"/",r);if(i==null)return null;let s=qx(e);bS(s);let o=null;for(let l=0;o==null&&l<s.length;++l){let c=US(i);o=DS(s[l],c)}return o}function qx(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,s,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};l.relativePath.startsWith("/")&&(Lt(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Ia([n,l.relativePath]),u=r.concat(l);i.children&&i.children.length>0&&(Lt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),qx(i.children,t,u,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:IS(c,i.index),routesMeta:u})};return e.forEach((i,s)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,s);else for(let l of Kx(i.path))a(i,s,l)}),t}function Kx(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=Kx(n.join("/")),o=[];return o.push(...s.map(l=>l===""?i:[i,l].join("/"))),a&&o.push(...s),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function bS(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:NS(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const CS=/^:[\w-]+$/,AS=3,FS=2,PS=1,RS=10,OS=-2,Im=e=>e==="*";function IS(e,t){let r=e.split("/"),n=r.length;return r.some(Im)&&(n+=OS),t&&(n+=FS),r.filter(a=>!Im(a)).reduce((a,i)=>a+(CS.test(i)?AS:i===""?PS:RS),n)}function NS(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function DS(e,t,r){let{routesMeta:n}=e,a={},i="/",s=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=LS({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),p=l.route;if(!f)return null;Object.assign(a,f.params),s.push({params:a,pathname:Ia([i,f.pathname]),pathnameBase:WS(Ia([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=Ia([i,f.pathnameBase]))}return s}function LS(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=BS(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,u,f)=>{let{paramName:p,isOptional:h}=u;if(p==="*"){let d=o[f]||"";s=i.slice(0,i.length-d.length).replace(/(.)\/+$/,"$1")}const m=o[f];return h&&!m?c[p]=void 0:c[p]=(m||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:s,pattern:e}}function BS(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),_d(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function US(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return _d(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function kd(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const MS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jS=e=>MS.test(e);function $S(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Bs(e):e,i;if(r)if(jS(r))i=r;else{if(r.includes("//")){let s=r;r=r.replace(/\/\/+/g,"/"),_d(!1,"Pathnames cannot have embedded double slashes - normalizing "+(s+" -> "+r))}r.startsWith("/")?i=Nm(r.substring(1),"/"):i=Nm(r,t)}else i=t;return{pathname:i,search:HS(n),hash:VS(a)}}function Nm(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Pf(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zS(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Sd(e,t){let r=zS(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Ed(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Bs(e):(a=Qo({},e),Lt(!a.pathname||!a.pathname.includes("?"),Pf("?","pathname","search",a)),Lt(!a.pathname||!a.pathname.includes("#"),Pf("#","pathname","hash",a)),Lt(!a.search||!a.search.includes("#"),Pf("#","search","hash",a)));let i=e===""||a.pathname==="",s=i?"/":a.pathname,o;if(s==null)o=r;else{let f=t.length-1;if(!n&&s.startsWith("..")){let p=s.split("/");for(;p[0]==="..";)p.shift(),f-=1;a.pathname=p.join("/")}o=f>=0?t[f]:"/"}let l=$S(a,o),c=s&&s!=="/"&&s.endsWith("/"),u=(i||s===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Ia=e=>e.join("/").replace(/\/\/+/g,"/"),WS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),HS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,VS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function GS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Xx=["post","put","patch","delete"];new Set(Xx);const qS=["get",...Xx];new Set(qS);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zo(){return Zo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zo.apply(this,arguments)}const Td=fe.createContext(null),KS=fe.createContext(null),Wa=fe.createContext(null),Bu=fe.createContext(null),ia=fe.createContext({outlet:null,matches:[],isDataRoute:!1}),Yx=fe.createContext(null);function XS(e,t){let{relative:r}=t===void 0?{}:t;Us()||Lt(!1);let{basename:n,navigator:a}=fe.useContext(Wa),{hash:i,pathname:s,search:o}=Qx(e,{relative:r}),l=s;return n!=="/"&&(l=s==="/"?n:Ia([n,s])),a.createHref({pathname:l,search:o,hash:i})}function Us(){return fe.useContext(Bu)!=null}function Ms(){return Us()||Lt(!1),fe.useContext(Bu).location}function Jx(e){fe.useContext(Wa).static||fe.useLayoutEffect(e)}function js(){let{isDataRoute:e}=fe.useContext(ia);return e?lE():YS()}function YS(){Us()||Lt(!1);let e=fe.useContext(Td),{basename:t,future:r,navigator:n}=fe.useContext(Wa),{matches:a}=fe.useContext(ia),{pathname:i}=Ms(),s=JSON.stringify(Sd(a,r.v7_relativeSplatPath)),o=fe.useRef(!1);return Jx(()=>{o.current=!0}),fe.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let f=Ed(c,JSON.parse(s),i,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Ia([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,s,i,e])}function bd(){let{matches:e}=fe.useContext(ia),t=e[e.length-1];return t?t.params:{}}function Qx(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=fe.useContext(Wa),{matches:a}=fe.useContext(ia),{pathname:i}=Ms(),s=JSON.stringify(Sd(a,n.v7_relativeSplatPath));return fe.useMemo(()=>Ed(e,JSON.parse(s),i,r==="path"),[e,s,i,r])}function JS(e,t){return QS(e,t)}function QS(e,t,r,n){Us()||Lt(!1);let{navigator:a}=fe.useContext(Wa),{matches:i}=fe.useContext(ia),s=i[i.length-1],o=s?s.params:{};s&&s.pathname;let l=s?s.pathnameBase:"/";s&&s.route;let c=Ms(),u;if(t){var f;let v=typeof t=="string"?Bs(t):t;l==="/"||(f=v.pathname)!=null&&f.startsWith(l)||Lt(!1),u=v}else u=c;let p=u.pathname||"/",h=p;if(l!=="/"){let v=l.replace(/^\//,"").split("/");h="/"+p.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=ES(e,{pathname:h}),d=nE(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:Ia([l,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:Ia([l,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,r,n);return t&&d?fe.createElement(Bu.Provider,{value:{location:Zo({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:ya.Pop}},d):d}function ZS(){let e=oE(),t=GS(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return fe.createElement(fe.Fragment,null,fe.createElement("h2",null,"Unexpected Application Error!"),fe.createElement("h3",{style:{fontStyle:"italic"}},t),r?fe.createElement("pre",{style:a},r):null,null)}const eE=fe.createElement(ZS,null);class tE extends fe.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?fe.createElement(ia.Provider,{value:this.props.routeContext},fe.createElement(Yx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function rE(e){let{routeContext:t,match:r,children:n}=e,a=fe.useContext(Td);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),fe.createElement(ia.Provider,{value:t},n)}function nE(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let u=s.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);u>=0||Lt(!1),s=s.slice(0,Math.min(s.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<s.length;u++){let f=s[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=u),f.route.id){let{loaderData:p,errors:h}=r,m=f.route.loader&&p[f.route.id]===void 0&&(!h||h[f.route.id]===void 0);if(f.route.lazy||m){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,f,p)=>{let h,m=!1,d=null,v=null;r&&(h=o&&f.route.id?o[f.route.id]:void 0,d=f.route.errorElement||eE,l&&(c<0&&p===0?(cE("route-fallback"),m=!0,v=null):c===p&&(m=!0,v=f.route.hydrateFallbackElement||null)));let g=t.concat(s.slice(0,p+1)),x=()=>{let w;return h?w=d:m?w=v:f.route.Component?w=fe.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=u,fe.createElement(rE,{match:f,routeContext:{outlet:u,matches:g,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?fe.createElement(tE,{location:r.location,revalidation:r.revalidation,component:d,error:h,children:x(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):x()},null)}var Zx=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Zx||{}),ew=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ew||{});function aE(e){let t=fe.useContext(Td);return t||Lt(!1),t}function iE(e){let t=fe.useContext(KS);return t||Lt(!1),t}function sE(e){let t=fe.useContext(ia);return t||Lt(!1),t}function tw(e){let t=sE(),r=t.matches[t.matches.length-1];return r.route.id||Lt(!1),r.route.id}function oE(){var e;let t=fe.useContext(Yx),r=iE(),n=tw();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function lE(){let{router:e}=aE(Zx.UseNavigateStable),t=tw(ew.UseNavigateStable),r=fe.useRef(!1);return Jx(()=>{r.current=!0}),fe.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Zo({fromRouteId:t},i)))},[e,t])}const Dm={};function cE(e,t,r){Dm[e]||(Dm[e]=!0)}function uE(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function fE(e){let{to:t,replace:r,state:n,relative:a}=e;Us()||Lt(!1);let{future:i,static:s}=fe.useContext(Wa),{matches:o}=fe.useContext(ia),{pathname:l}=Ms(),c=js(),u=Ed(t,Sd(o,i.v7_relativeSplatPath),l,a==="path"),f=JSON.stringify(u);return fe.useEffect(()=>c(JSON.parse(f),{replace:r,state:n,relative:a}),[c,f,a,r,n]),null}function Za(e){Lt(!1)}function hE(e){let{basename:t="/",children:r=null,location:n,navigationType:a=ya.Pop,navigator:i,static:s=!1,future:o}=e;Us()&&Lt(!1);let l=t.replace(/^\/*/,"/"),c=fe.useMemo(()=>({basename:l,navigator:i,static:s,future:Zo({v7_relativeSplatPath:!1},o)}),[l,o,i,s]);typeof n=="string"&&(n=Bs(n));let{pathname:u="/",search:f="",hash:p="",state:h=null,key:m="default"}=n,d=fe.useMemo(()=>{let v=kd(u,l);return v==null?null:{location:{pathname:v,search:f,hash:p,state:h,key:m},navigationType:a}},[l,u,f,p,h,m,a]);return d==null?null:fe.createElement(Wa.Provider,{value:c},fe.createElement(Bu.Provider,{children:r,value:d}))}function dE(e){let{children:t,location:r}=e;return JS(Y0(t),r)}new Promise(()=>{});function Y0(e,t){t===void 0&&(t=[]);let r=[];return fe.Children.forEach(e,(n,a)=>{if(!fe.isValidElement(n))return;let i=[...t,a];if(n.type===fe.Fragment){r.push.apply(r,Y0(n.props.children,i));return}n.type!==Za&&Lt(!1),!n.props.index||!n.props.children||Lt(!1);let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=Y0(n.props.children,i)),r.push(s)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function J0(){return J0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},J0.apply(this,arguments)}function pE(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function mE(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function gE(e,t){return e.button===0&&(!t||t==="_self")&&!mE(e)}const vE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],xE="6";try{window.__reactRouterVersion=xE}catch{}const wE="startTransition",Lm=c2[wE];function yE(e){let{basename:t,children:r,future:n,window:a}=e,i=fe.useRef();i.current==null&&(i.current=_S({window:a,v5Compat:!0}));let s=i.current,[o,l]=fe.useState({action:s.action,location:s.location}),{v7_startTransition:c}=n||{},u=fe.useCallback(f=>{c&&Lm?Lm(()=>l(f)):l(f)},[l,c]);return fe.useLayoutEffect(()=>s.listen(u),[s,u]),fe.useEffect(()=>uE(n),[n]),fe.createElement(hE,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:s,future:n})}const _E=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,So=fe.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:s,state:o,target:l,to:c,preventScrollReset:u,viewTransition:f}=t,p=pE(t,vE),{basename:h}=fe.useContext(Wa),m,d=!1;if(typeof c=="string"&&kE.test(c)&&(m=c,_E))try{let w=new URL(window.location.href),_=c.startsWith("//")?new URL(w.protocol+c):new URL(c),S=kd(_.pathname,h);_.origin===w.origin&&S!=null?c=S+_.search+_.hash:d=!0}catch{}let v=XS(c,{relative:a}),g=SE(c,{replace:s,state:o,target:l,preventScrollReset:u,relative:a,viewTransition:f});function x(w){n&&n(w),w.defaultPrevented||g(w)}return fe.createElement("a",J0({},p,{href:m||v,onClick:d||i?n:x,ref:r,target:l}))});var Bm;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Bm||(Bm={}));var Um;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Um||(Um={}));function SE(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:s,viewTransition:o}=t===void 0?{}:t,l=js(),c=Ms(),u=Qx(e,{relative:s});return fe.useCallback(f=>{if(gE(f,r)){f.preventDefault();let p=n!==void 0?n:nu(c)===nu(u);l(e,{replace:p,state:a,preventScrollReset:i,relative:s,viewTransition:o})}},[c,l,u,n,a,r,e,i,s,o])}const Q0=(e,t)=>t.some(r=>e instanceof r);let Mm,jm;function EE(){return Mm||(Mm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function TE(){return jm||(jm=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Z0=new WeakMap,Rf=new WeakMap,Uu=new WeakMap;function bE(e){const t=new Promise((r,n)=>{const a=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{r(ui(e.result)),a()},s=()=>{n(e.error),a()};e.addEventListener("success",i),e.addEventListener("error",s)});return Uu.set(t,e),t}function CE(e){if(Z0.has(e))return;const t=new Promise((r,n)=>{const a=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{r(),a()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});Z0.set(e,t)}let eh={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return Z0.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ui(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function rw(e){eh=e(eh)}function AE(e){return TE().includes(e)?function(...t){return e.apply(th(this),t),ui(this.request)}:function(...t){return ui(e.apply(th(this),t))}}function FE(e){return typeof e=="function"?AE(e):(e instanceof IDBTransaction&&CE(e),Q0(e,EE())?new Proxy(e,eh):e)}function ui(e){if(e instanceof IDBRequest)return bE(e);if(Rf.has(e))return Rf.get(e);const t=FE(e);return t!==e&&(Rf.set(e,t),Uu.set(t,e)),t}const th=e=>Uu.get(e);function PE(e,t,{blocked:r,upgrade:n,blocking:a,terminated:i}={}){const s=indexedDB.open(e,t),o=ui(s);return n&&s.addEventListener("upgradeneeded",l=>{n(ui(s.result),l.oldVersion,l.newVersion,ui(s.transaction),l)}),r&&s.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),a&&l.addEventListener("versionchange",c=>a(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const RE=["get","getKey","getAll","getAllKeys","count"],OE=["put","add","delete","clear"],Of=new Map;function $m(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Of.get(t))return Of.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,a=OE.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||RE.includes(r)))return;const i=async function(s,...o){const l=this.transaction(s,a?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),a&&l.done]))[0]};return Of.set(t,i),i}rw(e=>({...e,get:(t,r,n)=>$m(t,r)||e.get(t,r,n),has:(t,r)=>!!$m(t,r)||e.has(t,r)}));const IE=["continue","continuePrimaryKey","advance"],zm={},rh=new WeakMap,nw=new WeakMap,NE={get(e,t){if(!IE.includes(t))return e[t];let r=zm[t];return r||(r=zm[t]=function(...n){rh.set(this,nw.get(this)[t](...n))}),r}};async function*DE(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const r=new Proxy(t,NE);for(nw.set(r,t),Uu.set(r,th(t));t;)yield r,t=await(rh.get(r)||t.continue()),rh.delete(r)}function Wm(e,t){return t===Symbol.asyncIterator&&Q0(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&Q0(e,[IDBIndex,IDBObjectStore])}rw(e=>({...e,get(t,r,n){return Wm(t,r)?DE:e.get(t,r,n)},has(t,r){return Wm(t,r)||e.has(t,r)}}));const LE="site-walk-db",BE=1,ze={async getDB(){return PE(LE,BE,{upgrade(e){if(e.objectStoreNames.contains("sites")||e.createObjectStore("sites",{keyPath:"id"}),!e.objectStoreNames.contains("photos")){const t=e.createObjectStore("photos",{keyPath:"id"});t.createIndex("siteId","siteId",{unique:!1}),t.createIndex("status","status",{unique:!1})}e.objectStoreNames.contains("questionnaires")||e.createObjectStore("questionnaires",{keyPath:"siteId"}),e.objectStoreNames.contains("settings")||e.createObjectStore("settings",{keyPath:"key"}),e.objectStoreNames.contains("syncQueue")||e.createObjectStore("syncQueue",{keyPath:"id",autoIncrement:!0}).createIndex("created","created",{unique:!1})}})},async saveSites(e){const r=(await this.getDB()).transaction("sites","readwrite"),n=r.objectStore("sites");await Promise.all(e.map(a=>n.put(a))),await r.done},async getSites(){return(await this.getDB()).getAll("sites")},async getSite(e){return(await this.getDB()).get("sites",e)},async savePhoto(e,t){const r=await this.getDB(),n={...t,siteId:e,status:"pending",timestamp:new Date().toISOString()};return await r.put("photos",n),n},async getPhotos(e){return(await this.getDB()).getAllFromIndex("photos","siteId",e)},async getPhotoMetadata(e){return(await(await this.getDB()).getAllFromIndex("photos","siteId",e)).map(n=>({id:n.id,photoReqId:n.photoReqId,photoReqName:n.photoReqName,filename:n.filename,status:n.status,capturedAt:n.capturedAt,size:n.size}))},async getAllPhotos(){return(await this.getDB()).getAll("photos")},async deletePhoto(e){await(await this.getDB()).delete("photos",e)},async saveQuestionnaire(e,t,r="pending"){const n=await this.getDB(),a={siteId:e,...t,status:r,completedAt:new Date().toISOString()};await n.put("questionnaires",a)},async deleteQuestionnaire(e){await(await this.getDB()).delete("questionnaires",e)},async updatePhotoStatus(e,t){const r=await this.getDB(),n=await r.get("photos",e);n&&(n.status=t,t==="synced"&&(n.syncedAt=new Date().toISOString()),await r.put("photos",n))},async getQuestionnaire(e){return(await this.getDB()).get("questionnaires",e)},async getAllQuestionnaires(){return(await this.getDB()).getAll("questionnaires")},async savePhotoRequirements(e){await(await this.getDB()).put("settings",{key:"photo_requirements",value:e})},async getPhotoRequirements(){const t=await(await this.getDB()).get("settings","photo_requirements");return t?t.value:[]},async setCurrentSite(e){await(await this.getDB()).put("settings",{key:"current_site",value:e})},async getCurrentSite(){const t=await(await this.getDB()).get("settings","current_site");return t?t.value:null},async addToSyncQueue(e){const t=await this.getDB(),r={...e,created:new Date().toISOString(),status:"pending"};await t.add("syncQueue",r)},async getSyncQueue(){return(await this.getDB()).getAll("syncQueue")},async removeFromSyncQueue(e){await(await this.getDB()).delete("syncQueue",e)},async clearAll(){const e=await this.getDB(),t=["sites","photos","questionnaires","settings","syncQueue"],r=e.transaction(t,"readwrite");await Promise.all(t.map(n=>r.objectStore(n).clear())),await r.done},async exportAllData(){const e=await this.getDB();return{sites:await e.getAll("sites"),photos:await e.getAll("photos"),questionnaires:await e.getAll("questionnaires"),exportDate:new Date().toISOString()}}};function UE({sites:e,onRefresh:t}){const[r,n]=fe.useState(e),[a,i]=fe.useState(""),[s,o]=fe.useState({}),[l,c]=fe.useState({});fe.useEffect(()=>{const h=async()=>{const m={};try{const d=await ze.getAllPhotos(),v=await ze.getAllQuestionnaires(),g=await ze.getPhotoRequirements();e.forEach(x=>{const w=d.filter(E=>E.siteId===x.id),_=v.find(E=>E.siteId===x.id),S=new Set(w.map(E=>E.photoReqId));m[x.id]={photosComplete:S.size===g.length,photoCount:S.size,totalPhotoReqs:g.length,questionnaireComplete:!!_}}),o(m)}catch(d){console.error("Error calculating site status:",d)}};e.length>0&&h()},[e]),fe.useEffect(()=>{if(!a)n(e);else{const h=d=>d==null?"":typeof d=="object"?JSON.stringify(d):String(d),m=e.filter(d=>h(d.name).toLowerCase().includes(a.toLowerCase())||h(d.id).includes(a)||h(d.address).toLowerCase().includes(a.toLowerCase())||h(d.city).toLowerCase().includes(a.toLowerCase())||h(d.phase).toLowerCase().includes(a.toLowerCase()));n(m)}},[a,e]);const u={};r.forEach(h=>{const m=h.phase||"No Phase";u[m]||(u[m]=[]),u[m].push(h)}),Object.keys(u).forEach(h=>{u[h].sort((m,d)=>{const v=(m.name||"").toLowerCase(),g=(d.name||"").toLowerCase();return v.localeCompare(g)})});const f=Object.keys(u).sort((h,m)=>{var g,x;const d=parseInt(((g=h.match(/\d+/))==null?void 0:g[0])||"999"),v=parseInt(((x=m.match(/\d+/))==null?void 0:x[0])||"999");return d-v}),p=h=>{c(m=>({...m,[h]:!m[h]}))};return D.jsxs("div",{className:"screen",children:[D.jsxs("header",{className:"bg-blue-600 text-white p-4 shadow-md sticky top-0 z-10 flex justify-between items-center",children:[D.jsx("h1",{className:"text-xl font-bold",children:"Site Walks"}),D.jsx("button",{onClick:t,className:"p-2",children:D.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:D.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),D.jsxs("div",{className:"p-4",children:[D.jsxs("div",{className:"mb-4 text-sm text-gray-600",children:[e.length," Active Sites"]}),e.length===0?D.jsxs("div",{className:"text-center py-10 text-gray-500",children:[D.jsx("p",{className:"mb-4",children:"No sites loaded."}),D.jsx("button",{onClick:()=>window.location.reload(),className:"text-blue-600 underline mb-8",children:"Tap to Retry"}),D.jsx("div",{className:"mt-8 border-t pt-4 text-left",children:D.jsxs("details",{className:"text-xs text-gray-500",children:[D.jsx("summary",{className:"cursor-pointer mb-2 font-bold",children:"Troubleshooting Tools"}),D.jsx("button",{onClick:async()=>{const h=m=>{const d=document.getElementById("home-logs");d&&(d.innerHTML+=`<div>${new Date().toLocaleTimeString()}: ${m}</div>`)};document.getElementById("home-logs").style.display="block",h("Testing API Connection...");try{const m=await fetch("/api/proxy",{method:"POST",headers:{"Content-Type":"application/json","x-auth-pin":"2025"},body:JSON.stringify({endpoint:"/sites/root"})});h(`API Status: ${m.status} ${m.statusText}`),m.ok?(h("SUCCESS: Backend is reachable!"),h("Try tapping 'Tap to Retry' above.")):h(`FAILED: ${m.status}`)}catch(m){h(`Fetch Error: ${m.message}`)}},className:"bg-gray-200 px-3 py-1 rounded text-xs mb-2 border border-gray-300",children:"Test Connection"}),D.jsx("div",{id:"home-logs",className:"bg-gray-100 p-2 rounded text-xs h-32 overflow-y-auto font-mono text-black mt-2 hidden"})]})})]}):D.jsxs("div",{children:[D.jsx("input",{type:"text",placeholder:" Search sites...",value:a,onChange:h=>i(h.target.value),style:{width:"100%",padding:"12px 16px",fontSize:"16px",border:"1px solid #ddd",borderRadius:"8px",marginBottom:"20px",boxSizing:"border-box"}}),r.length===0?D.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",color:"#666"},children:[D.jsx("p",{style:{fontSize:"18px",marginBottom:"12px"},children:"No sites found"}),D.jsx("p",{style:{fontSize:"14px"},children:"Try a different search term"})]}):D.jsx("div",{className:"grid gap-4",children:f.map(h=>{const m=u[h],d=l[h];return D.jsxs("div",{style:{marginBottom:"16px"},children:[D.jsxs("div",{onClick:()=>p(h),style:{background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",color:"white",padding:"16px",borderRadius:"8px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:d?"8px":"0"},children:[D.jsxs("div",{children:[D.jsx("h3",{style:{margin:0,fontSize:"18px"},children:h}),D.jsxs("p",{style:{margin:"4px 0 0 0",fontSize:"14px",opacity:.9},children:[m.length," site",m.length!==1?"s":""]})]}),D.jsx("span",{style:{fontSize:"24px",transition:"transform 0.3s",transform:d?"rotate(180deg)":"rotate(0deg)"},children:""})]}),d&&D.jsx("div",{style:{paddingLeft:"8px"},children:m.map(v=>{const g=s[v.id]||{},x=g.photosComplete&&g.questionnaireComplete;return D.jsx(So,{to:`/site/${v.id}`,className:"site-card",style:{display:"block",padding:"16px",marginBottom:"12px",background:"white",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",textDecoration:"none",color:"inherit",border:x?"2px solid #4caf50":"1px solid #e0e0e0"},children:D.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[D.jsxs("div",{style:{flex:1},children:[D.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",color:"#1976d2"},children:v.name||"Unnamed Site"}),D.jsxs("p",{style:{margin:"0 0 4px 0",fontSize:"14px",color:"#666"},children:["Site ID: ",v.id]}),D.jsxs("p",{style:{margin:"0 0 4px 0",fontSize:"14px",color:"#666"},children:[" ",v.address,", ",v.city,", ",v.state]}),v.latitude&&v.longitude&&D.jsxs("p",{style:{margin:"4px 0 0 0",fontSize:"12px",color:"#999"},children:[v.latitude,", ",v.longitude]})]}),D.jsx("div",{style:{marginLeft:"12px",textAlign:"right"},children:x?D.jsx("span",{style:{color:"#4caf50",fontSize:"24px"},children:""}):D.jsxs("div",{style:{fontSize:"12px",color:"#999"},children:[D.jsxs("div",{children:[" ",g.photoCount||0,"/",g.totalPhotoReqs||0]}),D.jsxs("div",{children:[" ",g.questionnaireComplete?"":""]})]})})]})},v.id)})})]},h)})})]})]}),D.jsx("div",{style:{textAlign:"center",padding:"20px",fontSize:"11px",color:"#888",borderTop:"1px solid #eee",marginTop:"20px"},children:"App Version: v2.5.0-20250108-1630"})]})}function Mu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function ME(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})}var Hm;(function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"})(Hm||(Hm={}));var Vm;(function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"})(Vm||(Vm={}));var Gm;(function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"})(Gm||(Gm={}));var qm;(function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"})(qm||(qm={}));var Km;(function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"})(Km||(Km={}));var Xm;(function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"})(Xm||(Xm={}));var Ym;(function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"})(Ym||(Ym={}));class jE{constructor(){this.authenticated=!0}async initialize(){return Promise.resolve()}async login(){return console.log("Login requested, but using Service Account Proxy."),Promise.resolve({account:{username:"Service Account"}})}logout(){console.log("Logout not applicable for Service Account.")}async getAccessToken(){return null}isAuthenticated(){return!0}async handleRedirectPromise(){return null}}const $E=new jE,Qe={auth:{clientId:"345d9c49-99fe-4910-a1f9-d567ad6016fc",authority:"https://login.microsoftonline.com/736ca106-146c-4c48-bbd0-ccd4fcff89c1",redirectUri:"https://192.168.1.240:3000"},scopes:["Files.ReadWrite.All","Sites.ReadWrite.All","User.Read","Mail.Send"],notifications:{email:"kimby@trid3nt.us",enabled:!0},accessPin:"2025",adminUsers:["kimby@trid3nt.us"],sharepoint:{siteUrl:"https://netorg17734095.sharepoint.com/sites/Trid3ntCOPs",documentLibrary:"Documents",folderPath:"Telamon - Viaero Site Walks",siteDetailsFile:"Telamon Site Details.xlsx",photoRequirementsFile:"Telamon Photo Requirements.xlsx",normalizePhase:e=>{if(e&&e.includes("Telamon Site Walks - "))return e;const t=(e||"").toUpperCase().replace("PHASE","").trim();return t?`Telamon Site Walks - Phase ${t}`:e},getPhotoPath:(e,t)=>`Telamon - Viaero Site Walks/${Qe.sharepoint.normalizePhase(e)}/${t}/PHOTOS`,getQuestionnaireFile:(e,t,r)=>`Telamon - Viaero Site Walks/${Qe.sharepoint.normalizePhase(e)}/${t}/Telamon Site Walk Form ${t} ${r}.xlsx`}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var el={};el.version="0.18.5";var Vr=1200,_i=1252,zE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Cd={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ju=function(e){zE.indexOf(e)!=-1&&(_i=Cd[0]=e)};function WE(){ju(1252)}var ln=function(e){Vr=e,ju(e)};function $u(){ln(1200),WE()}function au(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function HE(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function aw(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var us=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?HE(e.slice(2)):t==254&&r==255?aw(e.slice(2)):t==65279?e.slice(1):e},co=function(t){return String.fromCharCode(t)},nh=function(t){return String.fromCharCode(t)},tt;function VE(e){tt=e,ln=function(t){Vr=t,ju(t)},us=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?tt.utils.decode(1200,au(t.slice(2))):t},co=function(r){return Vr===1200?String.fromCharCode(r):tt.utils.decode(Vr,[r&255,r>>8])[0]},nh=function(r){return tt.utils.decode(_i,[r])[0]},Iw()}var _a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function tl(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,n=e.charCodeAt(c++),s=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=_a.charAt(i)+_a.charAt(s)+_a.charAt(o)+_a.charAt(l);return t}function qr(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=_a.indexOf(e.charAt(c++)),s=_a.indexOf(e.charAt(c++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=_a.indexOf(e.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=_a.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Ke=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),sa=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function La(e){return Ke?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Jm(e){return Ke?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var jr=function(t){return Ke?sa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Tl(e){if(typeof ArrayBuffer>"u")return jr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ha(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function GE(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Ad(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ad(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Qt=Ke?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:sa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function qE(e){for(var t=[],r=0,n=e.length+250,a=La(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=La(65535),n=65530)}return t.push(a.slice(0,r)),Qt(t)}var xr=/\u0000/g,uo=/[\u0001-\u0006]/g;function ws(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Sn(e,t){var r=""+e;return r.length>=t?r:Pt("0",t-r.length)+r}function Fd(e,t){var r=""+e;return r.length>=t?r:Pt(" ",t-r.length)+r}function iu(e,t){var r=""+e;return r.length>=t?r:r+Pt(" ",t-r.length)}function KE(e,t){var r=""+Math.round(e);return r.length>=t?r:Pt("0",t-r.length)+r}function XE(e,t){var r=""+e;return r.length>=t?r:Pt("0",t-r.length)+r}var Qm=Math.pow(2,32);function Mi(e,t){if(e>Qm||e<-Qm)return KE(e,t);var r=Math.round(e);return XE(r,t)}function su(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Zm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],If=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function YE(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Le={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},e1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},JE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ou(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,c=0,u=0,f=Math.floor(a);c<t&&(f=Math.floor(a),o=f*s+i,u=f*c+l,!(a-f<5e-8));)a=1/(a-f),i=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=s)),!r)return[0,n*o,u];var p=Math.floor(n*o/u);return[p,n*o-p*u,u]}function ka(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=nT(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var iw=new Date(1899,11,31,0,0,0),QE=iw.getTime(),ZE=new Date(1900,2,1,0,0,0);function sw(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=ZE&&(r+=24*60*60*1e3),(r-(QE+(e.getTimezoneOffset()-iw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Pd(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function eT(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function tT(e){var t=e<0?12:11,r=Pd(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function rT(e){var t=Pd(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function rl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=tT(e):t===10?r=e.toFixed(10).substr(0,12):r=rT(e),Pd(eT(r.toUpperCase()))}function ki(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):rl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Kr(14,sw(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function nT(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function aT(e,t,r,n){var a="",i=0,s=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return If[r.m-1][1];case 5:return If[r.m-1][0];default:return If[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Zm[r.q][0];default:return Zm[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Sn(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Sn(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Sn(l,c):"";return u}function Sa(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var ow=/%/g;function iT(e,t,r){var n=t.replace(ow,""),a=t.length-n.length;return Qn(e,n,r*Math.pow(10,2*a))+Pt("%",a)}function sT(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Qn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function lw(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+lw(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var cw=/# (\?+)( ?)\/( ?)(\d+)/;function oT(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?Pt(" ",e[1].length+1+e[4].length):Fd(s,e[1].length)+e[2]+"/"+e[3]+Sn(o,e[4].length))}function lT(e,t,r){return r+(t===0?"":""+t)+Pt(" ",e[1].length+2+e[4].length)}var uw=/^#*0*\.([0#]+)/,fw=/\).*[0#]/,hw=/\(###\) ###\\?-####/;function Er(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function t1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function r1(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function cT(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function uT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Zr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(fw)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zr("n",n,r):"("+Zr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return sT(e,t,r);if(t.indexOf("%")!==-1)return iT(e,t,r);if(t.indexOf("E")!==-1)return lw(t,r);if(t.charCodeAt(0)===36)return"$"+Zr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Mi(l,t.length);if(t.match(/^[#?]+$/))return a=Mi(r,0),a==="0"&&(a=""),a.length>t.length?a:Er(t.substr(0,t.length-a.length))+a;if(i=t.match(cw))return oT(i,l,c);if(t.match(/^#+0+$/))return c+Mi(l,t.length-t.indexOf("0"));if(i=t.match(uw))return a=t1(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Er(i[1])).replace(/\.$/,"."+Er(i[1])).replace(/\.(\d*)$/,function(m,d){return"."+d+Pt("0",Er(i[1]).length-d.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+t1(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Sa(Mi(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zr(e,t,-r):Sa(""+(Math.floor(r)+cT(r,i[1].length)))+"."+Sn(r1(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Zr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ws(Zr(e,t.replace(/[\\-]/g,""),r)),s=0,ws(ws(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<a.length?a.charAt(s++):m==="0"?"0":""}));if(t.match(hw))return a=Zr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=ou(l,Math.pow(10,s)-1,!1),a=""+c,u=Qn("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=iu(o[2],s),u.length<i[4].length&&(u=Er(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=ou(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Fd(o[1],s)+i[2]+"/"+i[3]+iu(o[2],s):Pt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Mi(r,0),t.length<=a.length?a:Er(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,p=t.length-a.length-f;return Er(t.substr(0,f)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=r1(r,i[1].length),r<0?"-"+Zr(e,t,-r):Sa(uT(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Sn(0,3-m.length):"")+m})+"."+Sn(s,i[1].length);switch(t){case"###,##0.00":return Zr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Sa(Mi(l,0));return h!=="0"?c+h:"";case"###,###.00":return Zr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Zr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function fT(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Qn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function hT(e,t,r){var n=t.replace(ow,""),a=t.length-n.length;return Qn(e,n,r*Math.pow(10,2*a))+Pt("%",a)}function dw(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+dw(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function On(e,t,r){if(e.charCodeAt(0)===40&&!t.match(fw)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?On("n",n,r):"("+On("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return fT(e,t,r);if(t.indexOf("%")!==-1)return hT(e,t,r);if(t.indexOf("E")!==-1)return dw(t,r);if(t.charCodeAt(0)===36)return"$"+On(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Sn(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Er(t.substr(0,t.length-a.length))+a;if(i=t.match(cw))return lT(i,l,c);if(t.match(/^#+0+$/))return c+Sn(l,t.length-t.indexOf("0"));if(i=t.match(uw))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Er(i[1])).replace(/\.$/,"."+Er(i[1])),a=a.replace(/\.(\d*)$/,function(m,d){return"."+d+Pt("0",Er(i[1]).length-d.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Sa(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+On(e,t,-r):Sa(""+r)+"."+Pt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return On(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ws(On(e,t.replace(/[\\-]/g,""),r)),s=0,ws(ws(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<a.length?a.charAt(s++):m==="0"?"0":""}));if(t.match(hw))return a=On(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=ou(l,Math.pow(10,s)-1,!1),a=""+c,u=Qn("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=iu(o[2],s),u.length<i[4].length&&(u=Er(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=ou(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Fd(o[1],s)+i[2]+"/"+i[3]+iu(o[2],s):Pt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Er(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,p=t.length-a.length-f;return Er(t.substr(0,f)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+On(e,t,-r):Sa(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Sn(0,3-m.length):"")+m})+"."+Sn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Sa(""+l);return h!=="0"?c+h:"";default:if(t.match(/\.[0#?]*$/))return On(e,t.slice(0,t.lastIndexOf(".")),r)+Er(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Qn(e,t,r){return(r|0)===r?On(e,t,r):Zr(e,t,r)}function dT(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var pw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pi(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":su(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(pw))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function pT(e,t,r,n){for(var a=[],i="",s=0,o="",l="t",c,u,f,p="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!su(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(f=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++s;break;case"\\":var h=e.charAt(++s),m=h==="("||h===")"?h:"t";a[a.length]={t:m,v:h},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(c==null&&(c=ka(t,r,e.charAt(s+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ka(t,r),c==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),a[a.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var d={t:o,v:o};if(c==null&&(c=ka(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(d.v=c.H>=12?"P":"A"),d.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(d.v=c.H>=12?"PM":"AM"),d.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="/"?(c!=null&&(d.v=c.H>=12?"":""),d.t="T",s+=5,p="h"):(d.t="t",++s),c==null&&d.t==="T")return"";a[a.length]=d,l=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(pw)){if(c==null&&(c=ka(t,r),c==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pi(e)||(a[a.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var v=0,g=0,x;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=p,l="h",v<1&&(v=1);break;case"s":(x=a[s].v.match(/\.0+$/))&&(g=Math.max(g,x[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[s].v.match(/[Hh]/)&&(v=1),v<2&&a[s].v.match(/[Mm]/)&&(v=2),v<3&&a[s].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",_;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=aT(a[s].t.charCodeAt(0),a[s].v,c,g),a[s].t="t";break;case"n":case"?":for(_=s+1;a[_]!=null&&((o=a[_].t)==="?"||o==="D"||(o===" "||o==="t")&&a[_+1]!=null&&(a[_+1].t==="?"||a[_+1].t==="t"&&a[_+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[_].v==="/"||a[_].v===" "&&a[_+1]!=null&&a[_+1].t=="?"));)a[s].v+=a[_].v,a[_]={v:"",t:";"},++_;w+=a[s].v,s=_-1;break;case"G":a[s].t="t",a[s].v=ki(t,r);break}var S="",E,k;if(w.length>0){w.charCodeAt(0)==40?(E=t<0&&w.charCodeAt(0)===45?-t:t,k=Qn("n",w,E)):(E=t<0&&n>1?-t:t,k=Qn("n",w,E),E<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),_=k.length-1;var R=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){R=s;break}var C=a.length;if(R===a.length&&k.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(_>=a[s].v.length-1?(_-=a[s].v.length,a[s].v=k.substr(_+1,a[s].v.length)):_<0?a[s].v="":(a[s].v=k.substr(0,_+1),_=-1),a[s].t="t",C=s);_>=0&&C<a.length&&(a[C].v=k.substr(0,_+1)+a[C].v)}else if(R!==a.length&&k.indexOf("E")===-1){for(_=k.indexOf(".")-1,s=R;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(u=a[s].v.indexOf(".")>-1&&s===R?a[s].v.indexOf(".")-1:a[s].v.length-1,S=a[s].v.substr(u+1);u>=0;--u)_>=0&&(a[s].v.charAt(u)==="0"||a[s].v.charAt(u)==="#")&&(S=k.charAt(_--)+S);a[s].v=S,a[s].t="t",C=s}for(_>=0&&C<a.length&&(a[C].v=k.substr(0,_+1)+a[C].v),_=k.indexOf(".")+1,s=R;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==R)){for(u=a[s].v.indexOf(".")>-1&&s===R?a[s].v.indexOf(".")+1:0,S=a[s].v.substr(0,u);u<a[s].v.length;++u)_<k.length&&(S+=k.charAt(_++));a[s].v=S,a[s].t="t",C=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(E=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Qn(a[s].t,a[s].v,E),a[s].t="t");var N="";for(s=0;s!==a.length;++s)a[s]!=null&&(N+=a[s].v);return N}var n1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function a1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function mT(e,t){var r=dT(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(n1),o=r[1].match(n1);return a1(t,s)?[n,r[0]]:a1(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function Kr(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Le)[e],n==null&&(n=r.table&&r.table[e1[e]]||Le[e1[e]]),n==null&&(n=JE[e]||"General");break}if(su(n,0))return ki(t,r);t instanceof Date&&(t=sw(t,r.date1904));var a=mT(n,t);if(su(a[1]))return ki(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return pT(a[1],t,r,a[0])}function Mn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Le[r]==null){t<0&&(t=r);continue}if(Le[r]==e){t=r;break}}t<0&&(t=391)}return Le[t]=e,t}function bl(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Mn(e[t],t)}function $s(){Le=YE()}var mw={format:Kr,load:Mn,_table:Le,load_table:bl,parse_date_code:ka,is_date:Pi,get_table:function(){return mw._table=Le}},gT={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},gw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function vT(e){var t=typeof e=="number"?Le[e]:e;return t=t.replace(gw,"(\\d+)"),new RegExp("^"+t+"$")}function xT(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(gw)||[]).forEach(function(f,p){var h=parseInt(r[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":s=h;break;case"s":l=h;break;case"m":s>=0?o=h:a=h;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&i==-1?u:c+"T"+u}var wT=function(){var e={};e.version="1.2.0";function t(){for(var k=0,R=new Array(256),C=0;C!=256;++C)k=C,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,R[C]=k;return typeof Int32Array<"u"?new Int32Array(R):R}var r=t();function n(k){var R=0,C=0,N=0,X=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)X[N]=k[N];for(N=0;N!=256;++N)for(C=k[N],R=256+N;R<4096;R+=256)C=X[R]=C>>>8^k[C&255];var A=[];for(N=1;N!=16;++N)A[N-1]=typeof Int32Array<"u"?X.subarray(N*256,N*256+256):X.slice(N*256,N*256+256);return A}var a=n(r),i=a[0],s=a[1],o=a[2],l=a[3],c=a[4],u=a[5],f=a[6],p=a[7],h=a[8],m=a[9],d=a[10],v=a[11],g=a[12],x=a[13],w=a[14];function _(k,R){for(var C=R^-1,N=0,X=k.length;N<X;)C=C>>>8^r[(C^k.charCodeAt(N++))&255];return~C}function S(k,R){for(var C=R^-1,N=k.length-15,X=0;X<N;)C=w[k[X++]^C&255]^x[k[X++]^C>>8&255]^g[k[X++]^C>>16&255]^v[k[X++]^C>>>24]^d[k[X++]]^m[k[X++]]^h[k[X++]]^p[k[X++]]^f[k[X++]]^u[k[X++]]^c[k[X++]]^l[k[X++]]^o[k[X++]]^s[k[X++]]^i[k[X++]]^r[k[X++]];for(N+=15;X<N;)C=C>>>8^r[(C^k[X++])&255];return~C}function E(k,R){for(var C=R^-1,N=0,X=k.length,A=0,V=0;N<X;)A=k.charCodeAt(N++),A<128?C=C>>>8^r[(C^A)&255]:A<2048?(C=C>>>8^r[(C^(192|A>>6&31))&255],C=C>>>8^r[(C^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,V=k.charCodeAt(N++)&1023,C=C>>>8^r[(C^(240|A>>8&7))&255],C=C>>>8^r[(C^(128|A>>2&63))&255],C=C>>>8^r[(C^(128|V>>6&15|(A&3)<<4))&255],C=C>>>8^r[(C^(128|V&63))&255]):(C=C>>>8^r[(C^(224|A>>12&15))&255],C=C>>>8^r[(C^(128|A>>6&63))&255],C=C>>>8^r[(C^(128|A&63))&255]);return~C}return e.table=r,e.bstr=_,e.buf=S,e.str=E,e}(),De=function(){var t={};t.version="1.2.1";function r(F,z){for(var L=F.split("/"),M=z.split("/"),W=0,G=0,se=Math.min(L.length,M.length);W<se;++W){if(G=L[W].length-M[W].length)return G;if(L[W]!=M[W])return L[W]<M[W]?-1:1}return L.length-M.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var z=F.lastIndexOf("/");return z===-1?F:F.slice(0,z+1)}function a(F){if(F.charAt(F.length-1)=="/")return a(F.slice(0,-1));var z=F.lastIndexOf("/");return z===-1?F:F.slice(z+1)}function i(F,z){typeof z=="string"&&(z=new Date(z));var L=z.getHours();L=L<<6|z.getMinutes(),L=L<<5|z.getSeconds()>>>1,F.write_shift(2,L);var M=z.getFullYear()-1980;M=M<<4|z.getMonth()+1,M=M<<5|z.getDate(),F.write_shift(2,M)}function s(F){var z=F.read_shift(2)&65535,L=F.read_shift(2)&65535,M=new Date,W=L&31;L>>>=5;var G=L&15;L>>>=4,M.setMilliseconds(0),M.setFullYear(L+1980),M.setMonth(G-1),M.setDate(W);var se=z&31;z>>>=5;var ge=z&63;return z>>>=6,M.setHours(z),M.setMinutes(ge),M.setSeconds(se<<1),M}function o(F){ir(F,0);for(var z={},L=0;F.l<=F.length-4;){var M=F.read_shift(2),W=F.read_shift(2),G=F.l+W,se={};switch(M){case 21589:L=F.read_shift(1),L&1&&(se.mtime=F.read_shift(4)),W>5&&(L&2&&(se.atime=F.read_shift(4)),L&4&&(se.ctime=F.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}F.l=G,z[M]=se}return z}var l;function c(){return l||(l={})}function u(F,z){if(F[0]==80&&F[1]==75)return Ul(F,z);if((F[0]|32)==109&&(F[1]|32)==105)return $_(F,z);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var L=3,M=512,W=0,G=0,se=0,ge=0,re=0,le=[],ce=F.slice(0,512);ir(ce,0);var Se=f(ce);switch(L=Se[0],L){case 3:M=512;break;case 4:M=4096;break;case 0:if(Se[1]==0)return Ul(F,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}M!==512&&(ce=F.slice(0,M),ir(ce,28));var Fe=F.slice(0,M);p(ce,L);var Oe=ce.read_shift(4,"i");if(L===3&&Oe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Oe);ce.l+=4,se=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),ge=ce.read_shift(4,"i"),W=ce.read_shift(4,"i"),re=ce.read_shift(4,"i"),G=ce.read_shift(4,"i");for(var Te=-1,Pe=0;Pe<109&&(Te=ce.read_shift(4,"i"),!(Te<0));++Pe)le[Pe]=Te;var He=h(F,M);v(re,G,He,M,le);var kt=x(He,se,le,M);kt[se].name="!Directory",W>0&&ge!==V&&(kt[ge].name="!MiniFAT"),kt[le[0]].name="!FAT",kt.fat_addrs=le,kt.ssz=M;var St={},cr=[],Gs=[],qs=[];w(se,kt,He,cr,W,St,Gs,ge),m(Gs,qs,cr),cr.shift();var Ks={FileIndex:Gs,FullPaths:qs};return z&&z.raw&&(Ks.raw={header:Fe,sectors:He}),Ks}function f(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(T,"Header Signature: "),F.l+=16;var z=F.read_shift(2,"u");return[F.read_shift(2,"u"),z]}function p(F,z){var L=9;switch(F.l+=2,L=F.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function h(F,z){for(var L=Math.ceil(F.length/z)-1,M=[],W=1;W<L;++W)M[W-1]=F.slice(W*z,(W+1)*z);return M[L-1]=F.slice(L*z),M}function m(F,z,L){for(var M=0,W=0,G=0,se=0,ge=0,re=L.length,le=[],ce=[];M<re;++M)le[M]=ce[M]=M,z[M]=L[M];for(;ge<ce.length;++ge)M=ce[ge],W=F[M].L,G=F[M].R,se=F[M].C,le[M]===M&&(W!==-1&&le[W]!==W&&(le[M]=le[W]),G!==-1&&le[G]!==G&&(le[M]=le[G])),se!==-1&&(le[se]=M),W!==-1&&M!=le[M]&&(le[W]=le[M],ce.lastIndexOf(W)<ge&&ce.push(W)),G!==-1&&M!=le[M]&&(le[G]=le[M],ce.lastIndexOf(G)<ge&&ce.push(G));for(M=1;M<re;++M)le[M]===M&&(G!==-1&&le[G]!==G?le[M]=le[G]:W!==-1&&le[W]!==W&&(le[M]=le[W]));for(M=1;M<re;++M)if(F[M].type!==0){if(ge=M,ge!=le[ge])do ge=le[ge],z[M]=z[ge]+"/"+z[M];while(ge!==0&&le[ge]!==-1&&ge!=le[ge]);le[M]=-1}for(z[0]+="/",M=1;M<re;++M)F[M].type!==2&&(z[M]+="/")}function d(F,z,L){for(var M=F.start,W=F.size,G=[],se=M;L&&W>0&&se>=0;)G.push(z.slice(se*A,se*A+A)),W-=A,se=ti(L,se*4);return G.length===0?me(0):Qt(G).slice(0,F.size)}function v(F,z,L,M,W){var G=V;if(F===V){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var se=L[F],ge=(M>>>2)-1;if(!se)return;for(var re=0;re<ge&&(G=ti(se,re*4))!==V;++re)W.push(G);v(ti(se,M-4),z-1,L,M,W)}}function g(F,z,L,M,W){var G=[],se=[];W||(W=[]);var ge=M-1,re=0,le=0;for(re=z;re>=0;){W[re]=!0,G[G.length]=re,se.push(F[re]);var ce=L[Math.floor(re*4/M)];if(le=re*4&ge,M<4+le)throw new Error("FAT boundary crossed: "+re+" 4 "+M);if(!F[ce])break;re=ti(F[ce],le)}return{nodes:G,data:g1([se])}}function x(F,z,L,M){var W=F.length,G=[],se=[],ge=[],re=[],le=M-1,ce=0,Se=0,Fe=0,Oe=0;for(ce=0;ce<W;++ce)if(ge=[],Fe=ce+z,Fe>=W&&(Fe-=W),!se[Fe]){re=[];var Te=[];for(Se=Fe;Se>=0;){Te[Se]=!0,se[Se]=!0,ge[ge.length]=Se,re.push(F[Se]);var Pe=L[Math.floor(Se*4/M)];if(Oe=Se*4&le,M<4+Oe)throw new Error("FAT boundary crossed: "+Se+" 4 "+M);if(!F[Pe]||(Se=ti(F[Pe],Oe),Te[Se]))break}G[Fe]={nodes:ge,data:g1([re])}}return G}function w(F,z,L,M,W,G,se,ge){for(var re=0,le=M.length?2:0,ce=z[F].data,Se=0,Fe=0,Oe;Se<ce.length;Se+=128){var Te=ce.slice(Se,Se+128);ir(Te,64),Fe=Te.read_shift(2),Oe=Vu(Te,0,Fe-le),M.push(Oe);var Pe={name:Oe,type:Te.read_shift(1),color:Te.read_shift(1),L:Te.read_shift(4,"i"),R:Te.read_shift(4,"i"),C:Te.read_shift(4,"i"),clsid:Te.read_shift(16),state:Te.read_shift(4,"i"),start:0,size:0},He=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);He!==0&&(Pe.ct=_(Te,Te.l-8));var kt=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);kt!==0&&(Pe.mt=_(Te,Te.l-8)),Pe.start=Te.read_shift(4,"i"),Pe.size=Te.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=V,Pe.name=""),Pe.type===5?(re=Pe.start,W>0&&re!==V&&(z[re].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",z[Pe.start]===void 0&&(z[Pe.start]=g(L,Pe.start,z.fat_addrs,z.ssz)),z[Pe.start].name=Pe.name,Pe.content=z[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:re!==V&&Pe.start!==V&&z[re]&&(Pe.content=d(Pe,z[re].data,(z[ge]||{}).data))),Pe.content&&ir(Pe.content,0),G[Oe]=Pe,se.push(Pe)}}function _(F,z){return new Date((Jt(F,z+4)/1e7*Math.pow(2,32)+Jt(F,z)/1e7-11644473600)*1e3)}function S(F,z){return c(),u(l.readFileSync(F),z)}function E(F,z){var L=z&&z.type;switch(L||Ke&&Buffer.isBuffer(F)&&(L="buffer"),L||"base64"){case"file":return S(F,z);case"base64":return u(jr(qr(F)),z);case"binary":return u(jr(F),z)}return u(F,z)}function k(F,z){var L=z||{},M=L.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=M+"/",F.FileIndex[0]={name:M,type:5}),L.CLSID&&(F.FileIndex[0].clsid=L.CLSID),R(F)}function R(F){var z="Sh33tJ5";if(!De.find(F,"/"+z)){var L=me(4);L[0]=55,L[1]=L[3]=50,L[2]=54,F.FileIndex.push({name:z,type:2,content:L,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+z),C(F)}}function C(F,z){k(F);for(var L=!1,M=!1,W=F.FullPaths.length-1;W>=0;--W){var G=F.FileIndex[W];switch(G.type){case 0:M?L=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(G.R*G.L*G.C)&&(L=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!z)){var se=new Date(1987,1,19),ge=0,re=Object.create?Object.create(null):{},le=[];for(W=0;W<F.FullPaths.length;++W)re[F.FullPaths[W]]=!0,F.FileIndex[W].type!==0&&le.push([F.FullPaths[W],F.FileIndex[W]]);for(W=0;W<le.length;++W){var ce=n(le[W][0]);M=re[ce],M||(le.push([ce,{name:a(ce).replace("/",""),type:1,clsid:ne,ct:se,mt:se,content:null}]),re[ce]=!0)}for(le.sort(function(Oe,Te){return r(Oe[0],Te[0])}),F.FullPaths=[],F.FileIndex=[],W=0;W<le.length;++W)F.FullPaths[W]=le[W][0],F.FileIndex[W]=le[W][1];for(W=0;W<le.length;++W){var Se=F.FileIndex[W],Fe=F.FullPaths[W];if(Se.name=a(Fe).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||ne,W===0)Se.C=le.length>1?1:-1,Se.size=0,Se.type=5;else if(Fe.slice(-1)=="/"){for(ge=W+1;ge<le.length&&n(F.FullPaths[ge])!=Fe;++ge);for(Se.C=ge>=le.length?-1:ge,ge=W+1;ge<le.length&&n(F.FullPaths[ge])!=n(Fe);++ge);Se.R=ge>=le.length?-1:ge,Se.type=1}else n(F.FullPaths[W+1]||"")==n(Fe)&&(Se.R=W+1),Se.type=2}}}function N(F,z){var L=z||{};if(L.fileType=="mad")return z_(F,L);switch(C(F),L.fileType){case"zip":return qa(F,L)}var M=function(Oe){for(var Te=0,Pe=0,He=0;He<Oe.FileIndex.length;++He){var kt=Oe.FileIndex[He];if(kt.content){var St=kt.content.length;St>0&&(St<4096?Te+=St+63>>6:Pe+=St+511>>9)}}for(var cr=Oe.FullPaths.length+3>>2,Gs=Te+7>>3,qs=Te+127>>7,Ks=Gs+Pe+cr+qs,Ka=Ks+127>>7,rf=Ka<=109?0:Math.ceil((Ka-109)/127);Ks+Ka+rf+127>>7>Ka;)rf=++Ka<=109?0:Math.ceil((Ka-109)/127);var Hn=[1,rf,Ka,qs,cr,Pe,Te,0];return Oe.FileIndex[0].size=Te<<6,Hn[7]=(Oe.FileIndex[0].start=Hn[0]+Hn[1]+Hn[2]+Hn[3]+Hn[4]+Hn[5])+(Hn[6]+7>>3),Hn}(F),W=me(M[7]<<9),G=0,se=0;{for(G=0;G<8;++G)W.write_shift(1,K[G]);for(G=0;G<8;++G)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),G=0;G<3;++G)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,M[2]),W.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:V),W.write_shift(4,M[3]),W.write_shift(-4,M[1]?M[0]-1:V),W.write_shift(4,M[1]),G=0;G<109;++G)W.write_shift(-4,G<M[2]?M[1]+G:-1)}if(M[1])for(se=0;se<M[1];++se){for(;G<236+se*127;++G)W.write_shift(-4,G<M[2]?M[1]+G:-1);W.write_shift(-4,se===M[1]-1?V:se+1)}var ge=function(Oe){for(se+=Oe;G<se-1;++G)W.write_shift(-4,G+1);Oe&&(++G,W.write_shift(-4,V))};for(se=G=0,se+=M[1];G<se;++G)W.write_shift(-4,Q.DIFSECT);for(se+=M[2];G<se;++G)W.write_shift(-4,Q.FATSECT);ge(M[3]),ge(M[4]);for(var re=0,le=0,ce=F.FileIndex[0];re<F.FileIndex.length;++re)ce=F.FileIndex[re],ce.content&&(le=ce.content.length,!(le<4096)&&(ce.start=se,ge(le+511>>9)));for(ge(M[6]+7>>3);W.l&511;)W.write_shift(-4,Q.ENDOFCHAIN);for(se=G=0,re=0;re<F.FileIndex.length;++re)ce=F.FileIndex[re],ce.content&&(le=ce.content.length,!(!le||le>=4096)&&(ce.start=se,ge(le+63>>6)));for(;W.l&511;)W.write_shift(-4,Q.ENDOFCHAIN);for(G=0;G<M[4]<<2;++G){var Se=F.FullPaths[G];if(!Se||Se.length===0){for(re=0;re<17;++re)W.write_shift(4,0);for(re=0;re<3;++re)W.write_shift(4,-1);for(re=0;re<12;++re)W.write_shift(4,0);continue}ce=F.FileIndex[G],G===0&&(ce.start=ce.size?ce.start-1:V);var Fe=G===0&&L.root||ce.name;if(le=2*(Fe.length+1),W.write_shift(64,Fe,"utf16le"),W.write_shift(2,le),W.write_shift(1,ce.type),W.write_shift(1,ce.color),W.write_shift(-4,ce.L),W.write_shift(-4,ce.R),W.write_shift(-4,ce.C),ce.clsid)W.write_shift(16,ce.clsid,"hex");else for(re=0;re<4;++re)W.write_shift(4,0);W.write_shift(4,ce.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,ce.start),W.write_shift(4,ce.size),W.write_shift(4,0)}for(G=1;G<F.FileIndex.length;++G)if(ce=F.FileIndex[G],ce.size>=4096)if(W.l=ce.start+1<<9,Ke&&Buffer.isBuffer(ce.content))ce.content.copy(W,W.l,0,ce.size),W.l+=ce.size+511&-512;else{for(re=0;re<ce.size;++re)W.write_shift(1,ce.content[re]);for(;re&511;++re)W.write_shift(1,0)}for(G=1;G<F.FileIndex.length;++G)if(ce=F.FileIndex[G],ce.size>0&&ce.size<4096)if(Ke&&Buffer.isBuffer(ce.content))ce.content.copy(W,W.l,0,ce.size),W.l+=ce.size+63&-64;else{for(re=0;re<ce.size;++re)W.write_shift(1,ce.content[re]);for(;re&63;++re)W.write_shift(1,0)}if(Ke)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function X(F,z){var L=F.FullPaths.map(function(re){return re.toUpperCase()}),M=L.map(function(re){var le=re.split("/");return le[le.length-(re.slice(-1)=="/"?2:1)]}),W=!1;z.charCodeAt(0)===47?(W=!0,z=L[0].slice(0,-1)+z):W=z.indexOf("/")!==-1;var G=z.toUpperCase(),se=W===!0?L.indexOf(G):M.indexOf(G);if(se!==-1)return F.FileIndex[se];var ge=!G.match(uo);for(G=G.replace(xr,""),ge&&(G=G.replace(uo,"!")),se=0;se<L.length;++se)if((ge?L[se].replace(uo,"!"):L[se]).replace(xr,"")==G||(ge?M[se].replace(uo,"!"):M[se]).replace(xr,"")==G)return F.FileIndex[se];return null}var A=64,V=-2,T="d0cf11e0a1b11ae1",K=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:T,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(F,z,L){c();var M=N(F,L);l.writeFileSync(z,M)}function j(F){for(var z=new Array(F.length),L=0;L<F.length;++L)z[L]=String.fromCharCode(F[L]);return z.join("")}function ae(F,z){var L=N(F,z);switch(z&&z.type||"buffer"){case"file":return c(),l.writeFileSync(z.filename,L),L;case"binary":return typeof L=="string"?L:j(L);case"base64":return tl(typeof L=="string"?L:j(L));case"buffer":if(Ke)return Buffer.isBuffer(L)?L:sa(L);case"array":return typeof L=="string"?jr(L):L}return L}var q;function b(F){try{var z=F.InflateRaw,L=new z;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)q=F;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function H(F,z){if(!q)return Ll(F,z);var L=q.InflateRaw,M=new L,W=M._processChunk(F.slice(F.l),M._finishFlushFlag);return F.l+=M.bytesRead,W}function U(F){return q?q.deflateRawSync(F):We(F)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(F){var z=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(z>>16|z>>8|z)&255}for(var he=typeof Uint8Array<"u",ve=he?new Uint8Array(256):[],ie=0;ie<256;++ie)ve[ie]=de(ie);function O(F,z){var L=ve[F&255];return z<=8?L>>>8-z:(L=L<<8|ve[F>>8&255],z<=16?L>>>16-z:(L=L<<8|ve[F>>16&255],L>>>24-z))}function we(F,z){var L=z&7,M=z>>>3;return(F[M]|(L<=6?0:F[M+1]<<8))>>>L&3}function y(F,z){var L=z&7,M=z>>>3;return(F[M]|(L<=5?0:F[M+1]<<8))>>>L&7}function Z(F,z){var L=z&7,M=z>>>3;return(F[M]|(L<=4?0:F[M+1]<<8))>>>L&15}function J(F,z){var L=z&7,M=z>>>3;return(F[M]|(L<=3?0:F[M+1]<<8))>>>L&31}function P(F,z){var L=z&7,M=z>>>3;return(F[M]|(L<=1?0:F[M+1]<<8))>>>L&127}function I(F,z,L){var M=z&7,W=z>>>3,G=(1<<L)-1,se=F[W]>>>M;return L<8-M||(se|=F[W+1]<<8-M,L<16-M)||(se|=F[W+2]<<16-M,L<24-M)||(se|=F[W+3]<<24-M),se&G}function Y(F,z,L){var M=z&7,W=z>>>3;return M<=5?F[W]|=(L&7)<<M:(F[W]|=L<<M&255,F[W+1]=(L&7)>>8-M),z+3}function ue(F,z,L){var M=z&7,W=z>>>3;return L=(L&1)<<M,F[W]|=L,z+1}function pe(F,z,L){var M=z&7,W=z>>>3;return L<<=M,F[W]|=L&255,L>>>=8,F[W+1]=L,z+8}function te(F,z,L){var M=z&7,W=z>>>3;return L<<=M,F[W]|=L&255,L>>>=8,F[W+1]=L&255,F[W+2]=L>>>8,z+16}function _e(F,z){var L=F.length,M=2*L>z?2*L:z+5,W=0;if(L>=z)return F;if(Ke){var G=Jm(M);if(F.copy)F.copy(G);else for(;W<F.length;++W)G[W]=F[W];return G}else if(he){var se=new Uint8Array(M);if(se.set)se.set(F);else for(;W<L;++W)se[W]=F[W];return se}return F.length=M,F}function Ae(F){for(var z=new Array(F),L=0;L<F;++L)z[L]=0;return z}function ke(F,z,L){var M=1,W=0,G=0,se=0,ge=0,re=F.length,le=he?new Uint16Array(32):Ae(32);for(G=0;G<32;++G)le[G]=0;for(G=re;G<L;++G)F[G]=0;re=F.length;var ce=he?new Uint16Array(re):Ae(re);for(G=0;G<re;++G)le[W=F[G]]++,M<W&&(M=W),ce[G]=0;for(le[0]=0,G=1;G<=M;++G)le[G+16]=ge=ge+le[G-1]<<1;for(G=0;G<re;++G)ge=F[G],ge!=0&&(ce[G]=le[ge+16]++);var Se=0;for(G=0;G<re;++G)if(Se=F[G],Se!=0)for(ge=O(ce[G],M)>>M-Se,se=(1<<M+4-Se)-1;se>=0;--se)z[ge|se<<Se]=Se&15|G<<4;return M}var Re=he?new Uint16Array(512):Ae(512),et=he?new Uint16Array(32):Ae(32);if(!he){for(var Be=0;Be<512;++Be)Re[Be]=0;for(Be=0;Be<32;++Be)et[Be]=0}(function(){for(var F=[],z=0;z<32;z++)F.push(5);ke(F,et,32);var L=[];for(z=0;z<=143;z++)L.push(8);for(;z<=255;z++)L.push(9);for(;z<=279;z++)L.push(7);for(;z<=287;z++)L.push(8);ke(L,Re,288)})();var _t=function(){for(var z=he?new Uint8Array(32768):[],L=0,M=0;L<xe.length-1;++L)for(;M<xe[L+1];++M)z[M]=L;for(;M<32768;++M)z[M]=29;var W=he?new Uint8Array(259):[];for(L=0,M=0;L<ee.length-1;++L)for(;M<ee[L+1];++M)W[M]=L;function G(ge,re){for(var le=0;le<ge.length;){var ce=Math.min(65535,ge.length-le),Se=le+ce==ge.length;for(re.write_shift(1,+Se),re.write_shift(2,ce),re.write_shift(2,~ce&65535);ce-- >0;)re[re.l++]=ge[le++]}return re.l}function se(ge,re){for(var le=0,ce=0,Se=he?new Uint16Array(32768):[];ce<ge.length;){var Fe=Math.min(65535,ge.length-ce);if(Fe<10){for(le=Y(re,le,+(ce+Fe==ge.length)),le&7&&(le+=8-(le&7)),re.l=le/8|0,re.write_shift(2,Fe),re.write_shift(2,~Fe&65535);Fe-- >0;)re[re.l++]=ge[ce++];le=re.l*8;continue}le=Y(re,le,+(ce+Fe==ge.length)+2);for(var Oe=0;Fe-- >0;){var Te=ge[ce];Oe=(Oe<<5^Te)&32767;var Pe=-1,He=0;if((Pe=Se[Oe])&&(Pe|=ce&-32768,Pe>ce&&(Pe-=32768),Pe<ce))for(;ge[Pe+He]==ge[ce+He]&&He<250;)++He;if(He>2){Te=W[He],Te<=22?le=pe(re,le,ve[Te+1]>>1)-1:(pe(re,le,3),le+=5,pe(re,le,ve[Te-23]>>5),le+=3);var kt=Te<8?0:Te-4>>2;kt>0&&(te(re,le,He-ee[Te]),le+=kt),Te=z[ce-Pe],le=pe(re,le,ve[Te]>>3),le-=3;var St=Te<4?0:Te-2>>1;St>0&&(te(re,le,ce-Pe-xe[Te]),le+=St);for(var cr=0;cr<He;++cr)Se[Oe]=ce&32767,Oe=(Oe<<5^ge[ce])&32767,++ce;Fe-=He-1}else Te<=143?Te=Te+48:le=ue(re,le,1),le=pe(re,le,ve[Te]),Se[Oe]=ce&32767,++ce}le=pe(re,le,0)-1}return re.l=(le+7)/8|0,re.l}return function(re,le){return re.length<8?G(re,le):se(re,le)}}();function We(F){var z=me(50+Math.floor(F.length*1.1)),L=_t(F,z);return z.slice(0,L)}var at=he?new Uint16Array(32768):Ae(32768),Kt=he?new Uint16Array(32768):Ae(32768),Ge=he?new Uint16Array(128):Ae(128),Jr=1,Bi=1;function pn(F,z){var L=J(F,z)+257;z+=5;var M=J(F,z)+1;z+=5;var W=Z(F,z)+4;z+=4;for(var G=0,se=he?new Uint8Array(19):Ae(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,le=he?new Uint8Array(8):Ae(8),ce=he?new Uint8Array(8):Ae(8),Se=se.length,Fe=0;Fe<W;++Fe)se[B[Fe]]=G=y(F,z),re<G&&(re=G),le[G]++,z+=3;var Oe=0;for(le[0]=0,Fe=1;Fe<=re;++Fe)ce[Fe]=Oe=Oe+le[Fe-1]<<1;for(Fe=0;Fe<Se;++Fe)(Oe=se[Fe])!=0&&(ge[Fe]=ce[Oe]++);var Te=0;for(Fe=0;Fe<Se;++Fe)if(Te=se[Fe],Te!=0){Oe=ve[ge[Fe]]>>8-Te;for(var Pe=(1<<7-Te)-1;Pe>=0;--Pe)Ge[Oe|Pe<<Te]=Te&7|Fe<<3}var He=[];for(re=1;He.length<L+M;)switch(Oe=Ge[P(F,z)],z+=Oe&7,Oe>>>=3){case 16:for(G=3+we(F,z),z+=2,Oe=He[He.length-1];G-- >0;)He.push(Oe);break;case 17:for(G=3+y(F,z),z+=3;G-- >0;)He.push(0);break;case 18:for(G=11+P(F,z),z+=7;G-- >0;)He.push(0);break;default:He.push(Oe),re<Oe&&(re=Oe);break}var kt=He.slice(0,L),St=He.slice(L);for(Fe=L;Fe<286;++Fe)kt[Fe]=0;for(Fe=M;Fe<30;++Fe)St[Fe]=0;return Jr=ke(kt,at,286),Bi=ke(St,Kt,30),z}function Dl(F,z){if(F[0]==3&&!(F[1]&3))return[La(z),2];for(var L=0,M=0,W=Jm(z||1<<18),G=0,se=W.length>>>0,ge=0,re=0;!(M&1);){if(M=y(F,L),L+=3,M>>>1)M>>1==1?(ge=9,re=5):(L=pn(F,L),ge=Jr,re=Bi);else{L&7&&(L+=8-(L&7));var le=F[L>>>3]|F[(L>>>3)+1]<<8;if(L+=32,le>0)for(!z&&se<G+le&&(W=_e(W,G+le),se=W.length);le-- >0;)W[G++]=F[L>>>3],L+=8;continue}for(;;){!z&&se<G+32767&&(W=_e(W,G+32767),se=W.length);var ce=I(F,L,ge),Se=M>>>1==1?Re[ce]:at[ce];if(L+=Se&15,Se>>>=4,!(Se>>>8&255))W[G++]=Se;else{if(Se==256)break;Se-=257;var Fe=Se<8?0:Se-4>>2;Fe>5&&(Fe=0);var Oe=G+ee[Se];Fe>0&&(Oe+=I(F,L,Fe),L+=Fe),ce=I(F,L,re),Se=M>>>1==1?et[ce]:Kt[ce],L+=Se&15,Se>>>=4;var Te=Se<4?0:Se-2>>1,Pe=xe[Se];for(Te>0&&(Pe+=I(F,L,Te),L+=Te),!z&&se<Oe&&(W=_e(W,Oe+100),se=W.length);G<Oe;)W[G]=W[G-Pe],++G}}}return z?[W,L+7>>>3]:[W.slice(0,G),L+7>>>3]}function Ll(F,z){var L=F.slice(F.l||0),M=Dl(L,z);return F.l+=M[1],M[0]}function Bl(F,z){if(F)typeof console<"u"&&console.error(z);else throw new Error(z)}function Ul(F,z){var L=F;ir(L,0);var M=[],W=[],G={FileIndex:M,FullPaths:W};k(G,{root:z.root});for(var se=L.length-4;(L[se]!=80||L[se+1]!=75||L[se+2]!=5||L[se+3]!=6)&&se>=0;)--se;L.l=se+4,L.l+=4;var ge=L.read_shift(2);L.l+=6;var re=L.read_shift(4);for(L.l=re,se=0;se<ge;++se){L.l+=20;var le=L.read_shift(4),ce=L.read_shift(4),Se=L.read_shift(2),Fe=L.read_shift(2),Oe=L.read_shift(2);L.l+=8;var Te=L.read_shift(4),Pe=o(L.slice(L.l+Se,L.l+Se+Fe));L.l+=Se+Fe+Oe;var He=L.l;L.l=Te+4,Ml(L,le,ce,G,Pe),L.l=He}return G}function Ml(F,z,L,M,W){F.l+=2;var G=F.read_shift(2),se=F.read_shift(2),ge=s(F);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var re=F.read_shift(4),le=F.read_shift(4),ce=F.read_shift(4),Se=F.read_shift(2),Fe=F.read_shift(2),Oe="",Te=0;Te<Se;++Te)Oe+=String.fromCharCode(F[F.l++]);if(Fe){var Pe=o(F.slice(F.l,F.l+Fe));(Pe[21589]||{}).mt&&(ge=Pe[21589].mt),((W||{})[21589]||{}).mt&&(ge=W[21589].mt)}F.l+=Fe;var He=F.slice(F.l,F.l+le);switch(se){case 8:He=H(F,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var kt=!1;G&8&&(re=F.read_shift(4),re==134695760&&(re=F.read_shift(4),kt=!0),le=F.read_shift(4),ce=F.read_shift(4)),le!=z&&Bl(kt,"Bad compressed size: "+z+" != "+le),ce!=L&&Bl(kt,"Bad uncompressed size: "+L+" != "+ce),tf(M,Oe,He,{unsafe:!0,mt:ge})}function qa(F,z){var L=z||{},M=[],W=[],G=me(1),se=L.compression?8:0,ge=0,re=0,le=0,ce=0,Se=0,Fe=F.FullPaths[0],Oe=Fe,Te=F.FileIndex[0],Pe=[],He=0;for(re=1;re<F.FullPaths.length;++re)if(Oe=F.FullPaths[re].slice(Fe.length),Te=F.FileIndex[re],!(!Te.size||!Te.content||Oe=="Sh33tJ5")){var kt=ce,St=me(Oe.length);for(le=0;le<Oe.length;++le)St.write_shift(1,Oe.charCodeAt(le)&127);St=St.slice(0,St.l),Pe[Se]=wT.buf(Te.content,0);var cr=Te.content;se==8&&(cr=U(cr)),G=me(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,ge),G.write_shift(2,se),Te.mt?i(G,Te.mt):G.write_shift(4,0),G.write_shift(-4,Pe[Se]),G.write_shift(4,cr.length),G.write_shift(4,Te.content.length),G.write_shift(2,St.length),G.write_shift(2,0),ce+=G.length,M.push(G),ce+=St.length,M.push(St),ce+=cr.length,M.push(cr),G=me(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,ge),G.write_shift(2,se),G.write_shift(4,0),G.write_shift(-4,Pe[Se]),G.write_shift(4,cr.length),G.write_shift(4,Te.content.length),G.write_shift(2,St.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,kt),He+=G.l,W.push(G),He+=St.length,W.push(St),++Se}return G=me(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,Se),G.write_shift(2,Se),G.write_shift(4,He),G.write_shift(4,ce),G.write_shift(2,0),Qt([Qt(M),Qt(W),G])}var Wn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function L_(F,z){if(F.ctype)return F.ctype;var L=F.name||"",M=L.match(/\.([^\.]+)$/);return M&&Wn[M[1]]||z&&(M=(L=z).match(/[\.\\]([^\.\\])+$/),M&&Wn[M[1]])?Wn[M[1]]:"application/octet-stream"}function B_(F){for(var z=tl(F),L=[],M=0;M<z.length;M+=76)L.push(z.slice(M,M+76));return L.join(`\r
`)+`\r
`}function U_(F){var z=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var ce=le.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],M=z.split(`\r
`),W=0;W<M.length;++W){var G=M[W];if(G.length==0){L.push("");continue}for(var se=0;se<G.length;){var ge=76,re=G.slice(se,se+ge);re.charAt(ge-1)=="="?ge--:re.charAt(ge-2)=="="?ge-=2:re.charAt(ge-3)=="="&&(ge-=3),re=G.slice(se,se+ge),se+=ge,se<G.length&&(re+="="),L.push(re)}}return L.join(`\r
`)}function M_(F){for(var z=[],L=0;L<F.length;++L){for(var M=F[L];L<=F.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+F[++L];z.push(M)}for(var W=0;W<z.length;++W)z[W]=z[W].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return jr(z.join(`\r
`))}function j_(F,z,L){for(var M="",W="",G="",se,ge=0;ge<10;++ge){var re=z[ge];if(!re||re.match(/^\s*$/))break;var le=re.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":M=le[2].trim();break;case"content-type":G=le[2].trim();break;case"content-transfer-encoding":W=le[2].trim();break}}switch(++ge,W.toLowerCase()){case"base64":se=jr(qr(z.slice(ge).join("")));break;case"quoted-printable":se=M_(z.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var ce=tf(F,M.slice(L.length),se,{unsafe:!0});G&&(ce.ctype=G)}function $_(F,z){if(j(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=z&&z.root||"",M=(Ke&&Buffer.isBuffer(F)?F.toString("binary"):j(F)).split(`\r
`),W=0,G="";for(W=0;W<M.length;++W)if(G=M[W],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),L||(L=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),G.slice(0,L.length)!=L););var se=(M[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var ge="--"+(se[1]||""),re=[],le=[],ce={FileIndex:re,FullPaths:le};k(ce);var Se,Fe=0;for(W=0;W<M.length;++W){var Oe=M[W];Oe!==ge&&Oe!==ge+"--"||(Fe++&&j_(ce,M.slice(Se,W),L),Se=W)}return ce}function z_(F,z){var L=z||{},M=L.boundary||"SheetJS";M="------="+M;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],G=F.FullPaths[0],se=G,ge=F.FileIndex[0],re=1;re<F.FullPaths.length;++re)if(se=F.FullPaths[re].slice(G.length),ge=F.FileIndex[re],!(!ge.size||!ge.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(He){return"_x"+He.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(He){return"_u"+He.charCodeAt(0).toString(16)+"_"});for(var le=ge.content,ce=Ke&&Buffer.isBuffer(le)?le.toString("binary"):j(le),Se=0,Fe=Math.min(1024,ce.length),Oe=0,Te=0;Te<=Fe;++Te)(Oe=ce.charCodeAt(Te))>=32&&Oe<128&&++Se;var Pe=Se>=Fe*4/5;W.push(M),W.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+se),W.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),W.push("Content-Type: "+L_(ge,se)),W.push(""),W.push(Pe?U_(ce):B_(ce))}return W.push(M+`--\r
`),W.join(`\r
`)}function W_(F){var z={};return k(z,F),z}function tf(F,z,L,M){var W=M&&M.unsafe;W||k(F);var G=!W&&De.find(F,z);if(!G){var se=F.FullPaths[0];z.slice(0,se.length)==se?se=z:(se.slice(-1)!="/"&&(se+="/"),se=(se+z).replace("//","/")),G={name:a(z),type:2},F.FileIndex.push(G),F.FullPaths.push(se),W||De.utils.cfb_gc(F)}return G.content=L,G.size=L?L.length:0,M&&(M.CLSID&&(G.clsid=M.CLSID),M.mt&&(G.mt=M.mt),M.ct&&(G.ct=M.ct)),G}function H_(F,z){k(F);var L=De.find(F,z);if(L){for(var M=0;M<F.FileIndex.length;++M)if(F.FileIndex[M]==L)return F.FileIndex.splice(M,1),F.FullPaths.splice(M,1),!0}return!1}function V_(F,z,L){k(F);var M=De.find(F,z);if(M){for(var W=0;W<F.FileIndex.length;++W)if(F.FileIndex[W]==M)return F.FileIndex[W].name=a(L),F.FullPaths[W]=L,!0}return!1}function G_(F){C(F,!0)}return t.find=X,t.read=E,t.parse=u,t.write=ae,t.writeFile=oe,t.utils={cfb_new:W_,cfb_add:tf,cfb_del:H_,cfb_mov:V_,cfb_gc:G_,ReadShift:Eo,CheckField:Nw,prep_blob:ir,bconcat:Qt,use_zlib:b,_deflateRaw:We,_inflateRaw:Ll,consts:Q},t}();let Ea;function yT(e){Ea=e}function _T(e){return typeof e=="string"?Tl(e):Array.isArray(e)?GE(e):e}function Cl(e,t,r){if(typeof Ea<"u"&&Ea.writeFileSync)return r?Ea.writeFileSync(e,t,r):Ea.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Tl(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ln(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([_T(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ha(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function kT(e){if(typeof Ea<"u")return Ea.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function It(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function i1(e,t){for(var r=[],n=It(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function zu(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Wu(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function ST(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var lu=new Date(1899,11,30,0,0,0);function qt(e,t){var r=e.getTime(),n=lu.getTime()+(e.getTimezoneOffset()-lu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var vw=new Date,ET=lu.getTime()+(vw.getTimezoneOffset()-lu.getTimezoneOffset())*6e4,s1=vw.getTimezoneOffset();function Hu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+ET),t.getTimezoneOffset()!==s1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-s1)*6e4),t}function TT(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var o1=new Date("2017-02-19T19:06:09.000Z"),xw=isNaN(o1.getFullYear())?new Date("2/19/17"):o1,bT=xw.getFullYear()==2017;function xt(e,t){var r=new Date(e);if(bT)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(xw.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Si(e,t){if(Ke&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ln(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ln(aw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ln(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ln(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function ft(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ft(e[r]));return t}function Pt(e,t){for(var r="";r.length<t;)r+=e;return r}function bn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var CT=["january","february","march","april","may","june","july","august","september","october","november","december"];function Rs(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&CT.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var AT=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function ww(e){return e?e.content&&e.type?Si(e.content,!0):e.data?us(e.data):e.asNodeBuffer&&Ke?us(e.asNodeBuffer().toString("binary")):e.asBinary?us(e.asBinary()):e._data&&e._data.getContent?us(Si(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function yw(e){if(!e)return null;if(e.data)return au(e.data);if(e.asNodeBuffer&&Ke)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?au(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function FT(e){return e&&e.name.slice(-4)===".bin"?yw(e):ww(e)}function rn(e,t){for(var r=e.FullPaths||It(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Rd(e,t){var r=rn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Mt(e,t,r){if(!r)return FT(Rd(e,t));if(!t)return null;try{return Mt(e,t)}catch{return null}}function $r(e,t,r){if(!r)return ww(Rd(e,t));if(!t)return null;try{return $r(e,t)}catch{return null}}function PT(e,t,r){return yw(Rd(e,t))}function l1(e){for(var t=e.FullPaths||It(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function qe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ke?n=sa(r):n=qE(r),De.utils.cfb_add(e,t,n)}De.utils.cfb_add(e,t,r)}else e.file(t,r)}function Od(){return De.utils.cfb_new()}function _w(e,t){switch(t.type){case"base64":return De.read(e,{type:"base64"});case"binary":return De.read(e,{type:"binary"});case"buffer":case"array":return De.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function fo(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Bt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,RT=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,c1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,OT=/<[^>]*>/g,kr=Bt.match(c1)?c1:OT,IT=/<\w*:/,NT=/<(\/?)\w+:/;function $e(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(RT),o=0,l="",c=0,u="",f="",p=1;if(s)for(c=0;c!=s.length;++c){for(f=s[c],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(p=(a=f.charCodeAt(i+1))==34||a==39?1:0,l=f.slice(i+1+p,f.length-p),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var h=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[h]&&u.slice(o-3,o)=="ext")continue;n[h]=l,n[h.toLowerCase()]=l}}return n}function $n(e){return e.replace(NT,"<$1")}var kw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Id=zu(kw),nt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,l){return kw[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),Nd=/[&<>'"]/g,DT=/[\u0000-\u0008\u000b-\u001f]/g;function lt(e){var t=e+"";return t.replace(Nd,function(r){return Id[r]}).replace(DT,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function u1(e){return lt(e).replace(/ /g,"_x0020_")}var Sw=/[\u0000-\u001f]/g;function Dd(e){var t=e+"";return t.replace(Nd,function(r){return Id[r]}).replace(/\n/g,"<br/>").replace(Sw,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function LT(e){var t=e+"";return t.replace(Nd,function(r){return Id[r]}).replace(Sw,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var f1=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function BT(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function mt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Nf(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function h1(e){var t=La(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function d1(e){return sa(e,"binary").toString("utf8")}var ac="foo bar baz",ut=Ke&&(d1(ac)==Nf(ac)&&d1||h1(ac)==Nf(ac)&&h1)||Nf,Ln=Ke?function(e){return sa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},nl=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Ew=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),UT=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),MT=/<\/?(?:vt:)?variant>/g,jT=/<(?:vt:)([^>]*)>([\s\S]*)</;function p1(e,t){var r=$e(e),n=e.match(UT(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(MT,"").match(jT);s&&a.push({v:ut(s[2]),t:s[1]})}),a}var Tw=/(^\s|\s$|\n)/;function sr(e,t){return"<"+e+(t.match(Tw)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function al(e){return It(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function be(e,t,r){return"<"+e+(r!=null?al(r):"")+(t!=null?(t.match(Tw)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ah(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function $T(e,t){switch(typeof e){case"string":var r=be("vt:lpwstr",lt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return be((e|0)==e?"vt:i4":"vt:r8",lt(String(e)));case"boolean":return be("vt:bool",e?"true":"false")}if(e instanceof Date)return be("vt:filetime",ah(e));throw new Error("Unable to serialize "+e)}function Ld(e){if(Ke&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ut(Ha(Ad(e)));throw new Error("Bad input format: expected Buffer or string")}var il=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Vt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ri=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Mr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function zT(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function WT(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var m1=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},g1=Ke?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:sa(t)})):m1(e)}:m1,v1=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Yn(e,a)));return n.join("").replace(xr,"")},Vu=Ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(xr,""):v1(e,t,r)}:v1,x1=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},bw=Ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):x1(e,t,r)}:x1,w1=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Ki(e,a)));return n.join("")},zs=Ke?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):w1(t,r,n)}:w1,Cw=function(e,t){var r=Jt(e,t);return r>0?zs(e,t+4,t+4+r-1):""},Bd=Cw,Aw=function(e,t){var r=Jt(e,t);return r>0?zs(e,t+4,t+4+r-1):""},Ud=Aw,Fw=function(e,t){var r=2*Jt(e,t);return r>0?zs(e,t+4,t+4+r-1):""},Md=Fw,Pw=function(t,r){var n=Jt(t,r);return n>0?Vu(t,r+4,r+4+n):""},jd=Pw,Rw=function(e,t){var r=Jt(e,t);return r>0?zs(e,t+4,t+4+r):""},$d=Rw,Ow=function(e,t){return zT(e,t)},cu=Ow,zd=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ke&&(Bd=function(t,r){if(!Buffer.isBuffer(t))return Cw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Ud=function(t,r){if(!Buffer.isBuffer(t))return Aw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Md=function(t,r){if(!Buffer.isBuffer(t))return Fw(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},jd=function(t,r){if(!Buffer.isBuffer(t))return Pw(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},$d=function(t,r){if(!Buffer.isBuffer(t))return Rw(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},cu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Ow(t,r)},zd=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function Iw(){Vu=function(e,t,r){return tt.utils.decode(1200,e.slice(t,r)).replace(xr,"")},zs=function(e,t,r){return tt.utils.decode(65001,e.slice(t,r))},Bd=function(e,t){var r=Jt(e,t);return r>0?tt.utils.decode(_i,e.slice(t+4,t+4+r-1)):""},Ud=function(e,t){var r=Jt(e,t);return r>0?tt.utils.decode(Vr,e.slice(t+4,t+4+r-1)):""},Md=function(e,t){var r=2*Jt(e,t);return r>0?tt.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},jd=function(e,t){var r=Jt(e,t);return r>0?tt.utils.decode(1200,e.slice(t+4,t+4+r)):""},$d=function(e,t){var r=Jt(e,t);return r>0?tt.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof tt<"u"&&Iw();var Ki=function(e,t){return e[t]},Yn=function(e,t){return e[t+1]*256+e[t]},HT=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Jt=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ti=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},VT=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Eo(e,t){var r="",n,a,i=[],s,o,l,c;switch(t){case"dbcs":if(c=this.l,Ke&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Yn(this,c)),c+=2;e*=2;break;case"utf8":r=zs(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Vu(this,this.l,this.l+e);break;case"wstr":if(typeof tt<"u")r=tt.utils.decode(Vr,this.slice(this.l,this.l+2*e));else return Eo.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Bd(this,this.l),e=4+Jt(this,this.l);break;case"lpstr-cp":r=Ud(this,this.l),e=4+Jt(this,this.l);break;case"lpwstr":r=Md(this,this.l),e=4+2*Jt(this,this.l);break;case"lpp4":e=4+Jt(this,this.l),r=jd(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Jt(this,this.l),r=$d(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Ki(this,this.l+e++))!==0;)i.push(co(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Yn(this,this.l+e))!==0;)i.push(co(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Ki(this,c),this.l=c+1,o=Eo.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(co(Yn(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":if(typeof tt<"u"){r=tt.utils.decode(Vr,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Ki(this,c),this.l=c+1,o=Eo.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(co(Ki(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return n=Ki(this,this.l),this.l++,n;case 2:return n=(t==="i"?HT:Yn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ti:VT)(this,this.l),this.l+=4,n):(a=Jt(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=cu(this,this.l):a=cu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=bw(this,this.l,e);break}}return this.l+=e,r}var GT=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},qT=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},KT=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function XT(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)KT(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){if(typeof tt<"u"&&_i==874)for(a=0;a!=t.length;++a){var i=tt.utils.encode(_i,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,GT(this,t,this.l);break;case 8:if(n=8,r==="f"){WT(this,t,this.l);break}case 16:break;case-4:n=4,qT(this,t,this.l);break}return this.l+=n,this}function Nw(e,t){var r=bw(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ir(e,t){e.l=t,e.read_shift=Eo,e.chk=Nw,e.write_shift=XT}function _r(e,t){e.l+=t}function me(e){var t=La(e);return ir(t,0),t}function oa(e,t,r){if(e){var n,a,i;ir(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=fl[o]||fl[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;l=e.l+i;var u=c.f&&c.f(e,i,r);if(e.l=l,t(u,c,o))return}}}function Lr(){var e=[],t=Ke?256:2048,r=function(c){var u=me(c);return ir(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},s=function(){return a(),Qt(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function ye(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=fl[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&zd(r)&&e.push(r)}}function To(e,t,r){var n=ft(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function y1(e,t,r){var n=ft(e);return n.s=To(n.s,t.s,r),n.e=To(n.e,t.s,r),n}function bo(e,t){if(e.cRel&&e.c<0)for(e=ft(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ft(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=je(e);return!e.cRel&&e.cRel!=null&&(r=QT(r)),!e.rRel&&e.rRel!=null&&(r=YT(r)),r}function Df(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+vt(e.s.c)+":"+(e.e.cRel?"":"$")+vt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Rt(e.s.r)+":"+(e.e.rRel?"":"$")+Rt(e.e.r):bo(e.s,t.biff)+":"+bo(e.e,t.biff)}function Wd(e){return parseInt(JT(e),10)-1}function Rt(e){return""+(e+1)}function YT(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function JT(e){return e.replace(/\$(\d+)$/,"$1")}function Hd(e){for(var t=ZT(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function vt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function QT(e){return e.replace(/^([A-Z])/,"$$$1")}function ZT(e){return e.replace(/^\$([A-Z])/,"$1")}function e4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function je(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Cr(e){var t=e.indexOf(":");return t==-1?{s:Tt(e),e:Tt(e)}:{s:Tt(e.slice(0,t)),e:Tt(e.slice(t+1))}}function Ve(e,t){return typeof t>"u"||typeof t=="number"?Ve(e.s,e.e):(typeof e!="string"&&(e=je(e)),typeof t!="string"&&(t=je(t)),e==t?e:e+":"+t)}function Ze(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function _1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Kr(e.z,r?qt(t):t)}catch{}try{return e.w=Kr((e.XF||{}).numFmtId||(r?14:0),r?qt(t):t)}catch{return""+t}}function jn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?la[e.v]||e.v:t==null?_1(e,e.v):_1(e,t))}function Va(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Dw(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Tt(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Ze(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[f].length;++p)if(!(typeof t[f][p]>"u")){var h={v:t[f][p]},m=s+f,d=o+p;if(c.s.r>m&&(c.s.r=m),c.s.c>d&&(c.s.c=d),c.e.r<m&&(c.e.r=m),c.e.c<d&&(c.e.c=d),t[f][p]&&typeof t[f][p]=="object"&&!Array.isArray(t[f][p])&&!(t[f][p]instanceof Date))h=t[f][p];else if(Array.isArray(h.v)&&(h.f=t[f][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Le[14],n.cellDates?(h.t="d",h.w=Kr(h.z,qt(h.v))):(h.t="n",h.v=qt(h.v),h.w=Kr(h.z,h.v))):h.t="s";if(a)i[m]||(i[m]=[]),i[m][d]&&i[m][d].z&&(h.z=i[m][d].z),i[m][d]=h;else{var v=je({c:d,r:m});i[v]&&i[v].z&&(h.z=i[v].z),i[v]=h}}}return c.s.c<1e7&&(i["!ref"]=Ve(c)),i}function Ws(e,t){return Dw(null,e,t)}function t4(e){return e.read_shift(4,"i")}function Cn(e,t){return t||(t=me(4)),t.write_shift(4,e),t}function wr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Zt(e,t){var r=!1;return t==null&&(r=!0,t=me(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function r4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function n4(e,t){return t||(t=me(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Vd(e,t){var r=e.l,n=e.read_shift(1),a=wr(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(r4(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function a4(e,t){var r=!1;return t==null&&(r=!0,t=me(15+4*e.t.length)),t.write_shift(1,0),Zt(e.t,t),r?t.slice(0,t.l):t}var i4=Vd;function s4(e,t){var r=!1;return t==null&&(r=!0,t=me(23+4*e.t.length)),t.write_shift(1,1),Zt(e.t,t),t.write_shift(4,1),n4({},t),r?t.slice(0,t.l):t}function dn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Oi(e,t){return t==null&&(t=me(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ii(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ni(e,t){return t==null&&(t=me(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var o4=wr,Lw=Zt;function Gd(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function uu(e,t){var r=!1;return t==null&&(r=!0,t=me(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var l4=wr,ih=Gd,qd=uu;function Kd(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?cu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ti(t,0)>>2;return r?a/100:a}function Bw(e,t){t==null&&(t=me(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Uw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function c4(e,t){return t||(t=me(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Di=Uw,Hs=c4;function vr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ei(e,t){return(t||me(8)).write_shift(8,e,"f")}function u4(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=fi[a];c&&(t.rgb=ol(c));break;case 2:t.rgb=ol([s,o,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function fu(e,t){if(t||(t=me(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function f4(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function h4(e,t){t||(t=me(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Mw(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function d4(e){return Mw(e,1)}function p4(e){return Mw(e,2)}var Xd=2,Pr=3,ic=11,k1=12,hu=19,sc=64,m4=65,g4=71,v4=4108,x4=4126,Xt=80,jw=81,w4=[Xt,jw],sh={1:{n:"CodePage",t:Xd},2:{n:"Category",t:Xt},3:{n:"PresentationFormat",t:Xt},4:{n:"ByteCount",t:Pr},5:{n:"LineCount",t:Pr},6:{n:"ParagraphCount",t:Pr},7:{n:"SlideCount",t:Pr},8:{n:"NoteCount",t:Pr},9:{n:"HiddenCount",t:Pr},10:{n:"MultimediaClipCount",t:Pr},11:{n:"ScaleCrop",t:ic},12:{n:"HeadingPairs",t:v4},13:{n:"TitlesOfParts",t:x4},14:{n:"Manager",t:Xt},15:{n:"Company",t:Xt},16:{n:"LinksUpToDate",t:ic},17:{n:"CharacterCount",t:Pr},19:{n:"SharedDoc",t:ic},22:{n:"HyperlinksChanged",t:ic},23:{n:"AppVersion",t:Pr,p:"version"},24:{n:"DigSig",t:m4},26:{n:"ContentType",t:Xt},27:{n:"ContentStatus",t:Xt},28:{n:"Language",t:Xt},29:{n:"Version",t:Xt},255:{},2147483648:{n:"Locale",t:hu},2147483651:{n:"Behavior",t:hu},1919054434:{}},oh={1:{n:"CodePage",t:Xd},2:{n:"Title",t:Xt},3:{n:"Subject",t:Xt},4:{n:"Author",t:Xt},5:{n:"Keywords",t:Xt},6:{n:"Comments",t:Xt},7:{n:"Template",t:Xt},8:{n:"LastAuthor",t:Xt},9:{n:"RevNumber",t:Xt},10:{n:"EditTime",t:sc},11:{n:"LastPrinted",t:sc},12:{n:"CreatedDate",t:sc},13:{n:"ModifiedDate",t:sc},14:{n:"PageCount",t:Pr},15:{n:"WordCount",t:Pr},16:{n:"CharCount",t:Pr},17:{n:"Thumbnail",t:g4},18:{n:"Application",t:Xt},19:{n:"DocSecurity",t:Pr},255:{},2147483648:{n:"Locale",t:hu},2147483651:{n:"Behavior",t:hu},1919054434:{}},S1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},y4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function _4(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var k4=_4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),fi=ft(k4),la={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$w={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},lh={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},oc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Yd(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function S4(e){var t=Yd();if(!e||!e.match)return t;var r={};if((e.match(kr)||[]).forEach(function(n){var a=$e(n);switch(a[0].replace(IT,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[lh[a.ContentType]]!==void 0&&t[lh[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Vt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function zw(e,t){var r=ST(lh),n=[],a;n[n.length]=Bt,n[n.length]=be("Types",null,{xmlns:Vt.CT,"xmlns:xsd":Vt.xsd,"xmlns:xsi":Vt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return be("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=be("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:oc[l][t.bookType]||oc[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(c){n[n.length]=be("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:oc[l][t.bookType]||oc[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=be("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Xe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function sl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Co(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(kr)||[]).forEach(function(a){var i=$e(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:fo(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}function ys(e){var t=[Bt,be("Relationships",null,{xmlns:Vt.RELS})];return It(e["!id"]).forEach(function(r){t[t.length]=be("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ot(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Xe.HLINK,Xe.XPATH,Xe.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var E4="application/vnd.oasis.opendocument.spreadsheet";function T4(e,t){for(var r=Ld(e),n,a;n=il.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=$e(n[0],!1),a.path=="/"&&a.type!==E4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function b4(e){var t=[Bt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function E1(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function C4(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function A4(e){var t=[Bt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(E1(e[r][0],e[r][1])),t.push(C4("",e[r][0]));return t.push(E1("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Ww(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+el.version+"</meta:generator></office:meta></office:document-meta>"}var un=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],F4=function(){for(var e=new Array(un.length),t=0;t<un.length;++t){var r=un[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Hw(e){var t={};e=ut(e);for(var r=0;r<un.length;++r){var n=un[r],a=e.match(F4[r]);a!=null&&a.length>0&&(t[n[1]]=nt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=xt(t[n[1]]))}return t}function Lf(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=lt(t),n[n.length]=r?be(e,t,r):sr(e,t))}function Vw(e,t){var r=t||{},n=[Bt,be("cp:coreProperties",null,{"xmlns:cp":Vt.CORE_PROPS,"xmlns:dc":Vt.dc,"xmlns:dcterms":Vt.dcterms,"xmlns:dcmitype":Vt.dcmitype,"xmlns:xsi":Vt.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Lf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:ah(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Lf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:ah(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=un.length;++i){var s=un[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Lf(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var hi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Gw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function qw(e,t,r,n){var a=[];if(typeof e=="string")a=p1(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(u){return{v:u}}));var s=typeof t=="string"?p1(t,n).map(function(u){return u.v}):t,o=0,l=0;if(s.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l);break}o+=l}}function P4(e,t,r){var n={};return t||(t={}),e=ut(e),hi.forEach(function(a){var i=(e.match(nl(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=nt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&qw(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Kw(e){var t=[],r=be;return e||(e={}),e.Application="SheetJS",t[t.length]=Bt,t[t.length]=be("Properties",null,{xmlns:Vt.EXT_PROPS,"xmlns:vt":Vt.vt}),hi.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=lt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+lt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var R4=/<[^>]+>[^<]*/g;function O4(e,t){var r={},n="",a=e.match(R4);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=$e(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=nt(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=nt(u);break;case"bool":r[n]=mt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=xt(u);break;case"cy":case"error":r[n]=nt(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function Xw(e){var t=[Bt,be("Properties",null,{xmlns:Vt.CUST_PROPS,"xmlns:vt":Vt.vt})];if(!e)return t.join("");var r=1;return It(e).forEach(function(a){++r,t[t.length]=be("property",$T(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:lt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ch={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Bf;function I4(e,t,r){Bf||(Bf=zu(ch)),t=Bf[t]||t,e[t]=r}function N4(e,t){var r=[];return It(ch).map(function(n){for(var a=0;a<un.length;++a)if(un[a][1]==n)return un[a];for(a=0;a<hi.length;++a)if(hi[a][1]==n)return hi[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(sr(ch[n[1]]||n[1],a))}}),be("DocumentProperties",r.join(""),{xmlns:Mr.o})}function D4(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&It(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<un.length;++s)if(i==un[s][1])return;for(s=0;s<hi.length;++s)if(i==hi[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(be(u1(i),o,{"dt:dt":l}))}}),t&&It(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(be(u1(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Mr.o+'">'+a.join("")+"</"+n+">"}function Jd(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function L4(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=me(8);return s.write_shift(4,n),s.write_shift(4,a),s}function Yw(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Jw(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Qw(e,t,r){return t===31?Jw(e):Yw(e,t,r)}function uh(e,t,r){return Qw(e,t,r===!1?0:4)}function B4(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Qw(e,t,0)}function U4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(xr,""),e.l-a&2&&(e.l+=2)}return r}function M4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(xr,"");return r}function j4(e){var t=e.l,r=du(e,jw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=du(e,Pr);return[r,n]}function $4(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(j4(e));return r}function T1(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(xr,"").replace(uo,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Zw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function z4(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function du(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==k1&&n!==t&&w4.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===k1?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Yw(e,n,4).replace(xr,"");case 31:return Jw(e);case 64:return Jd(e);case 65:return Zw(e);case 71:return z4(e);case 80:return uh(e,n,!i.raw).replace(xr,"");case 81:return B4(e,n).replace(xr,"");case 4108:return $4(e);case 4126:case 4127:return n==4127?U4(e):M4(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function b1(e,t){var r=me(4),n=me(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=me(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=L4(t);break;case 31:case 80:for(n=me(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Qt([r,n])}function C1(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,l=-1,c={};for(s=0;s!=a;++s){var u=e.read_shift(4),f=e.read_shift(4);i[s]=[u,f+r]}i.sort(function(x,w){return x[1]-w[1]});var p={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var h=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(h=!1,e.l=i[s][1]),h)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var m=t[i[s][0]];if(p[m.n]=du(e,m.t,{raw:!0}),m.p==="version"&&(p[m.n]=String(p[m.n]>>16)+"."+("0000"+String(p[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(p[m.n]){case 0:p[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ln(o=p[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[m.n])}}else if(i[s][0]===1){if(o=p.CodePage=du(e,Xd),ln(o),l!==-1){var d=e.l;e.l=i[l][1],c=T1(e,o),e.l=d}}else if(i[s][0]===0){if(o===0){l=s,e.l=i[s+1][1];continue}c=T1(e,o)}else{var v=c[i[s][0]],g;switch(e[e.l]){case 65:e.l+=4,g=Zw(e);break;case 30:e.l+=4,g=uh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=uh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Nt(e,4);break;case 64:e.l+=4,g=xt(Jd(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[v]=g}}return e.l=r+n,p}var ey=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function W4(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function A1(e,t,r){var n=me(8),a=[],i=[],s=8,o=0,l=me(8),c=me(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),a.push(c),s+=8+l.length,!t){c=me(8),c.write_shift(4,0),a.unshift(c);var u=[me(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(l=me(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Qt(u),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(ey.indexOf(e[o][0])>-1||Gw.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],h=0;if(t){h=+t[e[o][0]];var m=r[h];if(m.p=="version"&&typeof p=="string"){var d=p.split(".");p=(+d[0]<<16)+(+d[1]||0)}l=b1(m.t,p)}else{var v=W4(p);v==-1&&(v=31,p=String(p)),l=b1(v,p)}i.push(l),c=me(8),c.write_shift(4,t?h:2+o),a.push(c),s+=8+l.length}var g=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,g),g+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),Qt([n].concat(a).concat(i))}function F1(e,t,r){var n=e.content;if(!n)return{};ir(n,0);var a,i,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==De.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),l=n.read_shift(4));var f=C1(n,t),p={SystemIdentifier:c};for(var h in f)p[h]=f[h];if(p.FMTID=i,a===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=C1(n,null)}catch{}for(h in m)p[h]=m[h];return p.FMTID=[i,s],p}function P1(e,t,r,n,a,i){var s=me(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,De.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=A1(e,r,n);if(o.push(l),a){var c=A1(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(c)}return Qt(o)}function fa(e,t){return e.read_shift(t),null}function H4(e,t){t||(t=me(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function V4(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Nt(e,t){return e.read_shift(t)===1}function Tr(e,t){return t||(t=me(2)),t.write_shift(2,+!!e),t}function jt(e){return e.read_shift(2,"u")}function nn(e,t){return t||(t=me(2)),t.write_shift(2,e),t}function ty(e,t){return V4(e,t,jt)}function G4(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function ry(e,t,r){return r||(r=me(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Al(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=Vr;if(r&&r.biff>=8&&(Vr=1200),!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return Vr=i,o}function q4(e){var t=Vr;Vr=1200;var r=e.read_shift(2),n=e.read_shift(1),a=n&4,i=n&8,s=1+(n&1),o=0,l,c={};i&&(o=e.read_shift(2)),a&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,u);return i&&(e.l+=4*o),a&&(e.l+=l),c.t=f,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Vr=t,c}function K4(e){var t=e.t||"",r=me(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=me(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Qt(a)}function Ti(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Fl(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ti(e,n,r)}function Li(e,t,r){if(r.biff>5)return Fl(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ny(e,t,r){return r||(r=me(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function X4(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Y4(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(xr,"");return n&&(e.l+=24),a}function J4(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(xr,"");return r+s}function Q4(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Y4(e);case"0303000000000000c000000000000046":return J4(e);default:throw new Error("Unsupported Moniker "+r)}}function lc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(xr,""):"";return r}function R1(e,t){t||(t=me(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Z4(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,l,c="",u,f;a&16&&(i=lc(e,r-e.l)),a&128&&(s=lc(e,r-e.l)),(a&257)===257&&(o=lc(e,r-e.l)),(a&257)===1&&(l=Q4(e,r-e.l)),a&8&&(c=lc(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(f=Jd(e)),e.l=r;var p=s||o||l||"";p&&c&&(p+="#"+c),p||(p="#"+c),a&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var h={Target:p};return u&&(h.guid=u),f&&(h.time=f),i&&(h.Tooltip=i),h}function eb(e){var t=me(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),R1(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&R1(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ay(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function iy(e,t){var r=ay(e);return r[3]=0,r}function zn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function bi(e,t,r,n){return n||(n=me(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function tb(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function rb(e,t,r){return t===0?"":Li(e,t,r)}function nb(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function sy(e){var t=e.read_shift(2),r=Kd(e);return[t,r]}function ab(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Al(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Gu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function oy(e,t){return t||(t=me(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ly(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var ib=ly;function cy(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function sb(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ob(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function hr(e){e.l+=2,e.l+=e.read_shift(2)}var lb={0:hr,4:hr,5:hr,6:hr,7:ob,8:hr,9:hr,10:hr,11:hr,12:hr,13:sb,14:hr,15:hr,16:hr,17:hr,18:hr,19:hr,20:hr,21:cy};function cb(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(lb[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function cc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Qd(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=me(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function ub(e,t){return t===0||e.read_shift(2),1200}function fb(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Li(e,0,r);return e.read_shift(t+n-e.l),a}function hb(e,t){var r=!t||t.biff==8,n=me(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function db(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function pb(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=Al(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function mb(e,t){var r=!t||t.biff>=8?2:1,n=me(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function gb(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(q4(e));return i.Count=n,i.Unique=a,i}function vb(e,t){var r=me(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=K4(e[a]);var i=Qt([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function xb(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function wb(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function yb(e){var t=tb(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function _b(e){return e.read_shift(2),e.read_shift(4)}function O1(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function kb(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function Sb(){var e=me(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Eb(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Tb(e){var t=me(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function bb(){}function Cb(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Al(e,0,r),n}function Ab(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=me(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function Fb(e){var t=zn(e);return t.isst=e.read_shift(4),t}function Pb(e,t,r,n){var a=me(10);return bi(e,t,n,a),a.write_shift(4,r),a}function Rb(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=zn(e);r.biff==2&&e.l++;var i=Fl(e,n-e.l,r);return a.val=i,a}function Ob(e,t,r,n,a){var i=!a||a.biff==8,s=me(8+ +i+(1+i)*r.length);return bi(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function Ib(e,t,r){var n=e.read_shift(2),a=Li(e,0,r);return[n,a]}function Nb(e,t,r,n){var a=r&&r.biff==5;n||(n=me(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var Db=Li;function I1(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c:l}}}function Lb(e,t){var r=t.biff==8||!t.biff?4:2,n=me(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Bb(e){var t=e.read_shift(2),r=e.read_shift(2),n=sy(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Ub(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(sy(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function Mb(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function jb(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=y4[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function $b(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=jb(e,t,n.fStyle,r),n}function N1(e,t,r,n){var a=r&&r.biff==5;n||(n=me(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function zb(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Wb(e){var t=me(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function D1(e,t,r){var n=zn(e);(r.biff==2||t==9)&&++e.l;var a=G4(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function Hb(e,t,r,n,a,i){var s=me(8);return bi(e,t,n,s),ry(r,i,s),s}function Vb(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=zn(e),a=vr(e);return n.val=a,n}function Gb(e,t,r,n){var a=me(14);return bi(e,t,n,a),Ei(r,a),a}var L1=rb;function qb(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Ti(e,i),o=[];n>e.l;)o.push(Fl(e));return[i,a,s,o]}function B1(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=ab(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var Kb=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function U1(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Ti(e,s,r);a&32&&(c=Kb[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:cP(e,u,r,o);return{chKey:i,Name:c,itab:l,rgce:f}}function uy(e,t,r){if(r.biff<8)return Xb(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(nb(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Xb(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Al(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Yb(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=Ti(e,n,r),s=Ti(e,a,r);return[i,s]}function Jb(e,t,r){var n=ly(e);e.l++;var a=e.read_shift(1);return t-=8,[uP(e,t,r),a,n]}function M1(e,t,r){var n=ib(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,oP(e,t,r)]}function Qb(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Zb(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Li(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function eC(e,t,r){return Zb(e,t,r)}function tC(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Gu(e));return r}function rC(e){var t=me(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)oy(e[r],t);return t}function nC(e,t,r){if(r&&r.biff<8)return iC(e,t,r);var n=cy(e),a=cb(e,t-22,n[1]);return{cmo:n,ft:a}}var aC={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function iC(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((aC[n]||_r)(e,t,r)),{cmo:[a,n,i],ft:s}}function sC(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=X4(e,6,r);var o=e.read_shift(2);e.read_shift(2),jt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=Ti(e,e.lens[c+1]-e.lens[c]-1);if(a+=f,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function oC(e,t){var r=Gu(e);e.l+=16;var n=Z4(e,t-24);return[r,n]}function lC(e){var t=me(24),r=Tt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Qt([t,eb(e[1])])}function cC(e,t){e.read_shift(2);var r=Gu(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(xr,""),[r,n]}function uC(e){var t=e[1].Tooltip,r=me(10+2*(t.length+1));r.write_shift(2,2048);var n=Tt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function fC(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=S1[r]||r,r=e.read_shift(2),t[1]=S1[r]||r,t}function hC(e){return e||(e=me(4)),e.write_shift(2,1),e.write_shift(2,1),e}function dC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(iy(e));return r}function pC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(iy(e));return r}function mC(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function fy(e,t,r){if(!r.cellStyles)return _r(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function gC(e,t){var r=me(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function vC(e,t){var r={};return t<32||(e.l+=16,r.header=vr(e),r.footer=vr(e),e.l+=2),r}function xC(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function wC(e){for(var t=me(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var yC=zn,_C=ty,kC=Fl;function SC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function EC(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=zn(e);++e.l;var a=Li(e,t-7,r);return n.t="str",n.val=a,n}function TC(e){var t=zn(e);++e.l;var r=vr(e);return t.t="n",t.val=r,t}function bC(e,t,r){var n=me(15);return Il(n,e,t),n.write_shift(8,r,"f"),n}function CC(e){var t=zn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function AC(e,t,r){var n=me(9);return Il(n,e,t),n.write_shift(2,r),n}function FC(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function PC(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function RC(e,t,r){var n=e.l+t,a=zn(e),i=e.read_shift(2),s=Ti(e,i,r);return e.l=n,a.t="str",a.val=s,a}var OC=[2,3,48,49,131,139,140,245],fh=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=zu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=La(1);switch(l.type){case"base64":u=jr(qr(o));break;case"binary":u=jr(o);break;case"buffer":case"array":u=o;break}ir(u,0);var f=u.read_shift(1),p=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var d=0,v=521;f==2&&(d=u.read_shift(2)),u.l+=3,f!=2&&(d=u.read_shift(4)),d>1048576&&(d=1e6),f!=2&&(v=u.read_shift(2));var g=u.read_shift(2),x=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(x=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var w=[],_={},S=Math.min(u.length,f==2?521:v-10-(h?264:0)),E=m?32:11;u.l<S&&u[u.l]!=13;)switch(_={},_.name=tt.utils.decode(x,u.slice(u.l,u.l+E)).replace(/[\u0000\r\n].*$/g,""),u.l+=E,_.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(_.offset=u.read_shift(4)),_.len=u.read_shift(1),f==2&&(_.offset=u.read_shift(2)),_.dec=u.read_shift(1),_.name.length&&w.push(_),f!=2&&(u.l+=m?13:14),_.type){case"B":(!h||_.len!=8)&&l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var k=0,R=0;for(c[0]=[],R=0;R!=w.length;++R)c[0][R]=w[R].name;for(;d-- >0;){if(u[u.l]===42){u.l+=g;continue}for(++u.l,c[++k]=[],R=0,R=0;R!=w.length;++R){var C=u.slice(u.l,u.l+w[R].len);u.l+=w[R].len,ir(C,0);var N=tt.utils.decode(x,C);switch(w[R].type){case"C":N.trim().length&&(c[k][R]=N.replace(/\s+$/,""));break;case"D":N.length===8?c[k][R]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):c[k][R]=N;break;case"F":c[k][R]=parseFloat(N.trim());break;case"+":case"I":c[k][R]=m?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":c[k][R]=!0;break;case"N":case"F":c[k][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[k][R]="##MEMO##"+(m?parseInt(N.trim(),10):C.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(c[k][R]=+N||0);break;case"@":c[k][R]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":c[k][R]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":c[k][R]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[k][R]=-C.read_shift(-8,"f");break;case"B":if(h&&w[R].len==8){c[k][R]=C.read_shift(8,"f");break}case"G":case"P":C.l+=w[R].len;break;case"0":if(w[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[R].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Ws(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function a(o,l){try{return Va(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&ln(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Lr(),f=vu(o,{header:1,raw:!0,cellDates:!0}),p=f[0],h=f.slice(1),m=o["!cols"]||[],d=0,v=0,g=0,x=1;for(d=0;d<p.length;++d){if(((m[d]||{}).DBF||{}).name){p[d]=m[d].DBF.name,++g;continue}if(p[d]!=null){if(++g,typeof p[d]=="number"&&(p[d]=p[d].toString(10)),typeof p[d]!="string")throw new Error("DBF Invalid column name "+p[d]+" |"+typeof p[d]+"|");if(p.indexOf(p[d])!==d){for(v=0;v<1024;++v)if(p.indexOf(p[d]+"_"+v)==-1){p[d]+="_"+v;break}}}}var w=Ze(o["!ref"]),_=[],S=[],E=[];for(d=0;d<=w.e.c-w.s.c;++d){var k="",R="",C=0,N=[];for(v=0;v<h.length;++v)h[v][d]!=null&&N.push(h[v][d]);if(N.length==0||p[d]==null){_[d]="?";continue}for(v=0;v<N.length;++v){switch(typeof N[v]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=N[v]instanceof Date?"D":"C";break;default:R="C"}C=Math.max(C,String(N[v]).length),k=k&&k!=R?"C":R}C>250&&(C=250),R=((m[d]||{}).DBF||{}).type,R=="C"&&m[d].DBF.len>C&&(C=m[d].DBF.len),k=="B"&&R=="N"&&(k="N",E[d]=m[d].DBF.dec,C=m[d].DBF.len),S[d]=k=="C"||R=="N"?C:i[k]||0,x+=S[d],_[d]=k}var X=u.next(32);for(X.write_shift(4,318902576),X.write_shift(4,h.length),X.write_shift(2,296+32*g),X.write_shift(2,x),d=0;d<4;++d)X.write_shift(4,0);for(X.write_shift(4,0|(+t[_i]||3)<<8),d=0,v=0;d<p.length;++d)if(p[d]!=null){var A=u.next(32),V=(p[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,V,"sbcs"),A.write_shift(1,_[d]=="?"?"C":_[d],"sbcs"),A.write_shift(4,v),A.write_shift(1,S[d]||i[_[d]]||0),A.write_shift(1,E[d]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),v+=S[d]||i[_[d]]||0}var T=u.next(264);for(T.write_shift(4,13),d=0;d<65;++d)T.write_shift(4,0);for(d=0;d<h.length;++d){var K=u.next(x);for(K.write_shift(1,0),v=0;v<p.length;++v)if(p[v]!=null)switch(_[v]){case"L":K.write_shift(1,h[d][v]==null?63:h[d][v]?84:70);break;case"B":K.write_shift(8,h[d][v]||0,"f");break;case"N":var ne="0";for(typeof h[d][v]=="number"&&(ne=h[d][v].toFixed(E[v]||0)),g=0;g<S[v]-ne.length;++g)K.write_shift(1,32);K.write_shift(1,ne,"sbcs");break;case"D":h[d][v]?(K.write_shift(4,("0000"+h[d][v].getFullYear()).slice(-4),"sbcs"),K.write_shift(2,("00"+(h[d][v].getMonth()+1)).slice(-2),"sbcs"),K.write_shift(2,("00"+h[d][v].getDate()).slice(-2),"sbcs")):K.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(h[d][v]!=null?h[d][v]:"").slice(0,S[v]);for(K.write_shift(1,Q,"sbcs"),g=0;g<S[v]-Q.length;++g)K.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),hy=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+It(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var m=e[h];return typeof m=="number"?nh(m):m},n=function(p,h,m){var d=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return d==59?p:nh(d)};e["|"]=254;function a(p,h){switch(h.type){case"base64":return i(qr(p),h);case"binary":return i(p,h);case"buffer":return i(Ke&&Buffer.isBuffer(p)?p.toString("binary"):Ha(p),h);case"array":return i(Si(p),h)}throw new Error("Unrecognized type "+h.type)}function i(p,h){var m=p.split(/[\n\r]+/),d=-1,v=-1,g=0,x=0,w=[],_=[],S=null,E={},k=[],R=[],C=[],N=0,X;for(+h.codepage>=0&&ln(+h.codepage);g!==m.length;++g){N=0;var A=m[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=A.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),T=V[0],K;if(A.length>0)switch(T){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&_.push(A.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,Q=!1,oe=!1,j=!1,ae=-1,q=-1;for(x=1;x<V.length;++x)switch(V[x].charAt(0)){case"A":break;case"X":v=parseInt(V[x].slice(1))-1,Q=!0;break;case"Y":for(d=parseInt(V[x].slice(1))-1,Q||(v=0),X=w.length;X<=d;++X)w[X]=[];break;case"K":K=V[x].slice(1),K.charAt(0)==='"'?K=K.slice(1,K.length-1):K==="TRUE"?K=!0:K==="FALSE"?K=!1:isNaN(bn(K))?isNaN(Rs(K).getDate())||(K=xt(K)):(K=bn(K),S!==null&&Pi(S)&&(K=Hu(K))),typeof tt<"u"&&typeof K=="string"&&(h||{}).type!="string"&&(h||{}).codepage&&(K=tt.utils.decode(h.codepage,K)),ne=!0;break;case"E":j=!0;var b=_s(V[x].slice(1),{r:d,c:v});w[d][v]=[w[d][v],b];break;case"S":oe=!0,w[d][v]=[w[d][v],"S5S"];break;case"G":break;case"R":ae=parseInt(V[x].slice(1))-1;break;case"C":q=parseInt(V[x].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}if(ne&&(w[d][v]&&w[d][v].length==2?w[d][v][0]=K:w[d][v]=K,S=null),oe){if(j)throw new Error("SYLK shared formula cannot have own formula");var H=ae>-1&&w[ae][q];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");w[d][v][1]=Py(H[1],{r:d-ae,c:v-q})}break;case"F":var U=0;for(x=1;x<V.length;++x)switch(V[x].charAt(0)){case"X":v=parseInt(V[x].slice(1))-1,++U;break;case"Y":for(d=parseInt(V[x].slice(1))-1,X=w.length;X<=d;++X)w[X]=[];break;case"M":N=parseInt(V[x].slice(1))/20;break;case"F":break;case"G":break;case"P":S=_[parseInt(V[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=V[x].slice(1).split(" "),X=parseInt(C[0],10);X<=parseInt(C[1],10);++X)N=parseInt(C[2],10),R[X-1]=N===0?{hidden:!0}:{wch:N},Ba(R[X-1]);break;case"C":v=parseInt(V[x].slice(1))-1,R[v]||(R[v]={});break;case"R":d=parseInt(V[x].slice(1))-1,k[d]||(k[d]={}),N>0?(k[d].hpt=N,k[d].hpx=Is(N)):N===0&&(k[d].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}U<1&&(S=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}}return k.length>0&&(E["!rows"]=k),R.length>0&&(E["!cols"]=R),h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),[w,E]}function s(p,h){var m=a(p,h),d=m[0],v=m[1],g=Ws(d,h);return It(v).forEach(function(x){g[x]=v[x]}),g}function o(p,h){return Va(s(p,h),h)}function l(p,h,m,d){var v="C;Y"+(m+1)+";X"+(d+1)+";K";switch(p.t){case"n":v+=p.v||0,p.f&&!p.F&&(v+=";E"+ap(p.f,{r:m,c:d}));break;case"b":v+=p.v?"TRUE":"FALSE";break;case"e":v+=p.w||p.v;break;case"d":v+='"'+(p.w||p.v)+'"';break;case"s":v+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function c(p,h){h.forEach(function(m,d){var v="F;W"+(d+1)+" "+(d+1)+" ";m.hidden?v+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=ll(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=cl(m.wpx)),typeof m.wch=="number"&&(v+=Math.round(m.wch))),v.charAt(v.length-1)!=" "&&p.push(v)})}function u(p,h){h.forEach(function(m,d){var v="F;";m.hidden?v+="M0;":m.hpt?v+="M"+20*m.hpt+";":m.hpx&&(v+="M"+20*ul(m.hpx)+";"),v.length>2&&p.push(v+"R"+(d+1))})}function f(p,h){var m=["ID;PWXL;N;E"],d=[],v=Ze(p["!ref"]),g,x=Array.isArray(p),w=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),p["!cols"]&&c(m,p["!cols"]),p["!rows"]&&u(m,p["!rows"]),m.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var _=v.s.r;_<=v.e.r;++_)for(var S=v.s.c;S<=v.e.c;++S){var E=je({r:_,c:S});g=x?(p[_]||[])[S]:p[E],!(!g||g.v==null&&(!g.f||g.F))&&d.push(l(g,p,_,S))}return m.join(w)+w+d.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:s,from_sheet:f}}(),dy=function(){function e(i,s){switch(s.type){case"base64":return t(qr(i),s);case"binary":return t(i,s);case"buffer":return t(Ke&&Buffer.isBuffer(i)?i.toString("binary"):Ha(i),s);case"array":return t(Si(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var p=o[u].trim().split(","),h=p[0],m=p[1];++u;for(var d=o[u]||"";(d.match(/["]/g)||[]).length&1&&u<o.length-1;)d+=`
`+o[++u];switch(d=d.trim(),+h){case-1:if(d==="BOT"){f[++l]=[],c=0;continue}else if(d!=="EOD")throw new Error("Unrecognized DIF special command "+d);break;case 0:d==="TRUE"?f[l][c]=!0:d==="FALSE"?f[l][c]=!1:isNaN(bn(m))?isNaN(Rs(m).getDate())?f[l][c]=m:f[l][c]=xt(m):f[l][c]=bn(m),++c;break;case 1:d=d.slice(1,d.length-1),d=d.replace(/""/g,'"'),d&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),f[l][c++]=d!==""?d:null;break}if(d==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function r(i,s){return Ws(e(i,s),s)}function n(i,s){return Va(r(i,s),s)}var a=function(){var i=function(l,c,u,f,p){l.push(c),l.push(u+","+f),l.push('"'+p.replace(/"/g,'""')+'"')},s=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=Ze(l["!ref"]),f,p=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){s(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var d=je({r:h,c:m});if(f=p?(l[h]||[])[m]:l[d],!f){s(c,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?s(c,1,0,"="+f.f):s(c,1,0,""):s(c,0,v,"V");break;case"b":s(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Kr(f.z||Le[14],qt(xt(f.v)))),s(c,0,f.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var g=`\r
`,x=c.join(g);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),py=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,p){for(var h=f.split(`
`),m=-1,d=-1,v=0,g=[];v!==h.length;++v){var x=h[v].trim().split(":");if(x[0]==="cell"){var w=Tt(x[1]);if(g.length<=w.r)for(m=g.length;m<=w.r;++m)g[m]||(g[m]=[]);switch(m=w.r,d=w.c,x[2]){case"t":g[m][d]=e(x[3]);break;case"v":g[m][d]=+x[3];break;case"vtf":var _=x[x.length-1];case"vtc":switch(x[3]){case"nl":g[m][d]=!!+x[4];break;default:g[m][d]=+x[4];break}x[2]=="vtf"&&(g[m][d]=[g[m][d],_])}}}return p&&p.sheetRows&&(g=g.slice(0,p.sheetRows)),g}function n(f,p){return Ws(r(f,p),p)}function a(f,p){return Va(n(f,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var p=[],h=[],m,d="",v=Cr(f["!ref"]),g=Array.isArray(f),x=v.s.r;x<=v.e.r;++x)for(var w=v.s.c;w<=v.e.c;++w)if(d=je({r:x,c:w}),m=g?(f[x]||[])[w]:f[d],!(!m||m.v==null||m.t==="z")){switch(h=["cell",d,"t"],m.t){case"s":case"str":h.push(t(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=t(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var _=qt(xt(m.v));h[2]="vtc",h[3]="nd",h[4]=""+_,h[5]=m.w||Kr(m.z||Le[14],_);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function u(f){return[i,s,o,s,c(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),Os=function(){function e(u,f,p,h,m){m.raw?f[p][h]=u:u===""||(u==="TRUE"?f[p][h]=!0:u==="FALSE"?f[p][h]=!1:isNaN(bn(u))?isNaN(Rs(u).getDate())?f[p][h]=u:f[p][h]=xt(u):f[p][h]=bn(u))}function t(u,f){var p=f||{},h=[];if(!u||u.length===0)return h;for(var m=u.split(/[\r\n]/),d=m.length-1;d>=0&&m[d].length===0;)--d;for(var v=10,g=0,x=0;x<=d;++x)g=m[x].indexOf(" "),g==-1?g=m[x].length:g++,v=Math.max(v,g);for(x=0;x<=d;++x){h[x]=[];var w=0;for(e(m[x].slice(0,v).trim(),h,x,w,p),w=1;w<=(m[x].length-v)/10+1;++w)e(m[x].slice(v+(w-1)*10,v+w*10).trim(),h,x,w,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},p=!1,h=0,m=0;h<u.length;++h)(m=u.charCodeAt(h))==34?p=!p:!p&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(d,v){return d[0]-v[0]||n[d[1]]-n[v[1]]}),r[m.pop()[1]]||44}function i(u,f){var p=f||{},h="",m=p.dense?[]:{},d={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=a(u.slice(0,1024)):p&&p.FS?h=p.FS:h=a(u.slice(0,1024));var v=0,g=0,x=0,w=0,_=0,S=h.charCodeAt(0),E=!1,k=0,R=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var C=p.dateNF!=null?vT(p.dateNF):null;function N(){var X=u.slice(w,_),A={};if(X.charAt(0)=='"'&&X.charAt(X.length-1)=='"'&&(X=X.slice(1,-1).replace(/""/g,'"')),X.length===0)A.t="z";else if(p.raw)A.t="s",A.v=X;else if(X.trim().length===0)A.t="s",A.v=X;else if(X.charCodeAt(0)==61)X.charCodeAt(1)==34&&X.charCodeAt(X.length-1)==34?(A.t="s",A.v=X.slice(2,-1).replace(/""/g,'"')):q3(X)?(A.t="n",A.f=X.slice(1)):(A.t="s",A.v=X);else if(X=="TRUE")A.t="b",A.v=!0;else if(X=="FALSE")A.t="b",A.v=!1;else if(!isNaN(x=bn(X)))A.t="n",p.cellText!==!1&&(A.w=X),A.v=x;else if(!isNaN(Rs(X).getDate())||C&&X.match(C)){A.z=p.dateNF||Le[14];var V=0;C&&X.match(C)&&(X=xT(X,p.dateNF,X.match(C)||[]),V=1),p.cellDates?(A.t="d",A.v=xt(X,V)):(A.t="n",A.v=qt(xt(X,V))),p.cellText!==!1&&(A.w=Kr(A.z,A.v instanceof Date?qt(A.v):A.v)),p.cellNF||delete A.z}else A.t="s",A.v=X;if(A.t=="z"||(p.dense?(m[v]||(m[v]=[]),m[v][g]=A):m[je({c:g,r:v})]=A),w=_+1,R=u.charCodeAt(w),d.e.c<g&&(d.e.c=g),d.e.r<v&&(d.e.r=v),k==S)++g;else if(g=0,++v,p.sheetRows&&p.sheetRows<=v)return!0}e:for(;_<u.length;++_)switch(k=u.charCodeAt(_)){case 34:R===34&&(E=!E);break;case S:case 10:case 13:if(!E&&N())break e;break}return _-w>0&&N(),m["!ref"]=Ve(d),m}function s(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):Ws(t(u,f),f)}function o(u,f){var p="",h=f.type=="string"?[0,0,0,0]:dp(u,f);switch(f.type){case"base64":p=qr(u);break;case"binary":p=u;break;case"buffer":f.codepage==65001?p=u.toString("utf8"):f.codepage&&typeof tt<"u"?p=tt.utils.decode(f.codepage,u):p=Ke&&Buffer.isBuffer(u)?u.toString("binary"):Ha(u);break;case"array":p=Si(u);break;case"string":p=u;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=ut(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=ut(p):f.type=="binary"&&typeof tt<"u"&&f.codepage&&(p=tt.utils.decode(f.codepage,tt.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?py.to_sheet(f.type=="string"?p:ut(p),f):s(p,f)}function l(u,f){return Va(o(u,f),f)}function c(u){for(var f=[],p=Ze(u["!ref"]),h,m=Array.isArray(u),d=p.s.r;d<=p.e.r;++d){for(var v=[],g=p.s.c;g<=p.e.c;++g){var x=je({r:d,c:g});if(h=m?(u[d]||[])[g]:u[x],!h||h.v==null){v.push("          ");continue}for(var w=(h.w||(jn(h),h.w)||"").slice(0,10);w.length<10;)w+=" ";v.push(w+(g===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function IC(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=hy.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Os.to_workbook(e,t)}}var di=function(){function e(b,H,U){if(b){ir(b,b.l||0);for(var B=U.Enum||ae;b.l<b.length;){var ee=b.read_shift(2),xe=B[ee]||B[65535],de=b.read_shift(2),he=b.l+de,ve=xe.f&&xe.f(b,de,U);if(b.l=he,H(ve,xe,ee))return}}}function t(b,H){switch(H.type){case"base64":return r(jr(qr(b)),H);case"binary":return r(jr(b),H);case"buffer":case"array":return r(b,H)}throw"Unsupported type "+H.type}function r(b,H){if(!b)return b;var U=H||{},B=U.dense?[]:{},ee="Sheet1",xe="",de=0,he={},ve=[],ie=[],O={s:{r:0,c:0},e:{r:0,c:0}},we=U.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)U.Enum=ae,e(b,function(P,I,Y){switch(Y){case 0:U.vers=P,P>=4096&&(U.qpro=!0);break;case 6:O=P;break;case 204:P&&(xe=P);break;case 222:xe=P;break;case 15:case 51:U.qpro||(P[1].v=P[1].v.slice(1));case 13:case 14:case 16:Y==14&&(P[2]&112)==112&&(P[2]&15)>1&&(P[2]&15)<15&&(P[1].z=U.dateNF||Le[14],U.cellDates&&(P[1].t="d",P[1].v=Hu(P[1].v))),U.qpro&&P[3]>de&&(B["!ref"]=Ve(O),he[ee]=B,ve.push(ee),B=U.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},de=P[3],ee=xe||"Sheet"+(de+1),xe="");var ue=U.dense?(B[P[0].r]||[])[P[0].c]:B[je(P[0])];if(ue){ue.t=P[1].t,ue.v=P[1].v,P[1].z!=null&&(ue.z=P[1].z),P[1].f!=null&&(ue.f=P[1].f);break}U.dense?(B[P[0].r]||(B[P[0].r]=[]),B[P[0].r][P[0].c]=P[1]):B[je(P[0])]=P[1];break}},U);else if(b[2]==26||b[2]==14)U.Enum=q,b[2]==14&&(U.qpro=!0,b.l=0),e(b,function(P,I,Y){switch(Y){case 204:ee=P;break;case 22:P[1].v=P[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(P[3]>de&&(B["!ref"]=Ve(O),he[ee]=B,ve.push(ee),B=U.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},de=P[3],ee="Sheet"+(de+1)),we>0&&P[0].r>=we)break;U.dense?(B[P[0].r]||(B[P[0].r]=[]),B[P[0].r][P[0].c]=P[1]):B[je(P[0])]=P[1],O.e.c<P[0].c&&(O.e.c=P[0].c),O.e.r<P[0].r&&(O.e.r=P[0].r);break;case 27:P[14e3]&&(ie[P[14e3][0]]=P[14e3][1]);break;case 1537:ie[P[0]]=P[1],P[0]==de&&(ee=P[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(B["!ref"]=Ve(O),he[xe||ee]=B,ve.push(xe||ee),!ie.length)return{SheetNames:ve,Sheets:he};for(var y={},Z=[],J=0;J<ie.length;++J)he[ve[J]]?(Z.push(ie[J]||ve[J]),y[ie[J]]=he[ie[J]]||he[ve[J]]):(Z.push(ie[J]),y[ie[J]]={"!ref":"A1"});return{SheetNames:Z,Sheets:y}}function n(b,H){var U=H||{};if(+U.codepage>=0&&ln(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Lr(),ee=Ze(b["!ref"]),xe=Array.isArray(b),de=[];Ce(B,0,i(1030)),Ce(B,6,l(ee));for(var he=Math.min(ee.e.r,8191),ve=ee.s.r;ve<=he;++ve)for(var ie=Rt(ve),O=ee.s.c;O<=ee.e.c;++O){ve===ee.s.r&&(de[O]=vt(O));var we=de[O]+ie,y=xe?(b[ve]||[])[O]:b[we];if(!(!y||y.t=="z"))if(y.t=="n")(y.v|0)==y.v&&y.v>=-32768&&y.v<=32767?Ce(B,13,h(ve,O,y.v)):Ce(B,14,d(ve,O,y.v));else{var Z=jn(y);Ce(B,15,f(ve,O,Z.slice(0,239)))}}return Ce(B,1),B.end()}function a(b,H){var U=H||{};if(+U.codepage>=0&&ln(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Lr();Ce(B,0,s(b));for(var ee=0,xe=0;ee<b.SheetNames.length;++ee)(b.Sheets[b.SheetNames[ee]]||{})["!ref"]&&Ce(B,27,j(b.SheetNames[ee],xe++));var de=0;for(ee=0;ee<b.SheetNames.length;++ee){var he=b.Sheets[b.SheetNames[ee]];if(!(!he||!he["!ref"])){for(var ve=Ze(he["!ref"]),ie=Array.isArray(he),O=[],we=Math.min(ve.e.r,8191),y=ve.s.r;y<=we;++y)for(var Z=Rt(y),J=ve.s.c;J<=ve.e.c;++J){y===ve.s.r&&(O[J]=vt(J));var P=O[J]+Z,I=ie?(he[y]||[])[J]:he[P];if(!(!I||I.t=="z"))if(I.t=="n")Ce(B,23,N(y,J,de,I.v));else{var Y=jn(I);Ce(B,22,k(y,J,de,Y.slice(0,239)))}}++de}}return Ce(B,1),B.end()}function i(b){var H=me(2);return H.write_shift(2,b),H}function s(b){var H=me(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var U=0,B=0,ee=0,xe=0;xe<b.SheetNames.length;++xe){var de=b.SheetNames[xe],he=b.Sheets[de];if(!(!he||!he["!ref"])){++ee;var ve=Cr(he["!ref"]);U<ve.e.r&&(U=ve.e.r),B<ve.e.c&&(B=ve.e.c)}}return U>8191&&(U=8191),H.write_shift(2,U),H.write_shift(1,ee),H.write_shift(1,B),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(b,H,U){var B={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&U.qpro?(B.s.c=b.read_shift(1),b.l++,B.s.r=b.read_shift(2),B.e.c=b.read_shift(1),b.l++,B.e.r=b.read_shift(2),B):(B.s.c=b.read_shift(2),B.s.r=b.read_shift(2),H==12&&U.qpro&&(b.l+=2),B.e.c=b.read_shift(2),B.e.r=b.read_shift(2),H==12&&U.qpro&&(b.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function l(b){var H=me(8);return H.write_shift(2,b.s.c),H.write_shift(2,b.s.r),H.write_shift(2,b.e.c),H.write_shift(2,b.e.r),H}function c(b,H,U){var B=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(B[0].c=b.read_shift(1),B[3]=b.read_shift(1),B[0].r=b.read_shift(2),b.l+=2):(B[2]=b.read_shift(1),B[0].c=b.read_shift(2),B[0].r=b.read_shift(2)),B}function u(b,H,U){var B=b.l+H,ee=c(b,H,U);if(ee[1].t="s",U.vers==20768){b.l++;var xe=b.read_shift(1);return ee[1].v=b.read_shift(xe,"utf8"),ee}return U.qpro&&b.l++,ee[1].v=b.read_shift(B-b.l,"cstr"),ee}function f(b,H,U){var B=me(7+U.length);B.write_shift(1,255),B.write_shift(2,H),B.write_shift(2,b),B.write_shift(1,39);for(var ee=0;ee<B.length;++ee){var xe=U.charCodeAt(ee);B.write_shift(1,xe>=128?95:xe)}return B.write_shift(1,0),B}function p(b,H,U){var B=c(b,H,U);return B[1].v=b.read_shift(2,"i"),B}function h(b,H,U){var B=me(7);return B.write_shift(1,255),B.write_shift(2,H),B.write_shift(2,b),B.write_shift(2,U,"i"),B}function m(b,H,U){var B=c(b,H,U);return B[1].v=b.read_shift(8,"f"),B}function d(b,H,U){var B=me(13);return B.write_shift(1,255),B.write_shift(2,H),B.write_shift(2,b),B.write_shift(8,U,"f"),B}function v(b,H,U){var B=b.l+H,ee=c(b,H,U);if(ee[1].v=b.read_shift(8,"f"),U.qpro)b.l=B;else{var xe=b.read_shift(2);_(b.slice(b.l,b.l+xe),ee),b.l+=xe}return ee}function g(b,H,U){var B=H&32768;return H&=-32769,H=(B?b:0)+(H>=8192?H-16384:H),(B?"":"$")+(U?vt(H):Rt(H))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(b,H){ir(b,0);for(var U=[],B=0,ee="",xe="",de="",he="";b.l<b.length;){var ve=b[b.l++];switch(ve){case 0:U.push(b.read_shift(8,"f"));break;case 1:xe=g(H[0].c,b.read_shift(2),!0),ee=g(H[0].r,b.read_shift(2),!1),U.push(xe+ee);break;case 2:{var ie=g(H[0].c,b.read_shift(2),!0),O=g(H[0].r,b.read_shift(2),!1);xe=g(H[0].c,b.read_shift(2),!0),ee=g(H[0].r,b.read_shift(2),!1),U.push(ie+O+":"+xe+ee)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(b.read_shift(2));break;case 6:{for(var we="";ve=b[b.l++];)we+=String.fromCharCode(ve);U.push('"'+we.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:he=U.pop(),de=U.pop(),U.push(["AND","OR"][ve-20]+"("+de+","+he+")");break;default:if(ve<32&&w[ve])he=U.pop(),de=U.pop(),U.push(de+w[ve]+he);else if(x[ve]){if(B=x[ve][1],B==69&&(B=b[b.l++]),B>U.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+U.join("|")+"|");return}var y=U.slice(-B);U.length-=B,U.push(x[ve][0]+"("+y.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}U.length==1?H[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function S(b){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=b.read_shift(2),H[3]=b[b.l++],H[0].c=b[b.l++],H}function E(b,H){var U=S(b);return U[1].t="s",U[1].v=b.read_shift(H-4,"cstr"),U}function k(b,H,U,B){var ee=me(6+B.length);ee.write_shift(2,b),ee.write_shift(1,U),ee.write_shift(1,H),ee.write_shift(1,39);for(var xe=0;xe<B.length;++xe){var de=B.charCodeAt(xe);ee.write_shift(1,de>=128?95:de)}return ee.write_shift(1,0),ee}function R(b,H){var U=S(b);U[1].v=b.read_shift(2);var B=U[1].v>>1;if(U[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return U[1].v=B,U}function C(b,H){var U=S(b),B=b.read_shift(4),ee=b.read_shift(4),xe=b.read_shift(2);if(xe==65535)return B===0&&ee===3221225472?(U[1].t="e",U[1].v=15):B===0&&ee===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var de=xe&32768;return xe=(xe&32767)-16446,U[1].v=(1-de*2)*(ee*Math.pow(2,xe+32)+B*Math.pow(2,xe)),U}function N(b,H,U,B){var ee=me(14);if(ee.write_shift(2,b),ee.write_shift(1,U),ee.write_shift(1,H),B==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var xe=0,de=0,he=0,ve=0;return B<0&&(xe=1,B=-B),de=Math.log2(B)|0,B/=Math.pow(2,de-31),ve=B>>>0,ve&2147483648||(B/=2,++de,ve=B>>>0),B-=ve,ve|=2147483648,ve>>>=0,B*=Math.pow(2,32),he=B>>>0,ee.write_shift(4,he),ee.write_shift(4,ve),de+=16383+(xe?32768:0),ee.write_shift(2,de),ee}function X(b,H){var U=C(b);return b.l+=H-14,U}function A(b,H){var U=S(b),B=b.read_shift(4);return U[1].v=B>>6,U}function V(b,H){var U=S(b),B=b.read_shift(8,"f");return U[1].v=B,U}function T(b,H){var U=V(b);return b.l+=H-10,U}function K(b,H){return b[b.l+H-1]==0?b.read_shift(H,"cstr"):""}function ne(b,H){var U=b[b.l++];U>H-1&&(U=H-1);for(var B="";B.length<U;)B+=String.fromCharCode(b[b.l++]);return B}function Q(b,H,U){if(!(!U.qpro||H<21)){var B=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var ee=b.read_shift(H-21,"cstr");return[B,ee]}}function oe(b,H){for(var U={},B=b.l+H;b.l<B;){var ee=b.read_shift(2);if(ee==14e3){for(U[ee]=[0,""],U[ee][0]=b.read_shift(2);b[b.l];)U[ee][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return U}function j(b,H){var U=me(5+b.length);U.write_shift(2,14e3),U.write_shift(2,H);for(var B=0;B<b.length;++B){var ee=b.charCodeAt(B);U[U.l++]=ee>127?95:ee}return U[U.l++]=0,U}var ae={0:{n:"BOF",f:jt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:K},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:X},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:T},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:K},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function NC(e){var t={},r=e.match(kr),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=$e(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Cd[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var DC=function(){var e=nl("t"),t=nl("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:nt(s[1])},l=i.match(t);return l&&(o.s=NC(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),LC=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),BC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,UC=/<(?:\w+:)?r>/,MC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Zd(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=nt(ut(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ut(e),r&&(n.h=Dd(n.t))):e.match(UC)&&(n.r=ut(e),n.t=nt(ut((e.replace(MC,"").match(BC)||[]).join("").replace(kr,""))),r&&(n.h=LC(DC(n.r)))),n):{t:""}}var jC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,$C=/<(?:\w+:)?(?:si|sstItem)>/g,zC=/<\/(?:\w+:)?(?:si|sstItem)>/;function WC(e,t){var r=[],n="";if(!e)return r;var a=e.match(jC);if(a){n=a[2].replace($C,"").split(zC);for(var i=0;i!=n.length;++i){var s=Zd(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=$e(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var HC=/^\s|\s$|[\t\n\r]/;function my(e,t){if(!t.bookSST)return"";var r=[Bt];r[r.length]=be("sst",null,{xmlns:Ri[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(HC)&&(i+=' xml:space="preserve"'),i+=">"+lt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function VC(e){return[e.read_shift(4),e.read_shift(4)]}function GC(e,t){var r=[],n=!1;return oa(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function qC(e,t){return t||(t=me(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var KC=a4;function XC(e){var t=Lr();ye(t,159,qC(e));for(var r=0;r<e.length;++r)ye(t,19,KC(e[r]));return ye(t,160),t.end()}function gy(e){if(typeof tt<"u")return tt.utils.encode(_i,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Zn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function YC(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Zn(e,4),t.U=Zn(e,4),t.W=Zn(e,4),t}function JC(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function QC(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(JC(e));return t}function ZC(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function eA(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Zn(e,4),t.U=Zn(e,4),t.W=Zn(e,4),t}function tA(e){var t=eA(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function vy(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function xy(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function rA(e){var t=Zn(e);switch(t.Minor){case 2:return[t.Minor,nA(e)];case 3:return[t.Minor,aA()];case 4:return[t.Minor,iA(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function nA(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=vy(e,r),a=xy(e,e.length-e.l);return{t:"Std",h:n,v:a}}function aA(){throw new Error("File is password-protected: ECMA-376 Extensible")}function iA(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(kr,function(i){var s=$e(i);switch($n(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function sA(e,t){var r={},n=r.EncryptionVersionInfo=Zn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=vy(e,a),t-=a,r.EncryptionVerifier=xy(e,t),r}function oA(e){var t={},r=t.EncryptionVersionInfo=Zn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function ep(e){var t=0,r,n=gy(e),a=n.length+1,i,s,o,l,c;for(r=La(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^s;return t^52811}var wy=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var u=s[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(s){for(var o=gy(s),l=i(o),c=o.length,u=La(16),f=0;f!=16;++f)u[f]=0;var p,h,m;for((c&1)===1&&(p=l>>8,u[c]=a(e[0],p),--c,p=l&255,h=o[o.length-1],u[c]=a(h,p));c>0;)--c,p=l>>8,u[c]=a(o[c],p),--c,p=l&255,u[c]=a(o[c],p);for(c=15,m=15-o.length;m>0;)p=l>>8,u[c]=a(e[m],p),--c,--m,p=l&255,u[c]=a(o[c],p),--c,--m;return u}}(),lA=function(e,t,r,n,a){a||(a=t),n||(n=wy(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},cA=function(e){var t=0,r=wy(e);return function(n){var a=lA("",n,t,r);return t=a[1],a[0]}};function uA(e,t,r,n){var a={key:jt(e),verificationBytes:jt(e)};return r.password&&(a.verifier=ep(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=cA(r.password)),a}function fA(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=oA(e):n.Data=sA(e,t),n}function hA(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?fA(e,t-2,n):uA(e,r.biff>=8?t:t-2,r,n),n}var yy=function(){function e(a,i){switch(i.type){case"base64":return t(qr(a),i);case"binary":return t(a,i);case"buffer":return t(Ke&&Buffer.isBuffer(a)?a.toString("binary"):Ha(a),i);case"array":return t(Si(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var p=/\\\w+\b/g,h=0,m,d=-1;m=p.exec(u);){switch(m[0]){case"\\cell":var v=u.slice(h,p.lastIndex-m[0].length);if(v[0]==" "&&(v=v.slice(1)),++d,v.length){var g={v,t:"s"};Array.isArray(o)?o[f][d]=g:o[je({r:f,c:d})]=g}break}h=p.lastIndex}d>c.e.c&&(c.e.c=d)}),o["!ref"]=Ve(c),o}function r(a,i){return Va(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Ze(a["!ref"]),o,l=Array.isArray(a),c=s.s.r;c<=s.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var f=je({r:c,c:u});o=l?(a[c]||[])[u]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(jn(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function dA(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ol(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function pA(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,l=0,c=a+i;switch(l=s/(c>1?2-c:c),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,l,c/2]}function mA(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,s[0]+=a,s[1]+=l;break;case 1:l=a*(2-o),s[0]+=l,s[1]+=a;break;case 2:l=a*(o-2),s[1]+=a,s[2]+=l;break;case 3:l=a*(4-o),s[1]+=l,s[2]+=a;break;case 4:l=a*(o-4),s[2]+=a,s[0]+=l;break;case 5:l=a*(6-o),s[2]+=l,s[0]+=a;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function pu(e,t){if(t===0)return e;var r=pA(dA(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ol(mA(r))}var _y=6,gA=15,vA=1,gr=_y;function ll(e){return Math.floor((e+Math.round(128/gr)/256)*gr)}function cl(e){return Math.floor((e-5)/gr*100+.5)/100}function mu(e){return Math.round((e*gr+5)/gr*256)/256}function Uf(e){return mu(cl(ll(e)))}function tp(e){var t=Math.abs(e-Uf(e)),r=gr;if(t>.005)for(gr=vA;gr<gA;++gr)Math.abs(e-Uf(e))<=t&&(t=Math.abs(e-Uf(e)),r=gr);gr=r}function Ba(e){e.width?(e.wpx=ll(e.width),e.wch=cl(e.wpx),e.MDW=gr):e.wpx?(e.wch=cl(e.wpx),e.width=mu(e.wch),e.MDW=gr):typeof e.wch=="number"&&(e.width=mu(e.wch),e.wpx=ll(e.width),e.MDW=gr),e.customWidth&&delete e.customWidth}var xA=96,ky=xA;function ul(e){return e*96/ky}function Is(e){return e*ky/96}var wA={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function yA(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(kr)||[]).forEach(function(s){var o=$e(s);switch($n(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=mt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=mt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function _A(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(kr)||[]).forEach(function(s){var o=$e(s);switch($n(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function kA(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(kr)||[]).forEach(function(s){var o=$e(s);switch($n(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=ut(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?mt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?mt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?mt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?mt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?mt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?mt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?mt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Cd[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=mt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=fi[a.color.index];a.color.index==81&&(l=fi[1]),l||(l=fi[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=pu(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function SA(e,t,r){t.NumberFmt=[];for(var n=It(Le),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Le[n[a]];var i=e[0].match(kr);if(i)for(a=0;a<i.length;++a){var s=$e(i[a]);switch($n(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=nt(ut(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Mn(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function EA(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=be("numFmt",null,{numFmtId:n,formatCode:lt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var uc=["numFmtId","fillId","fontId","borderId","xfId"],fc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function TA(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(kr)||[]).forEach(function(i){var s=$e(i),o=0;switch($n(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<uc.length;++o)n[uc[o]]&&(n[uc[o]]=parseInt(n[uc[o]],10));for(o=0;o<fc.length;++o)n[fc[o]]&&(n[fc[o]]=mt(n[fc[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=mt(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function bA(e){var t=[];return t[t.length]=be("cellXfs",null),e.forEach(function(r){t[t.length]=be("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var CA=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&SA(f,u,c),(f=o.match(a))&&kA(f,u,l,c),(f=o.match(n))&&_A(f,u,l,c),(f=o.match(i))&&yA(f,u,l,c),(f=o.match(r))&&TA(f,u,c),u}}();function Sy(e,t){var r=[Bt,be("styleSheet",null,{xmlns:Ri[0],"xmlns:vt":Vt.vt})],n;return e.SSF&&(n=EA(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=bA(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function AA(e,t){var r=e.read_shift(2),n=wr(e);return[r,n]}function FA(e,t,r){r||(r=me(6+4*t.length)),r.write_shift(2,e),Zt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function PA(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=f4(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=u4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=wr(e),n}function RA(e,t){t||(t=me(25+4*32)),t.write_shift(2,e.sz*20),h4(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),fu(e.color,t);var n=0;return n=2,t.write_shift(1,n),Zt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var OA=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Mf,IA=_r;function j1(e,t){t||(t=me(4*3+8*7+16*1)),Mf||(Mf=zu(OA));var r=Mf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(fu({auto:1},t),fu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function NA(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function Ey(e,t,r){r||(r=me(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function no(e,t){return t||(t=me(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var DA=_r;function LA(e,t){return t||(t=me(51)),t.write_shift(1,0),no(null,t),no(null,t),no(null,t),no(null,t),no(null,t),t.length>t.l?t.slice(0,t.l):t}function BA(e,t){return t||(t=me(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),uu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function UA(e,t,r){var n=me(2052);return n.write_shift(4,e),uu(t,n),uu(r,n),n.length>n.l?n.slice(0,n.l):n}function MA(e,t,r){var n={};n.NumberFmt=[];for(var a in Le)n.NumberFmt[a]=Le[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return oa(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Mn(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=pu(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(u),s=!0;break;case 38:i.pop(),s=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function jA(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(ye(e,615,Cn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ye(e,44,FA(a,t[a]))}),ye(e,616))}}function $A(e){var t=1;ye(e,611,Cn(t)),ye(e,43,RA({sz:12,color:{theme:1},name:"Calibri",family:2})),ye(e,612)}function zA(e){var t=2;ye(e,603,Cn(t)),ye(e,45,j1({patternType:"none"})),ye(e,45,j1({patternType:"gray125"})),ye(e,604)}function WA(e){var t=1;ye(e,613,Cn(t)),ye(e,46,LA()),ye(e,614)}function HA(e){var t=1;ye(e,626,Cn(t)),ye(e,47,Ey({numFmtId:0},65535)),ye(e,627)}function VA(e,t){ye(e,617,Cn(t.length)),t.forEach(function(r){ye(e,47,Ey(r,0))}),ye(e,618)}function GA(e){var t=1;ye(e,619,Cn(t)),ye(e,48,BA({xfId:0,name:"Normal"})),ye(e,620)}function qA(e){var t=0;ye(e,505,Cn(t)),ye(e,506)}function KA(e){var t=0;ye(e,508,UA(t,"TableStyleMedium9","PivotStyleMedium4")),ye(e,509)}function XA(e,t){var r=Lr();return ye(r,278),jA(r,e.SSF),$A(r),zA(r),WA(r),HA(r),VA(r,t.cellXfs),GA(r),qA(r),KA(r),ye(r,279),r.end()}var YA=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function JA(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(kr)||[]).forEach(function(a){var i=$e(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[YA.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function QA(){}function ZA(){}var e3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,t3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,r3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function n3(e,t,r){t.themeElements={};var n;[["clrScheme",e3,JA],["fontScheme",t3,QA],["fmtScheme",r3,ZA]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var a3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Ty(e,t){(!e||e.length===0)&&(e=rp());var r,n={};if(!(r=e.match(a3)))throw new Error("themeElements not found in theme");return n3(r[0],n,t),n.raw=e,n}function rp(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Bt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function i3(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=_w(i,{type:"array"})}catch{return}var o=$r(s,"theme/theme/theme1.xml",!0);if(o)return Ty(o,r)}}function s3(e){return e.read_shift(4)}function o3(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=l3(e,4);break;case 2:t.xclrValue=ay(e);break;case 3:t.xclrValue=s3(e);break;case 4:e.l+=4;break}return e.l+=8,t}function l3(e,t){return _r(e,t)}function c3(e,t){return _r(e,t)}function u3(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=o3(e);break;case 6:n[1]=c3(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function f3(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(u3(e,r-e.l));return{ixfe:n,ext:i}}function h3(e,t){t.forEach(function(r){switch(r[0]){}})}function d3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:wr(e)}}function p3(e){var t=me(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Zt(e.name,t),t.slice(0,t.l)}function m3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function g3(e){var t=me(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function v3(e,t){var r=me(8+2*t.length);return r.write_shift(4,e),Zt(t,r),r.slice(0,r.l)}function x3(e){return e.l+=4,e.read_shift(4)!=0}function w3(e,t){var r=me(8);return r.write_shift(4,e),r.write_shift(4,1),r}function y3(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return oa(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!c.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function _3(){var e=Lr();return ye(e,332),ye(e,334,Cn(1)),ye(e,335,p3({name:"XLDAPR",version:12e4,flags:3496657072})),ye(e,336),ye(e,339,v3(1,"XLDAPR")),ye(e,52),ye(e,35,Cn(514)),ye(e,4096,Cn(0)),ye(e,4097,nn(1)),ye(e,36),ye(e,53),ye(e,340),ye(e,337,w3(1)),ye(e,51,g3([[1,0]])),ye(e,338),ye(e,333),e.end()}function k3(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(kr,function(o){var l=$e(o);switch($n(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(s=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function by(){var e=[Bt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function S3(e){var t=[];if(!e)return t;var r=1;return(e.match(kr)||[]).forEach(function(n){var a=$e(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function E3(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=je(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function T3(e,t,r){var n=[];return oa(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function b3(e,t,r,n){if(!e)return e;var a=n||{},i=!1;oa(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function C3(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var fs=1024;function Cy(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[be("xml",null,{"xmlns:v":Mr.v,"xmlns:o":Mr.o,"xmlns:x":Mr.x,"xmlns:mv":Mr.mv}).replace(/\/>/,">"),be("o:shapelayout",be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),be("v:shapetype",[be("v:stroke",null,{joinstyle:"miter"}),be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];fs<e*1e3;)fs+=1e3;return t.forEach(function(i){var s=Tt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=be("v:fill",l,o),u={on:"t",obscured:"t"};++fs,a=a.concat(["<v:shape"+al({id:"_x0000_s"+fs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,be("v:shadow",null,u),be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",sr("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),sr("x:AutoFill","False"),sr("x:Row",String(s.r)),sr("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function $1(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=Tt(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var l=Ze(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ve(l);c!==e["!ref"]&&(e["!ref"]=c)}i.c||(i.c=[]);var u={a:s.author,t:s.t,r:s.r,T:r};s.h&&(u.h=s.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}i.c.push(u)})}function A3(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=$e(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Tt(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&Zd(f[1])||{r:"",t:"",h:""};c.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),c.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=p.h),n.push(c)}}}}),n}function Ay(e){var t=[Bt,be("comments",null,{xmlns:Ri[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=lt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(lt(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(sr("t",lt(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(sr("t",lt(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function F3(e,t){var r=[],n=!1,a={},i=0;return e.replace(kr,function(o,l){var c=$e(o);switch($n(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":a.t=e.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function P3(e,t,r){var n=[Bt,be("ThreadedComments",null,{xmlns:Vt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(be("threadedComment",sr("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function R3(e,t){var r=[],n=!1;return e.replace(kr,function(i){var s=$e(i);switch($n(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function O3(e){var t=[Bt,be("personList",null,{xmlns:Vt.TCMNT,"xmlns:x":Ri[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function I3(e){var t={};t.iauthor=e.read_shift(4);var r=Di(e);return t.rfx=r.s,t.ref=je(r.s),e.l+=16,t}function N3(e,t){return t==null&&(t=me(36)),t.write_shift(4,e[1].iauthor),Hs(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var D3=wr;function L3(e){return Zt(e.slice(0,54))}function B3(e,t){var r=[],n=[],a={},i=!1;return oa(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function U3(e){var t=Lr(),r=[];return ye(t,628),ye(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),ye(t,632,L3(a.a)))})}),ye(t,631),ye(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Tt(n[0]),e:Tt(n[0])};ye(t,635,N3([i,a])),a.t&&a.t.length>0&&ye(t,637,s4(a)),ye(t,636),delete a.iauthor})}),ye(t,634),ye(t,629),t.end()}var M3="application/vnd.ms-office.vbaProject";function j3(e){var t=De.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");De.utils.cfb_add(t,a,e.FileIndex[n].content)}}),De.write(t)}function $3(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&De.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var Fy=["xlsb","xlsm","xlam","biff8","xla"];function z3(){return{"!type":"dialog"}}function W3(){return{"!type":"dialog"}}function H3(){return{"!type":"macro"}}function V3(){return{"!type":"macro"}}var _s=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+vt(u)+(l?"":"$")+Rt(c)}return function(a,i){return t=i,a.replace(e,r)}}(),np=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ap=function(){return function(t,r){return t.replace(np,function(n,a,i,s,o,l){var c=Hd(s)-(i?0:r.c),u=Wd(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",p=c==0?"":i?c+1:"["+c+"]";return a+"R"+f+"C"+p})}}();function Py(e,t){return e.replace(np,function(r,n,a,i,s,o){return n+(a=="$"?a+i:vt(Hd(i)+t.c))+(s=="$"?s+o:Rt(Wd(o)+t.r))})}function G3(e,t,r){var n=Cr(t),a=n.s,i=Tt(r),s={r:i.r-a.r,c:i.c-a.c};return Py(e,s)}function q3(e){return e.length!=1}function z1(e){return e.replace(/_xlfn\./g,"")}function Ut(e){e.l+=1}function Ua(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Ry(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Oy(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Ua(e),o=Ua(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Oy(e){var t=Ua(e),r=Ua(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function K3(e,t,r){if(r.biff<8)return Oy(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Ua(e),s=Ua(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function Iy(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return X3(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Ua(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function X3(e){var t=Ua(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Y3(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function J3(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Q3(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function Q3(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Z3(e,t,r){var n=(e[e.l++]&96)>>5,a=Ry(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function eF(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=Ry(e,i,r);return[n,a,s]}function tF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function rF(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function nF(e,t,r){var n=(e[e.l++]&96)>>5,a=K3(e,t-1,r);return[n,a]}function aF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function W1(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function iF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function sF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function oF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function lF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function cF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Ny(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function uF(e){return e.read_shift(2),Ny(e)}function fF(e){return e.read_shift(2),Ny(e)}function hF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Iy(e,0,r);return[n,a]}function dF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=J3(e,0,r);return[n,a]}function pF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Iy(e,0,r);return[n,a,i]}function mF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[xP[a],By[a],n]}function gF(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:vF(e);return[a,(i[0]===0?By:vP)[i[1]]]}function vF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function xF(e,t,r){e.l+=r&&r.biff==2?3:4}function wF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function yF(e){return e.l++,la[e.read_shift(1)]}function _F(e){return e.l++,e.read_shift(2)}function kF(e){return e.l++,e.read_shift(1)!==0}function SF(e){return e.l++,vr(e)}function EF(e,t,r){return e.l++,Al(e,t-1,r)}function TF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Nt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=la[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=vr(e);break;case 2:r[1]=Li(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function bF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Di:Gu)(e));return a}function CF(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=TF(e,r.biff);return s}function AF(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function FF(e,t,r){if(r.biff==5)return PF(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function PF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function RF(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function OF(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function IF(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function NF(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var DF=_r,LF=_r,BF=_r;function Pl(e,t,r){return e.l+=2,[Y3(e)]}function ip(e){return e.l+=6,[]}var UF=Pl,MF=ip,jF=ip,$F=Pl;function Dy(e){return e.l+=2,[jt(e),e.read_shift(2)&1]}var zF=Pl,WF=Dy,HF=ip,VF=Pl,GF=Pl,qF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function KF(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=qF[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function XF(e){return e.l+=2,[e.read_shift(4)]}function YF(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function JF(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function QF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function ZF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function eP(e){return e.l+=4,[0,0]}var H1={1:{n:"PtgExp",f:wF},2:{n:"PtgTbl",f:BF},3:{n:"PtgAdd",f:Ut},4:{n:"PtgSub",f:Ut},5:{n:"PtgMul",f:Ut},6:{n:"PtgDiv",f:Ut},7:{n:"PtgPower",f:Ut},8:{n:"PtgConcat",f:Ut},9:{n:"PtgLt",f:Ut},10:{n:"PtgLe",f:Ut},11:{n:"PtgEq",f:Ut},12:{n:"PtgGe",f:Ut},13:{n:"PtgGt",f:Ut},14:{n:"PtgNe",f:Ut},15:{n:"PtgIsect",f:Ut},16:{n:"PtgUnion",f:Ut},17:{n:"PtgRange",f:Ut},18:{n:"PtgUplus",f:Ut},19:{n:"PtgUminus",f:Ut},20:{n:"PtgPercent",f:Ut},21:{n:"PtgParen",f:Ut},22:{n:"PtgMissArg",f:Ut},23:{n:"PtgStr",f:EF},26:{n:"PtgSheet",f:YF},27:{n:"PtgEndSheet",f:JF},28:{n:"PtgErr",f:yF},29:{n:"PtgBool",f:kF},30:{n:"PtgInt",f:_F},31:{n:"PtgNum",f:SF},32:{n:"PtgArray",f:aF},33:{n:"PtgFunc",f:mF},34:{n:"PtgFuncVar",f:gF},35:{n:"PtgName",f:AF},36:{n:"PtgRef",f:hF},37:{n:"PtgArea",f:Z3},38:{n:"PtgMemArea",f:RF},39:{n:"PtgMemErr",f:DF},40:{n:"PtgMemNoMem",f:LF},41:{n:"PtgMemFunc",f:OF},42:{n:"PtgRefErr",f:IF},43:{n:"PtgAreaErr",f:tF},44:{n:"PtgRefN",f:dF},45:{n:"PtgAreaN",f:nF},46:{n:"PtgMemAreaN",f:QF},47:{n:"PtgMemNoMemN",f:ZF},57:{n:"PtgNameX",f:FF},58:{n:"PtgRef3d",f:pF},59:{n:"PtgArea3d",f:eF},60:{n:"PtgRefErr3d",f:NF},61:{n:"PtgAreaErr3d",f:rF},255:{}},tP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},rP={1:{n:"PtgElfLel",f:Dy},2:{n:"PtgElfRw",f:VF},3:{n:"PtgElfCol",f:UF},6:{n:"PtgElfRwV",f:GF},7:{n:"PtgElfColV",f:$F},10:{n:"PtgElfRadical",f:zF},11:{n:"PtgElfRadicalS",f:HF},13:{n:"PtgElfColS",f:MF},15:{n:"PtgElfColSV",f:jF},16:{n:"PtgElfRadicalLel",f:WF},25:{n:"PtgList",f:KF},29:{n:"PtgSxName",f:XF},255:{}},nP={0:{n:"PtgAttrNoop",f:eP},1:{n:"PtgAttrSemi",f:cF},2:{n:"PtgAttrIf",f:oF},4:{n:"PtgAttrChoose",f:iF},8:{n:"PtgAttrGoto",f:sF},16:{n:"PtgAttrSum",f:xF},32:{n:"PtgAttrBaxcel",f:W1},33:{n:"PtgAttrBaxcel",f:W1},64:{n:"PtgAttrSpace",f:uF},65:{n:"PtgAttrSpaceSemi",f:fF},128:{n:"PtgAttrIfError",f:lF},255:{}};function Rl(e,t,r,n){if(n.biff<8)return _r(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=CF(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=bF(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(_r(e,t)),i}function Ol(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=H1[i]||H1[tP[i]],(i===24||i===25)&&(a=(i===24?rP:nP)[e[e.l+1]]),!a||!a.f?_r(e,t):s.push([a.n,a.f(e,t,r)]);return s}function aP(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var iP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sP(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Ly(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function V1(e,t,r){var n=Ly(e,t,r);return n=="#REF"?n:sP(n,r)}function pr(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],l,c,u,f=0,p=0,h,m="";if(!e[0]||!e[0][0])return"";for(var d=-1,v="",g=0,x=e[0].length;g<x;++g){var w=e[0][g];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),d>=0){switch(e[0][d][1][0]){case 0:v=Pt(" ",e[0][d][1][1]);break;case 1:v=Pt("\r",e[0][d][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][d][1][0])}c=c+v,d=-1}o.push(c+iP[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=To(w[1][1],s,a),o.push(bo(u,i));break;case"PtgRefN":u=r?To(w[1][1],r,a):w[1][1],o.push(bo(u,i));break;case"PtgRef3d":f=w[1][1],u=To(w[1][2],s,a),m=V1(n,f,a),o.push(m+"!"+bo(u,i));break;case"PtgFunc":case"PtgFuncVar":var _=w[1][0],S=w[1][1];_||(_=0),_&=127;var E=_==0?[]:o.slice(-_);o.length-=_,S==="User"&&(S=E.shift()),o.push(S+"("+E.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":h=y1(w[1][1],r?{s:r}:s,a),o.push(Df(h,a));break;case"PtgArea":h=y1(w[1][1],s,a),o.push(Df(h,a));break;case"PtgArea3d":f=w[1][1],h=w[1][2],m=V1(n,f,a),o.push(m+"!"+Df(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=w[1][2];var k=(n.names||[])[p-1]||(n[0]||[])[p],R=k?k.Name:"SH33TJSNAME"+String(p);R&&R.slice(0,6)=="_xlfn."&&!a.xlfn&&(R=R.slice(6)),o.push(R);break;case"PtgNameX":var C=w[1][1];p=w[1][2];var N;if(a.biff<=5)C<0&&(C=-C),n[C]&&(N=n[C][p]);else{var X="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][p]&&n[C][p].itab>0&&(X=n.SheetNames[n[C][p].itab-1]+"!"):X=n.SheetNames[p-1]+"!"),n[C]&&n[C][p])X+=n[C][p].Name;else if(n[0]&&n[0][p])X+=n[0][p].Name;else{var A=(Ly(n,C,a)||"").split(";;");A[p-1]?X=A[p-1]:X+="SH33TJSERRX"}o.push(X);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var V="(",T=")";if(d>=0){switch(v="",e[0][d][1][0]){case 2:V=Pt(" ",e[0][d][1][1])+V;break;case 3:V=Pt("\r",e[0][d][1][1])+V;break;case 4:T=Pt(" ",e[0][d][1][1])+T;break;case 5:T=Pt("\r",e[0][d][1][1])+T;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][d][1][0])}d=-1}o.push(V+o.pop()+T);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var K={c:r.c,r:r.r};if(n.sharedf[je(u)]){var ne=n.sharedf[je(u)];o.push(pr(ne,s,K,n,a))}else{var Q=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(pr(c[1],s,K,n,a)),Q=!0;break}Q||o.push(w[1])}break;case"PtgArray":o.push("{"+aP(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":d=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&d>=0&&oe.indexOf(e[0][g][0])==-1){w=e[0][d];var j=!0;switch(w[1][0]){case 4:j=!1;case 0:v=Pt(" ",w[1][1]);break;case 5:j=!1;case 1:v=Pt("\r",w[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((j?v:"")+o.pop()+(j?"":v)),d=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function oP(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],_r(e,t-2)];var o=Ol(e,s,r);return t!==s+a&&(i=Rl(e,t-s-a,o,r)),e.l=n,[o,i]}function lP(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],_r(e,t-2)];var o=Ol(e,s,r);return t!==s+a&&(i=Rl(e,t-s-a,o,r)),e.l=n,[o,i]}function cP(e,t,r,n){var a=e.l+t,i=Ol(e,n,r),s;return a!==e.l&&(s=Rl(e,a-e.l,i,r)),[i,s]}function uP(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=Ol(e,i,r);return i==65535?[[],_r(e,t-2)]:(t!==i+2&&(a=Rl(e,n-i-2,s,r)),[s,a])}function fP(e){var t;if(Yn(e,e.l+6)!==65535)return[vr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function hP(e){if(e==null){var t=me(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ei(e);return Ei(0)}function jf(e,t,r){var n=e.l+t,a=zn(e);r.biff==2&&++e.l;var i=fP(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=lP(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function dP(e,t,r,n,a){var i=bi(t,r,a),s=hP(e.v),o=me(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=me(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var f=Qt([i,s,o,c]);return f}function qu(e,t,r){var n=e.read_shift(4),a=Ol(e,n,r),i=e.read_shift(4),s=i>0?Rl(e,i,a,r):null;return[a,s]}var pP=qu,Ku=qu,mP=qu,gP=qu,vP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},By={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},xP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function G1(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function wP(e){var t="of:="+e.replace(np,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function $f(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function yP(e){return e.replace(/\./,"!")}var Ao={},ks={},Fo=typeof Map<"u";function sp(e,t,r){var n=0,a=e.length;if(r){if(Fo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Fo?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Fo?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Xu(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(gr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=cl(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=mu(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function pi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ga(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Mn(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Uy(e,t,r,n,a,i){try{n.cellNF&&(e.z=Le[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=xt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Le[t]==null&&Mn(gT[t]||"General",t),e.t==="e")e.w=e.w||la[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=rl(e.v);else if(e.t==="d"){var s=qt(e.v);(s|0)===s?e.w=s.toString(10):e.w=rl(s)}else{if(e.v===void 0)return"";e.w=ki(e.v,ks)}else e.t==="d"?e.w=Kr(t,qt(e.v),ks):e.w=Kr(t,e.v,ks)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=pu(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=pu(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function _P(e,t,r){if(e&&e["!ref"]){var n=Ze(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function kP(e,t){var r=Ze(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ve(r))}var SP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,EP=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,TP=/<(?:\w:)?hyperlink [^>]*>/mg,bP=/"(\w*:\w*)"/,CP=/<(?:\w:)?col\b[^>]*[\/]?>/g,AP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,FP=/<(?:\w:)?pageMargins[^>]*\/>/g,My=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,PP=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,RP=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function OP(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(EP);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var p=c.match(My);p?op(p[0],o,a,r):(p=c.match(PP))&&NP(p[0],p[1]||"",o,a,r);var h=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=c.slice(h,h+50).match(bP);m&&kP(o,m[1])}var d=c.match(RP);d&&d[1]&&qP(d[1],a);var v=[];if(t.cellStyles){var g=c.match(CP);g&&zP(v,g)}f&&YP(f[1],o,t,l,i,s);var x=u.match(AP);x&&(o["!autofilter"]=HP(x[0]));var w=[],_=u.match(SP);if(_)for(h=0;h!=_.length;++h)w[h]=Ze(_[h].slice(_[h].indexOf('"')+1));var S=u.match(TP);S&&MP(o,S,n);var E=u.match(FP);if(E&&(o["!margins"]=jP($e(E[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ve(l)),t.sheetRows>0&&o["!ref"]){var k=Ze(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>l.e.r&&(k.e.r=l.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>l.e.c&&(k.e.c=l.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ve(k))}return v.length>0&&(o["!cols"]=v),w.length>0&&(o["!merges"]=w),o}function IP(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ve(e[r])+'"/>';return t+"</mergeCells>"}function op(e,t,r,n){var a=$e(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=nt(ut(a.codeName)))}function NP(e,t,r,n,a){op(e.slice(0,e.indexOf(">")),r,n,a)}function DP(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,s.codeName=Ln(lt(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+be("outlinePr",null,c)}!i&&!o||(a[a.length]=be("sheetPr",o,s))}var LP=["objects","scenarios","selectLockedCells","selectUnlockedCells"],BP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function UP(e){var t={sheet:1};return LP.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),BP.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=ep(e.password).toString(16).toUpperCase()),be("sheetProtection",null,t)}function MP(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=$e(ut(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+nt(i.location))):(i.Target="#"+nt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Ze(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=je({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function jP(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function $P(e){return pi(e),be("pageMargins",null,e)}function zP(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=$e(t[n],!0);a.hidden&&(a.hidden=mt(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,tp(a.width)),Ba(a);i<=s;)e[i++]=ft(a)}}function WP(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=be("col",null,Xu(a,n)));return r[r.length]="</cols>",r.join("")}function HP(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function VP(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Ve(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Cr(a);s.s.r==s.e.r&&(s.e.r=Cr(t["!ref"]).e.r,a=Ve(s));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),be("autoFilter",null,{ref:a})}var GP=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function qP(e,t){t.Views||(t.Views=[{}]),(e.match(GP)||[]).forEach(function(r,n){var a=$e(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),mt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function KP(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),be("sheetViews",be("sheetView",null,a),{})}function XP(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=la[e.v];break;case"d":n&&n.cellDates?a=xt(e.v,-1).toISOString():(e=ft(e),e.t="n",a=""+(e.v=qt(xt(e.v)))),typeof e.z>"u"&&(e.z=Le[14]);break;default:a=e.v;break}var o=sr("v",lt(a)),l={r:t},c=Ga(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=sr("v",""+sp(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=be("f",lt(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),be("c",o,l)}var YP=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=nl("v"),s=nl("f");return function(l,c,u,f,p,h){for(var m=0,d="",v=[],g=[],x=0,w=0,_=0,S="",E,k,R=0,C=0,N,X,A=0,V=0,T=Array.isArray(h.CellXf),K,ne=[],Q=[],oe=Array.isArray(c),j=[],ae={},q=!1,b=!!u.sheetStubs,H=l.split(t),U=0,B=H.length;U!=B;++U){d=H[U].trim();var ee=d.length;if(ee!==0){var xe=0;e:for(m=0;m<ee;++m)switch(d[m]){case">":if(d[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(k=$e(d.slice(xe,m),!0),R=k.r!=null?parseInt(k.r,10):R+1,C=-1,u.sheetRows&&u.sheetRows<R)continue;ae={},q=!1,k.ht&&(q=!0,ae.hpt=parseFloat(k.ht),ae.hpx=Is(ae.hpt)),k.hidden=="1"&&(q=!0,ae.hidden=!0),k.outlineLevel!=null&&(q=!0,ae.level=+k.outlineLevel),q&&(j[R-1]=ae)}break;case"<":xe=m;break}if(xe>=m)break;if(k=$e(d.slice(xe,m),!0),R=k.r!=null?parseInt(k.r,10):R+1,C=-1,!(u.sheetRows&&u.sheetRows<R)){f.s.r>R-1&&(f.s.r=R-1),f.e.r<R-1&&(f.e.r=R-1),u&&u.cellStyles&&(ae={},q=!1,k.ht&&(q=!0,ae.hpt=parseFloat(k.ht),ae.hpx=Is(ae.hpt)),k.hidden=="1"&&(q=!0,ae.hidden=!0),k.outlineLevel!=null&&(q=!0,ae.level=+k.outlineLevel),q&&(j[R-1]=ae)),v=d.slice(m).split(e);for(var de=0;de!=v.length&&v[de].trim().charAt(0)=="<";++de);for(v=v.slice(de),m=0;m!=v.length;++m)if(d=v[m].trim(),d.length!==0){if(g=d.match(r),x=m,w=0,_=0,d="<c "+(d.slice(0,1)=="<"?">":"")+d,g!=null&&g.length===2){for(x=0,S=g[1],w=0;w!=S.length&&!((_=S.charCodeAt(w)-64)<1||_>26);++w)x=26*x+_;--x,C=x}else++C;for(w=0;w!=d.length&&d.charCodeAt(w)!==62;++w);if(++w,k=$e(d.slice(0,w),!0),k.r||(k.r=je({r:R-1,c:C})),S=d.slice(w),E={t:""},(g=S.match(i))!=null&&g[1]!==""&&(E.v=nt(g[1])),u.cellFormula){if((g=S.match(s))!=null&&g[1]!==""){if(E.f=nt(ut(g[1])).replace(/\r\n/g,`
`),u.xlfn||(E.f=z1(E.f)),g[0].indexOf('t="array"')>-1)E.F=(S.match(a)||[])[1],E.F.indexOf(":")>-1&&ne.push([Ze(E.F),E.F]);else if(g[0].indexOf('t="shared"')>-1){X=$e(g[0]);var he=nt(ut(g[1]));u.xlfn||(he=z1(he)),Q[parseInt(X.si,10)]=[X,he,k.r]}}else(g=S.match(/<f[^>]*\/>/))&&(X=$e(g[0]),Q[X.si]&&(E.f=G3(Q[X.si][1],Q[X.si][2],k.r)));var ve=Tt(k.r);for(w=0;w<ne.length;++w)ve.r>=ne[w][0].s.r&&ve.r<=ne[w][0].e.r&&ve.c>=ne[w][0].s.c&&ve.c<=ne[w][0].e.c&&(E.F=ne[w][1])}if(k.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(b)E.t="z";else continue;else E.t=k.t||"n";switch(f.s.c>C&&(f.s.c=C),f.e.c<C&&(f.e.c=C),E.t){case"n":if(E.v==""||E.v==null){if(!b)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!b)continue;E.t="z"}else N=Ao[parseInt(E.v,10)],E.v=N.t,E.r=N.r,u.cellHTML&&(E.h=N.h);break;case"str":E.t="s",E.v=E.v!=null?ut(E.v):"",u.cellHTML&&(E.h=Dd(E.v));break;case"inlineStr":g=S.match(n),E.t="s",g!=null&&(N=Zd(g[1]))?(E.v=N.t,u.cellHTML&&(E.h=N.h)):E.v="";break;case"b":E.v=mt(E.v);break;case"d":u.cellDates?E.v=xt(E.v,1):(E.v=qt(xt(E.v,1)),E.t="n");break;case"e":(!u||u.cellText!==!1)&&(E.w=E.v),E.v=$w[E.v];break}if(A=V=0,K=null,T&&k.s!==void 0&&(K=h.CellXf[k.s],K!=null&&(K.numFmtId!=null&&(A=K.numFmtId),u.cellStyles&&K.fillId!=null&&(V=K.fillId))),Uy(E,A,V,u,p,h),u.cellDates&&T&&E.t=="n"&&Pi(Le[A])&&(E.t="d",E.v=Hu(E.v)),k.cm&&u.xlmeta){var ie=(u.xlmeta.Cell||[])[+k.cm-1];ie&&ie.type=="XLDAPR"&&(E.D=!0)}if(oe){var O=Tt(k.r);c[O.r]||(c[O.r]=[]),c[O.r][O.c]=E}else c[k.r]=E}}}}j.length>0&&(c["!rows"]=j)}}();function JP(e,t,r,n){var a=[],i=[],s=Ze(e["!ref"]),o="",l,c="",u=[],f=0,p=0,h=e["!rows"],m=Array.isArray(e),d={r:c},v,g=-1;for(p=s.s.c;p<=s.e.c;++p)u[p]=vt(p);for(f=s.s.r;f<=s.e.r;++f){for(i=[],c=Rt(f),p=s.s.c;p<=s.e.c;++p){l=u[p]+c;var x=m?(e[f]||[])[p]:e[l];x!==void 0&&(o=XP(x,l,e,t))!=null&&i.push(o)}(i.length>0||h&&h[f])&&(d={r:c},h&&h[f]&&(v=h[f],v.hidden&&(d.hidden=1),g=-1,v.hpx?g=ul(v.hpx):v.hpt&&(g=v.hpt),g>-1&&(d.ht=g,d.customHeight=1),v.level&&(d.outlineLevel=v.level)),a[a.length]=be("row",i.join(""),d))}if(h)for(;f<h.length;++f)h&&h[f]&&(d={r:f+1},v=h[f],v.hidden&&(d.hidden=1),g=-1,v.hpx?g=ul(v.hpx):v.hpt&&(g=v.hpt),g>-1&&(d.ht=g,d.customHeight=1),v.level&&(d.outlineLevel=v.level),a[a.length]=be("row","",d));return a.join("")}function jy(e,t,r,n){var a=[Bt,be("worksheet",null,{xmlns:Ri[0],"xmlns:r":Vt.r})],i=r.SheetNames[e],s=0,o="",l=r.Sheets[i];l==null&&(l={});var c=l["!ref"]||"A1",u=Ze(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Ve(u)}n||(n={}),l["!comments"]=[];var f=[];DP(l,r,e,t,a),a[a.length]=be("dimension",null,{ref:c}),a[a.length]=KP(l,t,e,r),t.sheetFormat&&(a[a.length]=be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=WP(l,l["!cols"])),a[s=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=JP(l,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),l["!protect"]&&(a[a.length]=UP(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=VP(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=IP(l["!merges"]));var p=-1,h,m=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(d){d[1].Target&&(h={ref:d[0]},d[1].Target.charAt(0)!="#"&&(m=ot(n,-1,lt(d[1].Target).replace(/#.*$/,""),Xe.HLINK),h["r:id"]="rId"+m),(p=d[1].Target.indexOf("#"))>-1&&(h.location=lt(d[1].Target.slice(p+1))),d[1].Tooltip&&(h.tooltip=lt(d[1].Tooltip)),a[a.length]=be("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=$P(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=sr("ignoredErrors",be("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(m=ot(n,-1,"../drawings/drawing"+(e+1)+".xml",Xe.DRAW),a[a.length]=be("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=f),l["!comments"].length>0&&(m=ot(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Xe.VML),a[a.length]=be("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function QP(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function ZP(e,t,r){var n=me(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=ul(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,p=-1,h=u<<10;h<u+1<<10;++h){c.c=h;var m=Array.isArray(r)?(r[c.r]||[])[c.c]:r[je(c)];m&&(f<0&&(f=h),p=h)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,p))}var d=n.l;return n.l=l,n.write_shift(4,o),n.l=d,n.length>n.l?n.slice(0,n.l):n}function e8(e,t,r,n){var a=ZP(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&ye(e,0,a)}var t8=Di,r8=Hs;function n8(){}function a8(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=o4(e),r}function i8(e,t,r){r==null&&(r=me(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return fu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Lw(e,r),r.slice(0,r.l)}function s8(e){var t=dn(e);return[t]}function o8(e,t,r){return r==null&&(r=me(8)),Oi(t,r)}function l8(e){var t=Ii(e);return[t]}function c8(e,t,r){return r==null&&(r=me(4)),Ni(t,r)}function u8(e){var t=dn(e),r=e.read_shift(1);return[t,r,"b"]}function f8(e,t,r){return r==null&&(r=me(9)),Oi(t,r),r.write_shift(1,e.v?1:0),r}function h8(e){var t=Ii(e),r=e.read_shift(1);return[t,r,"b"]}function d8(e,t,r){return r==null&&(r=me(5)),Ni(t,r),r.write_shift(1,e.v?1:0),r}function p8(e){var t=dn(e),r=e.read_shift(1);return[t,r,"e"]}function m8(e,t,r){return r==null&&(r=me(9)),Oi(t,r),r.write_shift(1,e.v),r}function g8(e){var t=Ii(e),r=e.read_shift(1);return[t,r,"e"]}function v8(e,t,r){return r==null&&(r=me(8)),Ni(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function x8(e){var t=dn(e),r=e.read_shift(4);return[t,r,"s"]}function w8(e,t,r){return r==null&&(r=me(12)),Oi(t,r),r.write_shift(4,t.v),r}function y8(e){var t=Ii(e),r=e.read_shift(4);return[t,r,"s"]}function _8(e,t,r){return r==null&&(r=me(8)),Ni(t,r),r.write_shift(4,t.v),r}function k8(e){var t=dn(e),r=vr(e);return[t,r,"n"]}function S8(e,t,r){return r==null&&(r=me(16)),Oi(t,r),Ei(e.v,r),r}function $y(e){var t=Ii(e),r=vr(e);return[t,r,"n"]}function E8(e,t,r){return r==null&&(r=me(12)),Ni(t,r),Ei(e.v,r),r}function T8(e){var t=dn(e),r=Kd(e);return[t,r,"n"]}function b8(e,t,r){return r==null&&(r=me(12)),Oi(t,r),Bw(e.v,r),r}function C8(e){var t=Ii(e),r=Kd(e);return[t,r,"n"]}function A8(e,t,r){return r==null&&(r=me(8)),Ni(t,r),Bw(e.v,r),r}function F8(e){var t=dn(e),r=Vd(e);return[t,r,"is"]}function P8(e){var t=dn(e),r=wr(e);return[t,r,"str"]}function R8(e,t,r){return r==null&&(r=me(12+4*e.v.length)),Oi(t,r),Zt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function O8(e){var t=Ii(e),r=wr(e);return[t,r,"str"]}function I8(e,t,r){return r==null&&(r=me(8+4*e.v.length)),Ni(t,r),Zt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function N8(e,t,r){var n=e.l+t,a=dn(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Ku(e,n-e.l,r);s[3]=pr(o,null,a,r.supbooks,r)}else e.l=n;return s}function D8(e,t,r){var n=e.l+t,a=dn(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Ku(e,n-e.l,r);s[3]=pr(o,null,a,r.supbooks,r)}else e.l=n;return s}function L8(e,t,r){var n=e.l+t,a=dn(e);a.r=r["!row"];var i=vr(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Ku(e,n-e.l,r);s[3]=pr(o,null,a,r.supbooks,r)}else e.l=n;return s}function B8(e,t,r){var n=e.l+t,a=dn(e);a.r=r["!row"];var i=wr(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Ku(e,n-e.l,r);s[3]=pr(o,null,a,r.supbooks,r)}else e.l=n;return s}var U8=Di,M8=Hs;function j8(e,t){return t==null&&(t=me(4)),t.write_shift(4,e),t}function $8(e,t){var r=e.l+t,n=Di(e),a=Gd(e),i=wr(e),s=wr(e),o=wr(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}function z8(e,t){var r=me(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Hs({s:Tt(e[0]),e:Tt(e[0])},r),qd("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Zt(a||"",r),Zt(e[1].Tooltip||"",r),Zt("",r),r.slice(0,r.l)}function W8(){}function H8(e,t,r){var n=e.l+t,a=Uw(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=pP(e,n-e.l,r);s[1]=o}else e.l=n;return s}function V8(e,t,r){var n=e.l+t,a=Di(e),i=[a];if(r.cellFormula){var s=gP(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function G8(e,t,r){r==null&&(r=me(18));var n=Xu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var zy=["left","right","top","bottom","header","footer"];function q8(e){var t={};return zy.forEach(function(r){t[r]=vr(e)}),t}function K8(e,t){return t==null&&(t=me(6*8)),pi(e),zy.forEach(function(r){Ei(e[r],t)}),t}function X8(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Y8(e,t,r){r==null&&(r=me(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function J8(e){var t=me(24);return t.write_shift(4,4),t.write_shift(4,1),Hs(e,t),t}function Q8(e,t){return t==null&&(t=me(16*4+2)),t.write_shift(2,e.password?ep(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Z8(){}function eR(){}function tR(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,p=!1,h,m,d,v,g,x,w,_,S,E=[];o.biff=12,o["!row"]=0;var k=0,R=!1,C=[],N={},X=o.supbooks||a.supbooks||[[]];if(X.sharedf=N,X.arrayf=C,X.SheetNames=a.SheetNames||a.Sheets.map(function(oe){return oe.name}),!o.supbooks&&(o.supbooks=X,a.Names))for(var A=0;A<a.Names.length;++A)X[0][A+1]=a.Names[A];var V=[],T=[],K=!1;fl[16]={n:"BrtShortReal",f:$y};var ne;if(oa(e,function(j,ae,q){if(!p)switch(q){case 148:c=j;break;case 0:h=j,o.sheetRows&&o.sheetRows<=h.r&&(p=!0),_=Rt(v=h.r),o["!row"]=h.r,(j.hidden||j.hpt||j.level!=null)&&(j.hpt&&(j.hpx=Is(j.hpt)),T[j.r]=j);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:j[2]},j[2]){case"n":m.v=j[1];break;case"s":w=Ao[j[1]],m.v=w.t,m.r=w.r;break;case"b":m.v=!!j[1];break;case"e":m.v=j[1],o.cellText!==!1&&(m.w=la[m.v]);break;case"str":m.t="s",m.v=j[1];break;case"is":m.t="s",m.v=j[1].t;break}if((d=s.CellXf[j[0].iStyleRef])&&Uy(m,d.numFmtId,null,o,i,s),g=j[0].c==-1?g+1:j[0].c,o.dense?(l[v]||(l[v]=[]),l[v][g]=m):l[vt(g)+_]=m,o.cellFormula){for(R=!1,k=0;k<C.length;++k){var b=C[k];h.r>=b[0].s.r&&h.r<=b[0].e.r&&g>=b[0].s.c&&g<=b[0].e.c&&(m.F=Ve(b[0]),R=!0)}!R&&j.length>3&&(m.f=j[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>g&&(u.s.c=g),u.e.r<h.r&&(u.e.r=h.r),u.e.c<g&&(u.e.c=g),o.cellDates&&d&&m.t=="n"&&Pi(Le[d.numFmtId])){var H=ka(m.v);H&&(m.t="d",m.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}ne&&(ne.type=="XLDAPR"&&(m.D=!0),ne=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;m={t:"z",v:void 0},g=j[0].c==-1?g+1:j[0].c,o.dense?(l[v]||(l[v]=[]),l[v][g]=m):l[vt(g)+_]=m,u.s.r>h.r&&(u.s.r=h.r),u.s.c>g&&(u.s.c=g),u.e.r<h.r&&(u.e.r=h.r),u.e.c<g&&(u.e.c=g),ne&&(ne.type=="XLDAPR"&&(m.D=!0),ne=void 0);break;case 176:E.push(j);break;case 49:ne=((o.xlmeta||{}).Cell||[])[j-1];break;case 494:var U=n["!id"][j.relId];for(U?(j.Target=U.Target,j.loc&&(j.Target+="#"+j.loc),j.Rel=U):j.relId==""&&(j.Target="#"+j.loc),v=j.rfx.s.r;v<=j.rfx.e.r;++v)for(g=j.rfx.s.c;g<=j.rfx.e.c;++g)o.dense?(l[v]||(l[v]=[]),l[v][g]||(l[v][g]={t:"z",v:void 0}),l[v][g].l=j):(x=je({c:g,r:v}),l[x]||(l[x]={t:"z",v:void 0}),l[x].l=j);break;case 426:if(!o.cellFormula)break;C.push(j),S=o.dense?l[v][g]:l[vt(g)+_],S.f=pr(j[1],u,{r:h.r,c:g},X,o),S.F=Ve(j[0]);break;case 427:if(!o.cellFormula)break;N[je(j[0].s)]=j[1],S=o.dense?l[v][g]:l[vt(g)+_],S.f=pr(j[1],u,{r:h.r,c:g},X,o);break;case 60:if(!o.cellStyles)break;for(;j.e>=j.s;)V[j.e--]={width:j.w/256,hidden:!!(j.flags&1),level:j.level},K||(K=!0,tp(j.w/256)),Ba(V[j.e+1]);break;case 161:l["!autofilter"]={ref:Ve(j)};break;case 476:l["!margins"]=j;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),j.name&&(a.Sheets[r].CodeName=j.name),(j.above||j.left)&&(l["!outline"]={above:j.above,left:j.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),j.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ae.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+q.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ve(c||u)),o.sheetRows&&l["!ref"]){var Q=Ze(l["!ref"]);o.sheetRows<=+Q.e.r&&(Q.e.r=o.sheetRows-1,Q.e.r>u.e.r&&(Q.e.r=u.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>u.e.c&&(Q.e.c=u.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ve(Q))}return E.length>0&&(l["!merges"]=E),V.length>0&&(l["!cols"]=V),T.length>0&&(l["!rows"]=T),l}function rR(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=ft(t),t.z=t.z||Le[14],t.v=qt(xt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Ga(a.cellXfs,t,a),t.l&&i["!links"].push([je(l),t.l]),t.c&&i["!comments"].push([je(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=sp(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?ye(e,18,_8(t,l)):ye(e,7,w8(t,l))):(l.t="str",s?ye(e,17,I8(t,l)):ye(e,6,R8(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?ye(e,13,A8(t,l)):ye(e,2,b8(t,l)):s?ye(e,16,E8(t,l)):ye(e,5,S8(t,l)),!0;case"b":return l.t="b",s?ye(e,15,d8(t,l)):ye(e,4,f8(t,l)),!0;case"e":return l.t="e",s?ye(e,14,v8(t,l)):ye(e,3,m8(t,l)),!0}return s?ye(e,12,c8(t,l)):ye(e,1,o8(t,l)),!0}function nR(e,t,r,n){var a=Ze(t["!ref"]||"A1"),i,s="",o=[];ye(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=c;++u){s=Rt(u),e8(e,t,a,u);var f=!1;if(u<=a.e.r)for(var p=a.s.c;p<=a.e.c;++p){u===a.s.r&&(o[p]=vt(p)),i=o[p]+s;var h=l?(t[u]||[])[p]:t[i];if(!h){f=!1;continue}f=rR(e,h,u,p,n,t,f)}}ye(e,146)}function aR(e,t){!t||!t["!merges"]||(ye(e,177,j8(t["!merges"].length)),t["!merges"].forEach(function(r){ye(e,176,M8(r))}),ye(e,178))}function iR(e,t){!t||!t["!cols"]||(ye(e,390),t["!cols"].forEach(function(r,n){r&&ye(e,60,G8(n,r))}),ye(e,391))}function sR(e,t){!t||!t["!ref"]||(ye(e,648),ye(e,649,J8(Ze(t["!ref"]))),ye(e,650))}function oR(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=ot(r,-1,n[1].Target.replace(/#.*$/,""),Xe.HLINK);ye(e,494,z8(n,a))}}),delete t["!links"]}function lR(e,t,r,n){if(t["!comments"].length>0){var a=ot(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Xe.VML);ye(e,551,qd("rId"+a)),t["!legacy"]=a}}function cR(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Ve(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Cr(i);o.s.r==o.e.r&&(o.e.r=Cr(t["!ref"]).e.r,i=Ve(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ye(e,161,Hs(Ze(i))),ye(e,162)}}function uR(e,t,r){ye(e,133),ye(e,137,Y8(t,r)),ye(e,138),ye(e,134)}function fR(e,t){t["!protect"]&&ye(e,535,Q8(t["!protect"]))}function hR(e,t,r,n){var a=Lr(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=Ze(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],ye(a,129),(r.vbaraw||s["!outline"])&&ye(a,147,i8(o,s["!outline"])),ye(a,148,r8(l)),uR(a,s,r.Workbook),iR(a,s),nR(a,s,e,t),fR(a,s),cR(a,s,r,e),aR(a,s),oR(a,s,n),s["!margins"]&&ye(a,476,K8(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&sR(a,s),lR(a,s,e,n),ye(a,130),a.end()}function dR(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function pR(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=dR(f);u.s.r=u.s.c=0,u.e.c=o,c=vt(o),p[0].forEach(function(h,m){s[c+Rt(m)]={t:"n",v:h,z:p[1]},l=m}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=Ve(u)),s}function mR(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(My);return o&&op(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function gR(e,t){e.l+=10;var r=wr(e);return{name:r}}function vR(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return oa(e,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var lp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],xR=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],wR=[],yR=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function q1(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=mt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function K1(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=mt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Wy(e){K1(e.WBProps,lp),K1(e.CalcPr,yR),q1(e.WBView,xR),q1(e.Sheets,wR),ks.date1904=mt(e.WBProps.date1904)}function _R(e){return!e.Workbook||!e.Workbook.WBProps?"false":mt(e.Workbook.WBProps.date1904)?"true":"false"}var kR="][*?/\\".split("");function Hy(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return kR.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function SR(e,t,r){e.forEach(function(n,a){Hy(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function Vy(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];SR(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)_P(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var ER=/<\w+:workbook/;function TR(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(kr,function(l,c){var u=$e(l);switch($n(u[0])){case"<?xml":break;case"<workbook":l.match(ER)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":lp.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=mt(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=ut(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=nt(ut(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=ut(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),mt(u.hidden||"0")&&(i.Hidden=!0),s=c+l.length;break;case"</definedName>":i.Ref=nt(ut(e.slice(s,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Ri.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Wy(r),r}function Gy(e){var t=[Bt];t[t.length]=be("workbook",null,{xmlns:Ri[0],"xmlns:r":Vt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(lp.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=be("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:lt(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=be("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=be("definedName",lt(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function bR(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ih(e),r.name=wr(e),r}function CR(e,t){return t||(t=me(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),qd(e.strRelID,t),Zt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function AR(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?wr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function FR(e,t){t||(t=me(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Lw(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function PR(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function RR(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=l4(e),s=mP(e,0,r),o=Gd(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function OR(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],fl[16]={n:"BrtFRTArchID$",f:PR},oa(e,function(l,c,u){switch(u){case 156:s.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=pr(l.Ptg,null,null,s,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),Wy(r),r.Names=i,r.supbooks=s,r}function IR(e,t){ye(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ye(e,156,CR(a))}ye(e,144)}function NR(e,t){t||(t=me(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Zt("SheetJS",t),Zt(el.version,t),Zt(el.version,t),Zt("7262",t),t.length>t.l?t.slice(0,t.l):t}function DR(e,t){t||(t=me(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function LR(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(ye(e,135),ye(e,158,DR(a)),ye(e,136))}}function BR(e,t){var r=Lr();return ye(r,131),ye(r,128,NR()),ye(r,153,FR(e.Workbook&&e.Workbook.WBProps||null)),LR(r,e),IR(r,e),ye(r,132),r.end()}function UR(e,t,r){return t.slice(-4)===".bin"?OR(e,r):TR(e,r)}function MR(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?tR(e,n,r,a,i,s,o):OP(e,n,r,a,i,s,o)}function jR(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?vR(e,n,r,a,i):mR(e,n,r,a,i)}function $R(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?H3():V3()}function zR(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?z3():W3()}function WR(e,t,r,n){return t.slice(-4)===".bin"?MA(e,r,n):CA(e,r,n)}function HR(e,t,r){return Ty(e,r)}function VR(e,t,r){return t.slice(-4)===".bin"?GC(e,r):WC(e,r)}function GR(e,t,r){return t.slice(-4)===".bin"?B3(e,r):A3(e,r)}function qR(e,t,r){return t.slice(-4)===".bin"?T3(e):S3(e)}function KR(e,t,r,n){return r.slice(-4)===".bin"?b3(e,t,r,n):void 0}function XR(e,t,r){return t.slice(-4)===".bin"?y3(e,t,r):k3(e,t,r)}function YR(e,t,r){return(t.slice(-4)===".bin"?BR:Gy)(e)}function JR(e,t,r,n,a){return(t.slice(-4)===".bin"?hR:jy)(e,r,n,a)}function QR(e,t,r){return(t.slice(-4)===".bin"?XA:Sy)(e,r)}function ZR(e,t,r){return(t.slice(-4)===".bin"?XC:my)(e,r)}function eO(e,t,r){return(t.slice(-4)===".bin"?U3:Ay)(e)}function tO(e){return(e.slice(-4)===".bin"?_3:by)()}var qy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ky=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function gn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(qy),i,s,o,l;if(a)for(l=0;l!=a.length;++l)i=a[l].match(Ky),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function rO(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(qy),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(Ky),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Po;function nO(e,t){var r=Po[e]||nt(e);return r==="General"?ki(t):Kr(r,t)}function aO(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=mt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=xt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[nt(t)]=a}function iO(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||la[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=rl(e.v):e.w=ki(e.v):e.w=nO(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Po[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Pi(n)){var a=ka(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function sO(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=wA[n.Pattern]||n.Pattern)}e[t.ID]=t}function oO(e,t,r,n,a,i,s,o,l,c){var u="General",f=n.StyleID,p={};c=c||{};var h=[],m=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&s&&(f=s.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&h.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=mt(e);break;case"String":n.t="s",n.r=f1(nt(e)),n.v=e.indexOf("<")>-1?nt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(xt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=nt(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=$w[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=f1(t||e));break}if(iO(n,u,c),c.cellFormula!==!1)if(n.Formula){var d=nt(n.Formula);d.charCodeAt(0)==61&&(d=d.slice(1)),n.f=_s(d,a),delete n.Formula,n.ArrayRange=="RC"?n.F=_s("RC:RC",a):n.ArrayRange&&(n.F=_s(n.ArrayRange,a),l.push([Ze(n.F),n.F]))}else for(m=0;m<l.length;++m)a.r>=l[m][0].s.r&&a.r<=l[m][0].e.r&&a.c>=l[m][0].s.c&&a.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(h.forEach(function(v){!p.patternType&&v.patternType&&(p.patternType=v.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function lO(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function zf(e,t){var r=t||{};$s();var n=us(Ld(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof tt<"u"?n=tt.utils.decode(65001,au(n)):n=ut(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=ft(r);return s.type="string",Os.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(I){a.indexOf("<"+I)>=0&&(i=!0)}),i)return HO(n,r);Po={"General Number":"General","General Date":Le[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Le[15],"Short Date":Le[14],"Long Time":Le[19],"Medium Time":Le[18],"Short Time":Le[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Le[2],Standard:Le[4],Percent:Le[10],Scientific:Le[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],p=r.dense?[]:{},h="",m={},d={},v=gn('<Data ss:Type="String">'),g=0,x=0,w=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},E={},k="",R=0,C=[],N={},X={},A=0,V=[],T=[],K={},ne=[],Q,oe=!1,j=[],ae=[],q={},b=0,H=0,U={Sheets:[],WBProps:{date1904:!1}},B={};il.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";o=il.exec(n);)switch(o[3]=(ee=o[3]).toLowerCase()){case"data":if(ee=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?oO(n.slice(g,o.index),k,v,l[l.length-1][0]=="comment"?K:m,{c:x,r:w},S,ne[x],d,j,r):(k="",v=gn(o[0]),g=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(T.length>0&&(m.c=T),(!r.sheetRows||r.sheetRows>w)&&m.v!==void 0&&(r.dense?(p[w]||(p[w]=[]),p[w][x]=m):p[vt(x)+Rt(w)]=m),m.HRef&&(m.l={Target:nt(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(b=x+(parseInt(m.MergeAcross,10)|0),H=w+(parseInt(m.MergeDown,10)|0),C.push({s:{c:x,r:w},e:{c:b,r:H}})),!r.sheetStubs)m.MergeAcross?x=b+1:++x;else if(m.MergeAcross||m.MergeDown){for(var xe=x;xe<=b;++xe)for(var de=w;de<=H;++de)(xe>x||de>w)&&(r.dense?(p[de]||(p[de]=[]),p[de][xe]={t:"z"}):p[vt(xe)+Rt(de)]={t:"z"});x=b+1}else++x;else m=rO(o[0]),m.Index&&(x=+m.Index-1),x<_.s.c&&(_.s.c=x),x>_.e.c&&(_.e.c=x),o[0].slice(-2)==="/>"&&++x,T=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<_.s.r&&(_.s.r=w),w>_.e.r&&(_.e.r=w),o[0].slice(-2)==="/>"&&(d=gn(o[0]),d.Index&&(w=+d.Index-1)),x=0,++w):(d=gn(o[0]),d.Index&&(w=+d.Index-1),q={},(d.AutoFitHeight=="0"||d.Height)&&(q.hpx=parseInt(d.Height,10),q.hpt=ul(q.hpx),ae[w]=q),d.Hidden=="1"&&(q.hidden=!0,ae[w]=q));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(h),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(p["!ref"]=Ve(_),r.sheetRows&&r.sheetRows<=_.e.r&&(p["!fullref"]=p["!ref"],_.e.r=r.sheetRows-1,p["!ref"]=Ve(_))),C.length&&(p["!merges"]=C),ne.length>0&&(p["!cols"]=ne),ae.length>0&&(p["!rows"]=ae),u[h]=p}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=x=0,l.push([o[3],!1]),c=gn(o[0]),h=nt(c.Name),p=r.dense?[]:{},C=[],j=[],ae=[],B={name:h,Hidden:0},U.Sheets.push(B);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ne=[],oe=!1}break;case"style":o[1]==="/"?sO(S,E,r):E=gn(o[0]);break;case"numberformat":E.nf=nt(gn(o[0]).Format||"General"),Po[E.nf]&&(E.nf=Po[E.nf]);for(var he=0;he!=392&&Le[he]!=E.nf;++he);if(he==392){for(he=57;he!=392;++he)if(Le[he]==null){Mn(E.nf,he);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Q=gn(o[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!oe&&Q.wpx>10){oe=!0,gr=_y;for(var ve=0;ve<ne.length;++ve)ne[ve]&&Ba(ne[ve])}oe&&Ba(Q),ne[Q.Index-1||ne.length]=Q;for(var ie=0;ie<+Q.Span;++ie)ne[ne.length]=ft(Q);break;case"namedrange":if(o[1]==="/")break;U.Names||(U.Names=[]);var O=$e(o[0]),we={Name:O.Name,Ref:_s(O.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(we.Sheet=U.Sheets.length-1),U.Names.push(we);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(R,o.index):R=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=gn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?I4(N,ee,n.slice(A,o.index)):A=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));lO(K),T.push(K)}else l.push([o[3],!1]),c=gn(o[0]),K={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var y=gn(o[0]);p["!autofilter"]={ref:_s(y.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Z1(n,r);var Z=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Z=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Z=!1}break;case"excelworkbook":switch(o[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Z=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Z=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(A,o.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else A=o.index+o[0].length;break;case"header":p["!margins"]||pi(p["!margins"]={},"xlml"),isNaN(+$e(o[0]).Margin)||(p["!margins"].header=+$e(o[0]).Margin);break;case"footer":p["!margins"]||pi(p["!margins"]={},"xlml"),isNaN(+$e(o[0]).Margin)||(p["!margins"].footer=+$e(o[0]).Margin);break;case"pagemargins":var J=$e(o[0]);p["!margins"]||pi(p["!margins"]={},"xlml"),isNaN(+J.Top)||(p["!margins"].top=+J.Top),isNaN(+J.Left)||(p["!margins"].left=+J.Left),isNaN(+J.Right)||(p["!margins"].right=+J.Right),isNaN(+J.Bottom)||(p["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Z=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Z=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Z=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Z=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Z=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Z=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Z=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Z=!1}break;case"smarttags":break;default:Z=!1;break}if(Z||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?aO(X,ee,V,n.slice(A,o.index)):(V=o,A=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var P={};return!r.bookSheets&&!r.bookProps&&(P.Sheets=u),P.SheetNames=f,P.Workbook=U,P.SSF=ft(Le),P.Props=N,P.Custprops=X,P}function hh(e,t){switch(fp(t=t||{}),t.type||"base64"){case"base64":return zf(qr(e),t);case"binary":case"buffer":case"file":return zf(e,t);case"array":return zf(Ha(e),t)}}function cO(e,t){var r=[];return e.Props&&r.push(N4(e.Props,t)),e.Custprops&&r.push(D4(e.Props,e.Custprops)),r.join("")}function uO(){return""}function fO(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(be("NumberFormat",null,{"ss:Format":lt(Le[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(be("Style",i.join(""),s))}),be("Styles",r.join(""))}function Xy(e){return be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ap(e.Ref,{r:0,c:0})})}function hO(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(Xy(a)))}return be("Names",r.join(""))}function dO(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(Xy(o)))}return i.join("")}function pO(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(be("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(sr("ProtectContents","True")),e["!protect"].objects&&a.push(sr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(sr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(sr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(sr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":be("WorksheetOptions",a.join(""),{xmlns:Mr.x})}function mO(e){return e.map(function(t){var r=BT(t.t||""),n=be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return be("Comment",n,{"ss:Author":t.a})}).join("")}function gO(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+lt(ap(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=Tt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=lt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=lt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=s.c||c[u].s.r!=s.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var f="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",p=String(e.v);break;case"b":f="Boolean",p=e.v?"1":"0";break;case"e":f="Error",p=la[e.v];break;case"d":f="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Le[14]);break;case"s":f="String",p=LT(e.v||"");break}var h=Ga(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=s.c+1;var m=e.v!=null?p:"",d=e.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(e.c||[]).length>0&&(d+=mO(e.c)),be("Cell",d,o)}function vO(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Is(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function xO(e,t,r,n){if(!e["!ref"])return"";var a=Ze(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(v,g){Ba(v);var x=!!v.width,w=Xu(g,v),_={"ss:Index":g+1};x&&(_["ss:Width"]=ll(w.width)),v.hidden&&(_["ss:Hidden"]="1"),o.push(be("Column",null,_))});for(var l=Array.isArray(e),c=a.s.r;c<=a.e.r;++c){for(var u=[vO(c,(e["!rows"]||[])[c])],f=a.s.c;f<=a.e.c;++f){var p=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>f)&&!(i[s].s.r>c)&&!(i[s].e.c<f)&&!(i[s].e.r<c)){(i[s].s.c!=f||i[s].s.r!=c)&&(p=!0);break}if(!p){var h={r:c,c:f},m=je(h),d=l?(e[c]||[])[f]:e[m];u.push(gO(d,m,e,t,r,n,h))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function wO(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?dO(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?xO(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(pO(i,t,e,r)),n.join("")}function yO(e,t){t||(t={}),e.SSF||(e.SSF=ft(Le)),e.SSF&&($s(),bl(e.SSF),t.revssf=Wu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ga(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(cO(e,t)),r.push(uO()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(be("Worksheet",wO(n,t,e),{"ss:Name":lt(e.SheetNames[n])}));return r[2]=fO(e,t),r[3]=hO(e),Bt+be("Workbook",r.join(""),{xmlns:Mr.ss,"xmlns:o":Mr.o,"xmlns:x":Mr.x,"xmlns:ss":Mr.ss,"xmlns:dt":Mr.dt,"xmlns:html":Mr.html})}function _O(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=d4(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=p4(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var kO=[60,1084,2066,2165,2175];function SO(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var l=Yn(r,r.l),c=dh[l],u=0;c!=null&&kO.indexOf(l)>-1;)i=Yn(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),s.push(o),r.l+=4+i,c=dh[l=Yn(r,r.l)];var f=Qt(s);ir(f,0);var p=0;f.lens=[];for(var h=0;h<s.length;++h)f.lens.push(p),p+=s[h].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function Pn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Le[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||la[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=rl(e.v):e.w=ki(e.v):e.w=Kr(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Pi(Le[n]||String(n))){var a=ka(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function hc(e,t,r){return{v:e,ixfe:t,t:r}}function EO(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,l=[],c="",u={},f,p="",h,m,d,v,g={},x=[],w,_,S=[],E=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},C=function(We){return We<8?fi[We]:We<64&&E[We-8]||fi[We]},N=function(We,at,Kt){var Ge=at.XF.data;if(!(!Ge||!Ge.patternType||!Kt||!Kt.cellStyles)){at.s={},at.s.patternType=Ge.patternType;var Jr;(Jr=ol(C(Ge.icvFore)))&&(at.s.fgColor={rgb:Jr}),(Jr=ol(C(Ge.icvBack)))&&(at.s.bgColor={rgb:Jr})}},X=function(We,at,Kt){if(!(q>1)&&!(Kt.sheetRows&&We.r>=Kt.sheetRows)){if(Kt.cellStyles&&at.XF&&at.XF.data&&N(We,at,Kt),delete at.ixfe,delete at.XF,f=We,p=je(We),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),We.r<s.s.r&&(s.s.r=We.r),We.c<s.s.c&&(s.s.c=We.c),We.r+1>s.e.r&&(s.e.r=We.r+1),We.c+1>s.e.c&&(s.e.c=We.c+1),Kt.cellFormula&&at.f){for(var Ge=0;Ge<x.length;++Ge)if(!(x[Ge][0].s.c>We.c||x[Ge][0].s.r>We.r)&&!(x[Ge][0].e.c<We.c||x[Ge][0].e.r<We.r)){at.F=Ve(x[Ge][0]),(x[Ge][0].s.c!=We.c||x[Ge][0].s.r!=We.r)&&delete at.f,at.f&&(at.f=""+pr(x[Ge][1],s,We,j,A));break}}Kt.dense?(a[We.r]||(a[We.r]=[]),a[We.r][We.c]=at):a[p]=at}},A={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var V,T=[],K=[],ne=[],Q=[],oe=!1,j=[];j.SheetNames=A.snames,j.sharedf=A.sharedf,j.arrayf=A.arrayf,j.names=[],j.XTI=[];var ae=0,q=0,b=0,H=[],U=[],B;A.codepage=1200,ln(1200);for(var ee=!1;e.l<e.length-1;){var xe=e.l,de=e.read_shift(2);if(de===0&&ae===10)break;var he=e.l===e.length?0:e.read_shift(2),ve=dh[de];if(ve&&ve.f){if(t.bookSheets&&ae===133&&de!==133)break;if(ae=de,ve.r===2||ve.r==12){var ie=e.read_shift(2);if(he-=2,!A.enc&&ie!==de&&((ie&255)<<8|ie>>8)!==de)throw new Error("rt mismatch: "+ie+"!="+de);ve.r==12&&(e.l+=10,he-=10)}var O={};if(de===10?O=ve.f(e,he,A):O=SO(de,ve,e,he,A),q==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(de){case 34:r.opts.Date1904=k.WBProps.date1904=O;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=O,!t.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=O;break;case 66:var we=Number(O);switch(we){case 21010:we=1200;break;case 32768:we=1e4;break;case 32769:we=1252;break}ln(A.codepage=we),ee=!0;break;case 317:A.rrtabid=O;break;case 25:A.winlocked=O;break;case 439:r.opts.RefreshAll=O;break;case 12:r.opts.CalcCount=O;break;case 16:r.opts.CalcDelta=O;break;case 17:r.opts.CalcIter=O;break;case 13:r.opts.CalcMode=O;break;case 14:r.opts.CalcPrecision=O;break;case 95:r.opts.CalcSaveRecalc=O;break;case 15:A.CalcRefMode=O;break;case 2211:r.opts.FullCalc=O;break;case 129:O.fDialog&&(a["!type"]="dialog"),O.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),O.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:S.push(O);break;case 430:j.push([O]),j[j.length-1].XTI=[];break;case 35:case 547:j[j.length-1].push(O);break;case 24:case 536:B={Name:O.Name,Ref:pr(O.rgce,s,null,j,A)},O.itab>0&&(B.Sheet=O.itab-1),j.names.push(B),j[0]||(j[0]=[],j[0].XTI=[]),j[j.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(U[O.itab-1]={ref:Ve(O.rgce[0][0][1][2])});break;case 22:A.ExternCount=O;break;case 23:j.length==0&&(j[0]=[],j[0].XTI=[]),j[j.length-1].XTI=j[j.length-1].XTI.concat(O),j.XTI=j.XTI.concat(O);break;case 2196:if(A.biff<8)break;B!=null&&(B.Comment=O[1]);break;case 18:a["!protect"]=O;break;case 19:O!==0&&A.WTF&&console.error("Password verifier: "+O);break;case 133:i[O.pos]=O,A.snames.push(O.name);break;case 10:{if(--q)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Ve(s),t.sheetRows&&t.sheetRows<=s.e.r){var y=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ve(s),s.e.r=y}s.e.r++,s.e.c++}T.length>0&&(a["!merges"]=T),K.length>0&&(a["!objects"]=K),ne.length>0&&(a["!cols"]=ne),Q.length>0&&(a["!rows"]=Q),k.Sheets.push(R)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),A.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(A.biff=5,ee=!0,ln(A.codepage=28591)),A.biff==8&&O.BIFFVer==0&&O.dt==16&&(A.biff=2),q++)break;if(a=t.dense?[]:{},A.biff<8&&!ee&&(ee=!0,ln(A.codepage=t.codepage||1252)),A.biff<5||O.BIFFVer==0&&O.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Z={pos:e.l-he,name:c};i[Z.pos]=Z,A.snames.push(c)}else c=(i[xe]||{name:""}).name;O.dt==32&&(a["!type"]="chart"),O.dt==64&&(a["!type"]="macro"),T=[],K=[],A.arrayf=x=[],ne=[],Q=[],oe=!1,R={Hidden:(i[xe]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[O.r]||[])[O.c]:a[je({c:O.c,r:O.r})])&&++O.c,w={ixfe:O.ixfe,XF:S[O.ixfe]||{},v:O.val,t:"n"},b>0&&(w.z=H[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),X({c:O.c,r:O.r},w,t);break;case 5:case 517:w={ixfe:O.ixfe,XF:S[O.ixfe],v:O.val,t:O.t},b>0&&(w.z=H[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),X({c:O.c,r:O.r},w,t);break;case 638:w={ixfe:O.ixfe,XF:S[O.ixfe],v:O.rknum,t:"n"},b>0&&(w.z=H[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),X({c:O.c,r:O.r},w,t);break;case 189:for(var J=O.c;J<=O.C;++J){var P=O.rkrec[J-O.c][0];w={ixfe:P,XF:S[P],v:O.rkrec[J-O.c][1],t:"n"},b>0&&(w.z=H[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),X({c:J,r:O.r},w,t)}break;case 6:case 518:case 1030:{if(O.val=="String"){o=O;break}if(w=hc(O.val,O.cell.ixfe,O.tt),w.XF=S[w.ixfe],t.cellFormula){var I=O.formula;if(I&&I[0]&&I[0][0]&&I[0][0][0]=="PtgExp"){var Y=I[0][0][1][0],ue=I[0][0][1][1],pe=je({r:Y,c:ue});g[pe]?w.f=""+pr(O.formula,s,O.cell,j,A):w.F=((t.dense?(a[Y]||[])[ue]:a[pe])||{}).F}else w.f=""+pr(O.formula,s,O.cell,j,A)}b>0&&(w.z=H[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),X(O.cell,w,t),o=O}break;case 7:case 519:if(o)o.val=O,w=hc(O,o.cell.ixfe,"s"),w.XF=S[w.ixfe],t.cellFormula&&(w.f=""+pr(o.formula,s,o.cell,j,A)),b>0&&(w.z=H[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),X(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{x.push(O);var te=je(O[0].s);if(h=t.dense?(a[O[0].s.r]||[])[O[0].s.c]:a[te],t.cellFormula&&h){if(!o||!te||!h)break;h.f=""+pr(O[1],s,O[0],j,A),h.F=Ve(O[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!o)break;g[je(o.cell)]=O[0],h=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[je(o.cell)],(h||{}).f=""+pr(O[0],s,f,j,A)}}break;case 253:w=hc(l[O.isst].t,O.ixfe,"s"),l[O.isst].h&&(w.h=l[O.isst].h),w.XF=S[w.ixfe],b>0&&(w.z=H[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),X({c:O.c,r:O.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:O.ixfe,XF:S[O.ixfe],t:"z"},b>0&&(w.z=H[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),X({c:O.c,r:O.r},w,t));break;case 190:if(t.sheetStubs)for(var _e=O.c;_e<=O.C;++_e){var Ae=O.ixfe[_e-O.c];w={ixfe:Ae,XF:S[Ae],t:"z"},b>0&&(w.z=H[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),X({c:_e,r:O.r},w,t)}break;case 214:case 516:case 4:w=hc(O.val,O.ixfe,"s"),w.XF=S[w.ixfe],b>0&&(w.z=H[w.ixfe>>8&63]),Pn(w,t,r.opts.Date1904),X({c:O.c,r:O.r},w,t);break;case 0:case 512:q===1&&(s=O);break;case 252:l=O;break;case 1054:if(A.biff==4){H[b++]=O[1];for(var ke=0;ke<b+163&&Le[ke]!=O[1];++ke);ke>=163&&Mn(O[1],b+163)}else Mn(O[1],O[0]);break;case 30:{H[b++]=O;for(var Re=0;Re<b+163&&Le[Re]!=O;++Re);Re>=163&&Mn(O,b+163)}break;case 229:T=T.concat(O);break;case 93:K[O.cmo[0]]=A.lastobj=O;break;case 438:A.lastobj.TxO=O;break;case 127:A.lastobj.ImData=O;break;case 440:for(v=O[0].s.r;v<=O[0].e.r;++v)for(d=O[0].s.c;d<=O[0].e.c;++d)h=t.dense?(a[v]||[])[d]:a[je({c:d,r:v})],h&&(h.l=O[1]);break;case 2048:for(v=O[0].s.r;v<=O[0].e.r;++v)for(d=O[0].s.c;d<=O[0].e.c;++d)h=t.dense?(a[v]||[])[d]:a[je({c:d,r:v})],h&&h.l&&(h.l.Tooltip=O[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;h=t.dense?(a[O[0].r]||[])[O[0].c]:a[je(O[0])];var et=K[O[2]];h||(t.dense?(a[O[0].r]||(a[O[0].r]=[]),h=a[O[0].r][O[0].c]={t:"z"}):h=a[je(O[0])]={t:"z"},s.e.r=Math.max(s.e.r,O[0].r),s.s.r=Math.min(s.s.r,O[0].r),s.e.c=Math.max(s.e.c,O[0].c),s.s.c=Math.min(s.s.c,O[0].c)),h.c||(h.c=[]),m={a:O[1],t:et.TxO.t},h.c.push(m)}break;case 2173:h3(S[O.ixfe],O.ext);break;case 125:{if(!A.cellStyles)break;for(;O.e>=O.s;)ne[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},oe||(oe=!0,tp(O.w/256)),Ba(ne[O.e+1])}break;case 520:{var Be={};O.level!=null&&(Q[O.r]=Be,Be.level=O.level),O.hidden&&(Q[O.r]=Be,Be.hidden=!0),O.hpt&&(Q[O.r]=Be,Be.hpt=O.hpt,Be.hpx=Is(O.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||pi(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=O;break;case 161:a["!margins"]||pi(a["!margins"]={}),a["!margins"].header=O.header,a["!margins"].footer=O.footer;break;case 574:O.RTL&&(k.Views[0].RTL=!0);break;case 146:E=O;break;case 2198:V=O;break;case 140:_=O;break;case 442:c?R.CodeName=O||R.name:k.WBProps.CodeName=O||"ThisWorkbook";break}}else ve||console.error("Missing Info for XLS Record 0x"+de.toString(16)),e.l+=he}return r.SheetNames=It(i).sort(function(_t,We){return Number(_t)-Number(We)}).map(function(_t){return i[_t].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&U.forEach(function(_t,We){r.Sheets[r.SheetNames[We]]["!autofilter"]=_t}),r.Strings=l,r.SSF=ft(Le),A.enc&&(r.Encryption=A.enc),V&&(r.Themes=V),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),j.names.length>0&&(k.Names=j.names),r.Workbook=k,r}var Ro={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function TO(e,t,r){var n=De.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=F1(n,sh,Ro.DSI);for(var i in a)t[i]=a[i]}catch(c){if(r.WTF)throw c}var s=De.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=F1(s,oh,Ro.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(qw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function bO(e,t){var r=[],n=[],a=[],i=0,s,o=i1(sh,"n"),l=i1(oh,"n");if(e.Props)for(s=It(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=It(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var c=[];for(i=0;i<a.length;++i)ey.indexOf(a[i][0])>-1||Gw.indexOf(a[i][0])>-1||a[i][1]!=null&&c.push(a[i]);n.length&&De.utils.cfb_add(t,"/SummaryInformation",P1(n,Ro.SI,l,oh)),(r.length||c.length)&&De.utils.cfb_add(t,"/DocumentSummaryInformation",P1(r,Ro.DSI,o,sh,c.length?c:null,Ro.UDI))}function cp(e,t){t||(t={}),fp(t),$u(),t.codepage&&ju(t.codepage);var r,n;if(e.FullPaths){if(De.find(e,"/encryption"))throw new Error("File is password-protected");r=De.find(e,"!CompObj"),n=De.find(e,"/Workbook")||De.find(e,"/Book")}else{switch(t.type){case"base64":e=jr(qr(e));break;case"binary":e=jr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ir(e,0),n={content:e}}var a,i;if(r&&_O(r),t.bookProps&&!t.bookSheets)a={};else{var s=Ke?"buffer":"array";if(n&&n.content)a=EO(n.content,t);else if((i=De.find(e,"PerfectOffice_MAIN"))&&i.content)a=di.to_workbook(i.content,(t.type=s,t));else if((i=De.find(e,"NativeContent_MAIN"))&&i.content)a=di.to_workbook(i.content,(t.type=s,t));else throw(i=De.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&De.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=j3(e))}var o={};return e.FullPaths&&TO(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function CO(e,t){var r=t||{},n=De.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return De.utils.cfb_add(n,a,Yy(e,r)),r.biff==8&&(e.Props||e.Custprops)&&bO(e,n),r.biff==8&&e.vbaraw&&$3(n,De.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var fl={0:{f:QP},1:{f:s8},2:{f:T8},3:{f:p8},4:{f:u8},5:{f:k8},6:{f:P8},7:{f:x8},8:{f:B8},9:{f:L8},10:{f:N8},11:{f:D8},12:{f:l8},13:{f:C8},14:{f:g8},15:{f:h8},16:{f:$y},17:{f:O8},18:{f:y8},19:{f:Vd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:RR},40:{},42:{},43:{f:PA},44:{f:AA},45:{f:IA},46:{f:DA},47:{f:NA},48:{},49:{f:t4},50:{},51:{f:m3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:fy},62:{f:F8},63:{f:E3},64:{f:Z8},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:_r,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:X8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:a8},148:{f:t8,p:16},151:{f:W8},152:{},153:{f:AR},154:{},155:{},156:{f:bR},157:{},158:{},159:{T:1,f:VC},160:{T:-1},161:{T:1,f:Di},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:U8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:d3},336:{T:-1},337:{f:x3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ih},357:{},358:{},359:{},360:{T:1},361:{},362:{f:uy},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:H8},427:{f:V8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:q8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:n8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:$8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ih},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:D3},633:{T:1},634:{T:-1},635:{T:1,f:I3},636:{T:-1},637:{f:i4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:gR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:eR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},dh={6:{f:jf},10:{f:fa},12:{f:jt},13:{f:jt},14:{f:Nt},15:{f:Nt},16:{f:vr},17:{f:Nt},18:{f:Nt},19:{f:jt},20:{f:L1},21:{f:L1},23:{f:uy},24:{f:U1},25:{f:Nt},26:{},27:{},28:{f:eC},29:{},34:{f:Nt},35:{f:B1},38:{f:vr},39:{f:vr},40:{f:vr},41:{f:vr},42:{f:Nt},43:{f:Nt},47:{f:hA},49:{f:Cb},51:{f:jt},60:{},61:{f:kb},64:{f:Nt},65:{f:bb},66:{f:jt},77:{},80:{},81:{},82:{},85:{f:jt},89:{},90:{},91:{},92:{f:fb},93:{f:nC},94:{},95:{f:Nt},96:{},97:{},99:{f:Nt},125:{f:fy},128:{f:zb},129:{f:db},130:{f:jt},131:{f:Nt},132:{f:Nt},133:{f:pb},134:{},140:{f:fC},141:{f:jt},144:{},146:{f:pC},151:{},152:{},153:{},154:{},155:{},156:{f:jt},157:{},158:{},160:{f:_C},161:{f:vC},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Ub},190:{f:Mb},193:{f:fa},197:{},198:{},199:{},200:{},201:{},202:{f:Nt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:jt},220:{},221:{f:Nt},222:{},224:{f:$b},225:{f:ub},226:{f:fa},227:{},229:{f:tC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:gb},253:{f:Fb},255:{f:xb},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ty},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Nt},353:{f:fa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:qb},431:{f:Nt},432:{},433:{},434:{},437:{},438:{f:sC},439:{f:Nt},440:{f:oC},441:{},442:{f:Fl},443:{},444:{f:jt},445:{},446:{},448:{f:fa},449:{f:_b,r:2},450:{f:fa},512:{f:I1},513:{f:yC},515:{f:Vb},516:{f:Rb},517:{f:D1},519:{f:kC},520:{f:wb},523:{},545:{f:M1},549:{f:O1},566:{},574:{f:Eb},638:{f:Bb},659:{},1048:{},1054:{f:Ib},1084:{},1212:{f:Jb},2048:{f:cC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:cc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:fa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:mC,r:12},2173:{f:f3,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Nt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Yb,r:12},2197:{},2198:{f:i3,r:12},2199:{},2200:{},2201:{},2202:{f:Qb,r:12},2203:{f:fa},2204:{},2205:{},2206:{},2207:{},2211:{f:yb},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:jt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:xC},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:dC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:I1},1:{},2:{f:CC},3:{f:TC},4:{f:EC},5:{f:D1},7:{f:FC},8:{},9:{f:cc},11:{},22:{f:jt},30:{f:Db},31:{},32:{},33:{f:M1},36:{},37:{f:O1},50:{f:PC},62:{},52:{},67:{},68:{f:jt},69:{},86:{},126:{},127:{f:SC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:RC},223:{},234:{},354:{},421:{},518:{f:jf},521:{f:cc},536:{f:U1},547:{f:B1},561:{},579:{},1030:{f:jf},1033:{f:cc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ce(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&zd(r)&&e.push(r)}}function AO(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Ce(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<a;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function Il(e,t,r){return e||(e=me(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function FO(e,t,r,n){var a=me(9);return Il(a,e,t),ry(r,n||"b",a),a}function PO(e,t,r){var n=me(8+2*r.length);return Il(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function RO(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?qt(xt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Ce(e,2,AC(r,n,a)):Ce(e,3,bC(r,n,a));return;case"b":case"e":Ce(e,5,FO(r,n,t.v,t.t));return;case"s":case"str":Ce(e,4,PO(r,n,(t.v||"").slice(0,255)));return}Ce(e,1,Il(null,r,n))}function OO(e,t,r,n){var a=Array.isArray(t),i=Ze(t["!ref"]||"A1"),s,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Ve(i)}for(var c=i.s.r;c<=i.e.r;++c){o=Rt(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(l[u]=vt(u)),s=l[u]+o;var f=a?(t[c]||[])[u]:t[s];f&&RO(e,f,c,u)}}}function IO(e,t){for(var r=t||{},n=Lr(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ce(n,r.biff==4?1033:r.biff==3?521:9,Qd(e,16,r)),OO(n,e.Sheets[e.SheetNames[a]],a,r),Ce(n,10),n.end()}function NO(e,t,r){Ce(e,49,Ab({sz:12,name:"Arial"},r))}function DO(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ce(e,1054,Nb(a,t[a],r))})}function LO(e,t){var r=me(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ce(e,2151,r),r=me(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),oy(Ze(t["!ref"]||"A1"),r),r.write_shift(4,4),Ce(e,2152,r)}function BO(e,t){for(var r=0;r<16;++r)Ce(e,224,N1({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ce(e,224,N1(n,0,t))})}function UO(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ce(e,440,lC(n)),n[1].Tooltip&&Ce(e,2048,uC(n))}delete t["!links"]}function MO(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Ce(e,125,gC(Xu(a,n),a))})}}function jO(e,t,r,n,a){var i=16+Ga(a.cellXfs,t,a);if(t.v==null&&!t.bf){Ce(e,513,bi(r,n,i));return}if(t.bf)Ce(e,6,dP(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?qt(xt(t.v)):t.v;Ce(e,515,Gb(r,n,s,i));break;case"b":case"e":Ce(e,517,Hb(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=sp(a.Strings,t.v,a.revStrings);Ce(e,253,Pb(r,n,o,i))}else Ce(e,516,Ob(r,n,(t.v||"").slice(0,255),i,a));break;default:Ce(e,513,bi(r,n,i))}}function $O(e,t,r){var n=Lr(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(i),c=t.biff==8,u,f="",p=[],h=Ze(i["!ref"]||"A1"),m=c?65536:16384;if(h.e.c>255||h.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Ce(n,2057,Qd(r,16,t)),Ce(n,13,nn(1)),Ce(n,12,nn(100)),Ce(n,15,Tr(!0)),Ce(n,17,Tr(!1)),Ce(n,16,Ei(.001)),Ce(n,95,Tr(!0)),Ce(n,42,Tr(!1)),Ce(n,43,Tr(!1)),Ce(n,130,nn(1)),Ce(n,128,Wb()),Ce(n,131,Tr(!1)),Ce(n,132,Tr(!1)),c&&MO(n,i["!cols"]),Ce(n,512,Lb(h,t)),c&&(i["!links"]=[]);for(var d=h.s.r;d<=h.e.r;++d){f=Rt(d);for(var v=h.s.c;v<=h.e.c;++v){d===h.s.r&&(p[v]=vt(v)),u=p[v]+f;var g=l?(i[d]||[])[v]:i[u];g&&(jO(n,g,d,v,t),c&&g.l&&i["!links"].push([u,g.l]))}}var x=o.CodeName||o.name||a;return c&&Ce(n,574,Tb((s.Views||[])[0])),c&&(i["!merges"]||[]).length&&Ce(n,229,rC(i["!merges"])),c&&UO(n,i),Ce(n,442,ny(x)),c&&LO(n,i),Ce(n,10),n.end()}function zO(e,t,r){var n=Lr(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ce(n,2057,Qd(e,5,r)),r.bookType=="xla"&&Ce(n,135),Ce(n,225,o?nn(1200):null),Ce(n,193,H4(2)),l&&Ce(n,191),l&&Ce(n,192),Ce(n,226),Ce(n,92,hb("SheetJS",r)),Ce(n,66,nn(o?1200:1252)),o&&Ce(n,353,nn(0)),o&&Ce(n,448),Ce(n,317,wC(e.SheetNames.length)),o&&e.vbaraw&&Ce(n,211),o&&e.vbaraw){var c=s.CodeName||"ThisWorkbook";Ce(n,442,ny(c))}Ce(n,156,nn(17)),Ce(n,25,Tr(!1)),Ce(n,18,Tr(!1)),Ce(n,19,nn(0)),o&&Ce(n,431,Tr(!1)),o&&Ce(n,444,nn(0)),Ce(n,61,Sb()),Ce(n,64,Tr(!1)),Ce(n,141,nn(0)),Ce(n,34,Tr(_R(e)=="true")),Ce(n,14,Tr(!0)),o&&Ce(n,439,Tr(!1)),Ce(n,218,nn(0)),NO(n,e,r),DO(n,e.SSF,r),BO(n,r),o&&Ce(n,352,Tr(!1));var u=n.end(),f=Lr();o&&Ce(f,140,hC()),o&&r.Strings&&AO(f,252,vb(r.Strings)),Ce(f,10);var p=f.end(),h=Lr(),m=0,d=0;for(d=0;d<e.SheetNames.length;++d)m+=(o?12:11)+(o?2:1)*e.SheetNames[d].length;var v=u.length+m+p.length;for(d=0;d<e.SheetNames.length;++d){var g=i[d]||{};Ce(h,133,mb({pos:v,hs:g.Hidden||0,dt:0,name:e.SheetNames[d]},r)),v+=t[d].length}var x=h.end();if(m!=x.length)throw new Error("BS8 "+m+" != "+x.length);var w=[];return u.length&&w.push(u),x.length&&w.push(x),p.length&&w.push(p),Qt(w)}function WO(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ft(Le)),e&&e.SSF&&($s(),bl(e.SSF),r.revssf=Wu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,hp(r),r.cellXfs=[],Ga(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=$O(a,r,e);return n.unshift(zO(e,n,r)),Qt(n)}function Yy(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Cr(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return WO(e,t);case 4:case 3:case 2:return IO(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function X1(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,l=AT(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,p=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<l.length;++s){var d=l[s].trim(),v=d.slice(0,3).toLowerCase();if(v=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(v!="<td"&&v!="<th")){var g=d.split(/<\/t[dh]>/i);for(o=0;o<g.length;++o){var x=g[o].trim();if(x.match(/<t[dh]/i)){for(var w=x,_=0;w.charAt(0)=="<"&&(_=w.indexOf(">"))>-1;)w=w.slice(_+1);for(var S=0;S<m.length;++S){var E=m[S];E.s.c==u&&E.s.r<c&&c<=E.e.r&&(u=E.e.c+1,S=-1)}var k=$e(x.slice(0,x.indexOf(">")));p=k.colspan?+k.colspan:1,((f=+k.rowspan)>1||p>1)&&m.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+p-1}});var R=k.t||k["data-t"]||"";if(!w.length){u+=p;continue}if(w=Ew(w),h.s.r>c&&(h.s.r=c),h.e.r<c&&(h.e.r=c),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!w.length){u+=p;continue}var C={t:"s",v:w};r.raw||!w.trim().length||R=="s"||(w==="TRUE"?C={t:"b",v:!0}:w==="FALSE"?C={t:"b",v:!1}:isNaN(bn(w))?isNaN(Rs(w).getDate())||(C={t:"d",v:xt(w)},r.cellDates||(C={t:"n",v:qt(C.v)}),C.z=r.dateNF||Le[14]):C={t:"n",v:bn(w)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=C):n[je({r:c,c:u})]=C,u+=p}}}}return n["!ref"]=Ve(h),m.length&&(n["!merges"]=m),n}function Jy(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>s)&&!(a[c].e.r<r||a[c].e.c<s)){if(a[c].s.r<r||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=je({r,c:s}),f=n.dense?(e[r]||[])[s]:e[u],p=f&&f.v!=null&&(f.h||Dd(f.w||(jn(f),f.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+u,i.push(be("td",p,h))}}var m="<tr>";return m+i.join("")+"</tr>"}var Qy='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Zy="</body></html>";function HO(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Va(X1(r[0],t),t);var n=vp();return r.forEach(function(a,i){xp(n,X1(a,t),"Sheet"+(i+1))}),n}function e_(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function t_(e,t){var r=t||{},n=r.header!=null?r.header:Qy,a=r.footer!=null?r.footer:Zy,i=[n],s=Cr(e["!ref"]);r.dense=Array.isArray(e),i.push(e_(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(Jy(e,s,o,r));return i.push("</table>"+a),i.join("")}function r_(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Tt(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=Cr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var f=[],p=0,h=e["!rows"]||(e["!rows"]=[]),m=0,d=0,v=0,g=0,x=0,w=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&d<l;++m){var _=o[m];if(Y1(_)){if(n.display)continue;h[d]={hidden:!0}}var S=_.children;for(v=g=0;v<S.length;++v){var E=S[v];if(!(n.display&&Y1(E))){var k=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):Ew(E.innerHTML),R=E.getAttribute("data-z")||E.getAttribute("z");for(p=0;p<f.length;++p){var C=f[p];C.s.c==g+i&&C.s.r<d+a&&d+a<=C.e.r&&(g=C.e.c+1-i,p=-1)}w=+E.getAttribute("colspan")||1,((x=+E.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:d+a,c:g+i},e:{r:d+a+(x||1)-1,c:g+i+(w||1)-1}});var N={t:"s",v:k},X=E.getAttribute("data-t")||E.getAttribute("t")||"";k!=null&&(k.length==0?N.t=X||"z":n.raw||k.trim().length==0||X=="s"||(k==="TRUE"?N={t:"b",v:!0}:k==="FALSE"?N={t:"b",v:!1}:isNaN(bn(k))?isNaN(Rs(k).getDate())||(N={t:"d",v:xt(k)},n.cellDates||(N={t:"n",v:qt(N.v)}),N.z=n.dateNF||Le[14]):N={t:"n",v:bn(k)})),N.z===void 0&&R!=null&&(N.z=R);var A="",V=E.getElementsByTagName("A");if(V&&V.length)for(var T=0;T<V.length&&!(V[T].hasAttribute("href")&&(A=V[T].getAttribute("href"),A.charAt(0)!="#"));++T);A&&A.charAt(0)!="#"&&(N.l={Target:A}),n.dense?(e[d+a]||(e[d+a]=[]),e[d+a][g+i]=N):e[je({c:g+i,r:d+a})]=N,c.e.c<g+i&&(c.e.c=g+i),g+=w}}++d}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,d-1+a),e["!ref"]=Ve(c),d>=l&&(e["!fullref"]=Ve((c.e.r=o.length-m+d-1+a,c))),e}function n_(e,t){var r=t||{},n=r.dense?[]:{};return r_(n,e,t)}function VO(e,t){return Va(n_(e,t),t)}function Y1(e){var t="",r=GO(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function GO(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function qO(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=nt(t.replace(/<[^>]*>/g,""));return[r]}var J1={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function a_(e,t){var r=t||{},n=Ld(e),a=[],i,s,o={name:""},l="",c=0,u,f,p={},h=[],m=r.dense?[]:{},d,v,g={value:""},x="",w=0,_=[],S=-1,E=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,C={},N=[],X={},A=0,V=0,T=[],K=1,ne=1,Q=[],oe={Names:[]},j={},ae=["",""],q=[],b={},H="",U=0,B=!1,ee=!1,xe=0;for(il.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");d=il.exec(n);)switch(d[3]=d[3].replace(/_.*$/,"")){case"table":case"":d[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?m["!ref"]=Ve(k):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(m["!fullref"]=m["!ref"],k.e.r=r.sheetRows-1,m["!ref"]=Ve(k)),N.length&&(m["!merges"]=N),T.length&&(m["!rows"]=T),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),p[u.name]=m,ee=!1):d[0].charAt(d[0].length-2)!=="/"&&(u=$e(d[0],!1),S=E=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,m=r.dense?[]:{},N=[],T=[],ee=!0);break;case"table-row-group":d[1]==="/"?--R:++R;break;case"table-row":case"":if(d[1]==="/"){S+=K,K=1;break}if(f=$e(d[0],!1),f.?S=f.-1:S==-1&&(S=0),K=+f["number-rows-repeated"]||1,K<10)for(xe=0;xe<K;++xe)R>0&&(T[S+xe]={level:R});E=-1;break;case"covered-table-cell":d[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(m[S]||(m[S]=[]),m[S][E]={t:"z"}):m[je({r:S,c:E})]={t:"z"}),x="",_=[];break;case"table-cell":case"":if(d[0].charAt(d[0].length-2)==="/")++E,g=$e(d[0],!1),ne=parseInt(g["number-columns-repeated"]||"1",10),v={t:"z",v:null},g.formula&&r.cellFormula!=!1&&(v.f=G1(nt(g.formula))),(g.||g["value-type"])=="string"&&(v.t="s",v.v=nt(g["string-value"]||""),r.dense?(m[S]||(m[S]=[]),m[S][E]=v):m[je({r:S,c:E})]=v),E+=ne-1;else if(d[1]!=="/"){++E,x="",w=0,_=[],ne=1;var de=K?S+K-1:S;if(E>k.e.c&&(k.e.c=E),E<k.s.c&&(k.s.c=E),S<k.s.r&&(k.s.r=S),de>k.e.r&&(k.e.r=de),g=$e(d[0],!1),q=[],b={},v={t:g.||g["value-type"],v:null},r.cellFormula)if(g.formula&&(g.formula=nt(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(A=parseInt(g["number-matrix-rows-spanned"],10)||0,V=parseInt(g["number-matrix-columns-spanned"],10)||0,X={s:{r:S,c:E},e:{r:S+A-1,c:E+V-1}},v.F=Ve(X),Q.push([X,v.F])),g.formula)v.f=G1(g.formula);else for(xe=0;xe<Q.length;++xe)S>=Q[xe][0].s.r&&S<=Q[xe][0].e.r&&E>=Q[xe][0].s.c&&E<=Q[xe][0].e.c&&(v.F=Q[xe][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(A=parseInt(g["number-rows-spanned"],10)||0,V=parseInt(g["number-columns-spanned"],10)||0,X={s:{r:S,c:E},e:{r:S+A-1,c:E+V-1}},N.push(X)),g["number-columns-repeated"]&&(ne=parseInt(g["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=mt(g["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(g.value);break;case"percentage":v.t="n",v.v=parseFloat(g.value);break;case"currency":v.t="n",v.v=parseFloat(g.value);break;case"date":v.t="d",v.v=xt(g["date-value"]),r.cellDates||(v.t="n",v.v=qt(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=TT(g["time-value"])/86400,r.cellDates&&(v.t="d",v.v=Hu(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(g.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",g["string-value"]!=null&&(x=nt(g["string-value"]),_=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(B=!1,v.t==="s"&&(v.v=x||"",_.length&&(v.R=_),B=w==0),j.Target&&(v.l=j),q.length>0&&(v.c=q,q=[]),x&&r.cellText!==!1&&(v.w=x),B&&(v.t="z",delete v.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var he=0;he<K;++he){if(ne=parseInt(g["number-columns-repeated"]||"1",10),r.dense)for(m[S+he]||(m[S+he]=[]),m[S+he][E]=he==0?v:ft(v);--ne>0;)m[S+he][E+ne]=ft(v);else for(m[je({r:S+he,c:E})]=v;--ne>0;)m[je({r:S+he,c:E+ne})]=ft(v);k.e.c<=E&&(k.e.c=E)}ne=parseInt(g["number-columns-repeated"]||"1",10),E+=ne-1,ne=0,v={},x="",_=[]}j={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(d[1]==="/"){if((i=a.pop())[0]!==d[3])throw"Bad state: "+i}else d[0].charAt(d[0].length-2)!=="/"&&a.push([d[3],!0]);break;case"annotation":if(d[1]==="/"){if((i=a.pop())[0]!==d[3])throw"Bad state: "+i;b.t=x,_.length&&(b.R=_),b.a=H,q.push(b)}else d[0].charAt(d[0].length-2)!=="/"&&a.push([d[3],!1]);H="",U=0,x="",w=0,_=[];break;case"creator":d[1]==="/"?H=n.slice(U,d.index):U=d.index+d[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(d[1]==="/"){if((i=a.pop())[0]!==d[3])throw"Bad state: "+i}else d[0].charAt(d[0].length-2)!=="/"&&a.push([d[3],!1]);x="",w=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(d[1]==="/"){if(C[o.name]=l,(i=a.pop())[0]!==d[3])throw"Bad state: "+i}else d[0].charAt(d[0].length-2)!=="/"&&(l="",o=$e(d[0],!1),a.push([d[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=$e(d[0],!1),l+=J1[d[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=$e(d[0],!1),l+=J1[d[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(d[0].slice(-2)==="/>")break;if(d[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,d.index);break}else c=d.index+d[0].length;break;case"named-range":s=$e(d[0],!1),ae=$f(s["cell-range-address"]);var ve={Name:s.name,Ref:ae[0]+"!"+ae[1]};ee&&(ve.Sheet=h.length),oe.Names.push(ve);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(d[1]==="/"&&(!g||!g["string-value"])){var ie=qO(n.slice(w,d.index));x=(x.length>0?x+`
`:"")+ie[0]}else $e(d[0],!1),w=d.index+d[0].length;break;case"s":break;case"database-range":if(d[1]==="/")break;try{ae=$f($e(d[0])["target-range-address"]),p[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(d[1]!=="/"){if(j=$e(d[0],!1),!j.href)break;j.Target=nt(j.href),delete j.href,j.Target.charAt(0)=="#"&&j.Target.indexOf(".")>-1?(ae=$f(j.Target.slice(1)),j.Target="#"+ae[0]+"!"+ae[1]):j.Target.match(/^\.\.[\\\/]/)&&(j.Target=j.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(d[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(d)}}var O={Sheets:p,SheetNames:h,Workbook:oe};return r.bookSheets&&delete O.Sheets,O}function Q1(e,t){t=t||{},rn(e,"META-INF/manifest.xml")&&T4(Mt(e,"META-INF/manifest.xml"),t);var r=$r(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=a_(ut(r),t);return rn(e,"meta.xml")&&(n.Props=Hw(Mt(e,"meta.xml"))),n}function Z1(e,t){return a_(e,t)}var KO=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+al({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Bt+t}}(),eg=function(){var e=function(i){return lt(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var l=[];l.push('      <table:table table:name="'+lt(s.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,f=Cr(i["!ref"]||"A1"),p=i["!merges"]||[],h=0,m=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var d="",v=i["!rows"]||[];for(c=0;c<f.s.r;++c)d=v[c]?' table:style-name="ro'+v[c].ods+'"':"",l.push("        <table:table-row"+d+`></table:table-row>
`);for(;c<=f.e.r;++c){for(d=v[c]?' table:style-name="ro'+v[c].ods+'"':"",l.push("        <table:table-row"+d+`>
`),u=0;u<f.s.c;++u)l.push(t);for(;u<=f.e.c;++u){var g=!1,x={},w="";for(h=0;h!=p.length;++h)if(!(p[h].s.c>u)&&!(p[h].s.r>c)&&!(p[h].e.c<u)&&!(p[h].e.r<c)){(p[h].s.c!=u||p[h].s.r!=c)&&(g=!0),x["table:number-columns-spanned"]=p[h].e.c-p[h].s.c+1,x["table:number-rows-spanned"]=p[h].e.r-p[h].s.r+1;break}if(g){l.push(r);continue}var _=je({r:c,c:u}),S=m?(i[c]||[])[u]:i[_];if(S&&S.f&&(x["table:formula"]=lt(wP(S.f)),S.F&&S.F.slice(0,_.length)==_)){var E=Cr(S.F);x["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,x["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!S){l.push(t);continue}switch(S.t){case"b":w=S.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=S.v?"true":"false";break;case"n":w=S.w||String(S.v||0),x["office:value-type"]="float",x["office:value"]=S.v||0;break;case"s":case"str":w=S.v==null?"":S.v,x["office:value-type"]="string";break;case"d":w=S.w||xt(S.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=xt(S.v).toISOString(),x["table:style-name"]="ce1";break;default:l.push(t);continue}var k=e(w);if(S.l&&S.l.Target){var R=S.l.Target;R=R.charAt(0)=="#"?"#"+yP(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),k=be("text:a",k,{"xlink:href":R.replace(/&/g,"&amp;")})}l.push("          "+be("table:table-cell",be("text:p",k,{}),x)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var f=c["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Ba(f),f.ods=o;var p=c["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var f=c["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var l=[Bt],c=al({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=al({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(Ww().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),a(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=s.SheetNames.length;++f)l.push(n(s.Sheets[s.SheetNames[f]],s,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function i_(e,t){if(t.bookType=="fods")return eg(e,t);var r=Od(),n="",a=[],i=[];return n="mimetype",qe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",qe(r,n,eg(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",qe(r,n,KO(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",qe(r,n,Bt+Ww()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",qe(r,n,A4(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",qe(r,n,b4(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ci(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ph(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ut(Ha(e))}function XO(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):jr(Ln(e))}function YO(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ma(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function tg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function JO(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function QO(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function hl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function st(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ot(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function it(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=hl(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=hl(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:i};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function rr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(st(n*8+a.type)),a.type==2&&t.push(st(a.data.length)),t.push(a.data))})}),Ma(t)}function up(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function en(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=hl(e,n),i=it(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Ot(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=it(o.data),c=Ot(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=i[3])!=null&&t[0]&&(s.merge=Ot(i[3][0].data)>>>0>0),r.push(s)}return r}function ji(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:st(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:st(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:st(s.data.length)}],n[2].push({data:rr(s.meta),type:2})});var i=rr(n);t.push(st(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Ma(t)}function ZO(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=hl(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Ma(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=Ma(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function tn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(ZO(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ma(t)}function $i(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=st(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Ma(t)}function e6(e,t,r,n){var a=Ci(e),i=a.getUint32(4,!0),s=(n>1?12:8)+tg(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=tg(i&(n>1?12288:4096))*4,i&16&&(l=a.getUint32(s,!0),s+=4),i&32&&(c=a.getFloat64(s,!0),s+=8),i&64&&(u.setTime(u.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function t6(e,t,r){var n=Ci(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=JO(e,i),i+=16),a&2&&(c=n.getFloat64(i,!0),i+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(s>-1)f={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function Wf(e,t){var r=new Uint8Array(32),n=Ci(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,QO(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function Hf(e,t){var r=new Uint8Array(32),n=Ci(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function r6(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return e6(e,t,r,e[0]);case 5:return t6(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function dr(e){var t=it(e);return hl(t[1][0].data)}function rg(e,t){var r=it(t.data),n=Ot(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=it(s.data),l=Ot(o[1][0].data)>>>0;switch(n){case 1:i[l]=ph(o[3][0].data);break;case 8:{var c=e[dr(o[9][0].data)][0],u=it(c.data),f=e[dr(u[1][0].data)][0],p=Ot(f.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var h=it(f.data);i[l]=h[3].map(function(m){return ph(m.data)}).join("")}break}}),i}function n6(e,t){var r,n,a,i,s,o,l,c,u,f,p,h,m,d,v=it(e),g=Ot(v[1][0].data)>>>0,x=Ot(v[2][0].data)>>>0,w=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&Ot(v[8][0].data)>0||!1,_,S;if((i=(a=v[7])==null?void 0:a[0])!=null&&i.data&&t!=0)_=(o=(s=v[7])==null?void 0:s[0])==null?void 0:o.data,S=(c=(l=v[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=v[4])==null?void 0:u[0])!=null&&f.data&&t!=1)_=(h=(p=v[4])==null?void 0:p[0])==null?void 0:h.data,S=(d=(m=v[3])==null?void 0:m[0])==null?void 0:d.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=w?4:1,k=Ci(_),R=[],C=0;C<_.length/2;++C){var N=k.getUint16(C*2,!0);N<65535&&R.push([C,N])}if(R.length!=x)throw"Expected ".concat(x," cells, found ").concat(R.length);var X=[];for(C=0;C<R.length-1;++C)X[R[C][0]]=S.subarray(R[C][1]*E,R[C+1][1]*E);return R.length>=1&&(X[R[R.length-1][0]]=S.subarray(R[R.length-1][1]*E)),{R:g,cells:X}}function a6(e,t){var r,n=it(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Ot(n[7][0].data)>>>0>0?1:0:-1,i=up(n[5],function(s){return n6(s,a)});return{nrows:Ot(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function i6(e,t,r){var n,a=it(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Ot(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Ot(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ve(i);var s=it(a[4][0].data),o=rg(e,e[dr(s[4][0].data)][0]),l=(n=s[17])!=null&&n[0]?rg(e,e[dr(s[17][0].data)][0]):[],c=it(s[3][0].data),u=0;c[1].forEach(function(f){var p=it(f.data),h=e[dr(p[2][0].data)][0],m=Ot(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var d=a6(e,h);d.data.forEach(function(v,g){v.forEach(function(x,w){var _=je({r:u+g,c:w}),S=r6(x,o,l);S&&(r[_]=S)})}),u+=d.nrows})}function s6(e,t){var r=it(t.data),n={"!ref":"A1"},a=e[dr(r[2][0].data)],i=Ot(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return i6(e,a[0],n),n}function o6(e,t){var r,n=it(t.data),a={name:(r=n[1])!=null&&r[0]?ph(n[1][0].data):"",sheets:[]},i=up(n[2],dr);return i.forEach(function(s){e[s].forEach(function(o){var l=Ot(o.meta[1][0].data);l==6e3&&a.sheets.push(s6(e,o))})}),a}function l6(e,t){var r=vp(),n=it(t.data),a=up(n[1],dr);if(a.forEach(function(i){e[i].forEach(function(s){var o=Ot(s.meta[1][0].data);if(o==2){var l=o6(e,s);l.sheets.forEach(function(c,u){xp(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Vf(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=tn(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=en(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,s.push(f.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ot(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(l){i[l].forEach(function(c){var u=Ot(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return l6(i,o)}function c6(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Ot(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Ci(e[7][0].data),u=0,f=[],p=Ci(e[4][0].data),h=0,m=[],d=0;d<t.length;++d){if(t[d]==null){c.setUint16(d*2,65535,!0),p.setUint16(d*2,65535);continue}c.setUint16(d*2,u,!0),p.setUint16(d*2,h,!0);var v,g;switch(typeof t[d]){case"string":v=Wf({t:"s",v:t[d]},r),g=Hf({t:"s",v:t[d]},r);break;case"number":v=Wf({t:"n",v:t[d]},r),g=Hf({t:"n",v:t[d]},r);break;case"boolean":v=Wf({t:"b",v:t[d]},r),g=Hf({t:"b",v:t[d]},r);break;default:throw new Error("Unsupported value "+t[d])}f.push(v),u+=v.length,m.push(g),h+=g.length,++l}for(e[2][0].data=st(l);d<e[7][0].data.length/2;++d)c.setUint16(d*2,65535,!0),p.setUint16(d*2,65535,!0);return e[6][0].data=Ma(f),e[3][0].data=Ma(m),l}function u6(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Cr(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ve(n)));var i=vu(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(H){return H.forEach(function(U){typeof U=="string"&&s.push(U)})});var o={},l=[],c=De.read(t.numbers,{type:"base64"});c.FileIndex.map(function(H,U){return[H,c.FullPaths[U]]}).forEach(function(H){var U=H[0],B=H[1];if(U.type==2&&U.name.match(/\.iwa/)){var ee=U.content,xe=tn(ee),de=en(xe);de.forEach(function(he){l.push(he.id),o[he.id]={deps:[],location:B,type:Ot(he.messages[0].meta[1][0].data)}})}}),l.sort(function(H,U){return H-U});var u=l.filter(function(H){return H>1}).map(function(H){return[H,st(H)]});c.FileIndex.map(function(H,U){return[H,c.FullPaths[U]]}).forEach(function(H){var U=H[0];if(H[1],!!U.name.match(/\.iwa/)){var B=en(tn(U.content));B.forEach(function(ee){ee.messages.forEach(function(xe){u.forEach(function(de){ee.messages.some(function(he){return Ot(he.meta[1][0].data)!=11006&&YO(he.data,de[1])})&&o[de[0]].deps.push(ee.id)})})})}});for(var f=De.find(c,o[1].location),p=en(tn(f.content)),h,m=0;m<p.length;++m){var d=p[m];d.id==1&&(h=d)}var v=dr(it(h.messages[0].data)[1][0].data);for(f=De.find(c,o[v].location),p=en(tn(f.content)),m=0;m<p.length;++m)d=p[m],d.id==v&&(h=d);for(v=dr(it(h.messages[0].data)[2][0].data),f=De.find(c,o[v].location),p=en(tn(f.content)),m=0;m<p.length;++m)d=p[m],d.id==v&&(h=d);for(v=dr(it(h.messages[0].data)[2][0].data),f=De.find(c,o[v].location),p=en(tn(f.content)),m=0;m<p.length;++m)d=p[m],d.id==v&&(h=d);var g=it(h.messages[0].data);{g[6][0].data=st(n.e.r+1),g[7][0].data=st(n.e.c+1);var x=dr(g[46][0].data),w=De.find(c,o[x].location),_=en(tn(w.content));{for(var S=0;S<_.length&&_[S].id!=x;++S);if(_[S].id!=x)throw"Bad ColumnRowUIDMapArchive";var E=it(_[S].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var k=0;k<=n.e.c;++k){var R=[];R[1]=R[2]=[{type:0,data:st(k+420690)}],E[1].push({type:2,data:rr(R)}),E[2].push({type:0,data:st(k)}),E[3].push({type:0,data:st(k)})}E[4]=[],E[5]=[],E[6]=[];for(var C=0;C<=n.e.r;++C)R=[],R[1]=R[2]=[{type:0,data:st(C+726270)}],E[4].push({type:2,data:rr(R)}),E[5].push({type:0,data:st(C)}),E[6].push({type:0,data:st(C)});_[S].messages[0].data=rr(E)}w.content=$i(ji(_)),w.size=w.content.length,delete g[46];var N=it(g[4][0].data);{N[7][0].data=st(n.e.r+1);var X=it(N[1][0].data),A=dr(X[2][0].data);w=De.find(c,o[A].location),_=en(tn(w.content));{if(_[0].id!=A)throw"Bad HeaderStorageBucket";var V=it(_[0].messages[0].data);for(C=0;C<i.length;++C){var T=it(V[2][0].data);T[1][0].data=st(C),T[4][0].data=st(i[C].length),V[2][C]={type:V[2][0].type,data:rr(T)}}_[0].messages[0].data=rr(V)}w.content=$i(ji(_)),w.size=w.content.length;var K=dr(N[2][0].data);w=De.find(c,o[K].location),_=en(tn(w.content));{if(_[0].id!=K)throw"Bad HeaderStorageBucket";for(V=it(_[0].messages[0].data),k=0;k<=n.e.c;++k)T=it(V[2][0].data),T[1][0].data=st(k),T[4][0].data=st(n.e.r+1),V[2][k]={type:V[2][0].type,data:rr(T)};_[0].messages[0].data=rr(V)}w.content=$i(ji(_)),w.size=w.content.length;var ne=dr(N[4][0].data);(function(){for(var H=De.find(c,o[ne].location),U=en(tn(H.content)),B,ee=0;ee<U.length;++ee){var xe=U[ee];xe.id==ne&&(B=xe)}var de=it(B.messages[0].data);{de[3]=[];var he=[];s.forEach(function(O,we){he[1]=[{type:0,data:st(we)}],he[2]=[{type:0,data:st(1)}],he[3]=[{type:2,data:XO(O)}],de[3].push({type:2,data:rr(he)})})}B.messages[0].data=rr(de);var ve=ji(U),ie=$i(ve);H.content=ie,H.size=H.content.length})();var Q=it(N[3][0].data);{var oe=Q[1][0];delete Q[2];var j=it(oe.data);{var ae=dr(j[2][0].data);(function(){for(var H=De.find(c,o[ae].location),U=en(tn(H.content)),B,ee=0;ee<U.length;++ee){var xe=U[ee];xe.id==ae&&(B=xe)}var de=it(B.messages[0].data);{delete de[6],delete Q[7];var he=new Uint8Array(de[5][0].data);de[5]=[];for(var ve=0,ie=0;ie<=n.e.r;++ie){var O=it(he);ve+=c6(O,i[ie],s),O[1][0].data=st(ie),de[5].push({data:rr(O),type:2})}de[1]=[{type:0,data:st(n.e.c+1)}],de[2]=[{type:0,data:st(n.e.r+1)}],de[3]=[{type:0,data:st(ve)}],de[4]=[{type:0,data:st(n.e.r+1)}]}B.messages[0].data=rr(de);var we=ji(U),y=$i(we);H.content=y,H.size=H.content.length})()}oe.data=rr(j)}N[3][0].data=rr(Q)}g[4][0].data=rr(N)}h.messages[0].data=rr(g);var q=ji(p),b=$i(q);return f.content=b,f.size=f.content.length,c}function s_(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function fp(e){s_([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function hp(e){s_([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function f6(e){return Xe.WS.indexOf(e)>-1?"sheet":e==Xe.CS?"chart":e==Xe.DS?"dialog":e==Xe.MS?"macro":e&&e.length?e:"sheet"}function h6(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,f6(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function d6(e,t,r,n,a,i,s,o,l,c,u,f){try{i[n]=Co($r(e,r,!0),t);var p=Mt(e,t),h;switch(o){case"sheet":h=MR(p,t,a,l,i[n],c,u,f);break;case"chart":if(h=jR(p,t,a,l,i[n],c,u,f),!h||!h["!drawel"])break;var m=fo(h["!drawel"].Target,t),d=sl(m),v=C3($r(e,m,!0),Co($r(e,d,!0),m)),g=fo(v,m),x=sl(g);h=pR($r(e,g,!0),g,l,Co($r(e,x,!0),g),c,h);break;case"macro":h=$R(p,t,a,l,i[n],c,u,f);break;case"dialog":h=zR(p,t,a,l,i[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=h;var w=[];i&&i[n]&&It(i[n]).forEach(function(_){var S="";if(i[n][_].Type==Xe.CMNT){S=fo(i[n][_].Target,t);var E=GR(Mt(e,S,!0),S,l);if(!E||!E.length)return;$1(h,E,!1)}i[n][_].Type==Xe.TCMNT&&(S=fo(i[n][_].Target,t),w=w.concat(F3(Mt(e,S,!0),l)))}),w&&w.length&&$1(h,w,!0,l.people||[])}catch(_){if(l.WTF)throw _}}function Qr(e){return e.charAt(0)=="/"?e.slice(1):e}function o_(e,t){if($s(),t=t||{},fp(t),rn(e,"META-INF/manifest.xml")||rn(e,"objectdata.xml"))return Q1(e,t);if(rn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Vf<"u"){if(e.FileIndex)return Vf(e);var r=De.utils.cfb_new();return l1(e).forEach(function(T){qe(r,T,PT(e,T))}),Vf(r)}throw new Error("Unsupported NUMBERS file")}if(!rn(e,"[Content_Types].xml"))throw rn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):rn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=l1(e),a=S4($r(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Mt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Mt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Ao=[],a.sst)try{Ao=VR(Mt(e,Qr(a.sst)),a.sst,t)}catch(T){if(t.WTF)throw T}t.cellStyles&&a.themes.length&&(l=HR($r(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=WR(Mt(e,Qr(a.style)),a.style,l,t))}a.links.map(function(T){try{var K=Co($r(e,sl(Qr(T))),T);return KR(Mt(e,Qr(T)),K,T,t)}catch{}});var u=UR(Mt(e,Qr(a.workbooks[0])),a.workbooks[0],t),f={},p="";a.coreprops.length&&(p=Mt(e,Qr(a.coreprops[0]),!0),p&&(f=Hw(p)),a.extprops.length!==0&&(p=Mt(e,Qr(a.extprops[0]),!0),p&&P4(p,f,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(p=$r(e,Qr(a.custprops[0]),!0),p&&(h=O4(p,t)));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?s=u.Sheets.map(function(K){return K.name}):f.Worksheets&&f.SheetNames.length>0&&(s=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=h),t.bookSheets&&typeof s<"u"&&(m.SheetNames=s),t.bookSheets?m.SheetNames:t.bookProps))return m;s={};var d={};t.bookDeps&&a.calcchain&&(d=qR(Mt(e,Qr(a.calcchain)),a.calcchain));var v=0,g={},x,w;{var _=u.Sheets;f.Worksheets=_.length,f.SheetNames=[];for(var S=0;S!=_.length;++S)f.SheetNames[S]=_[S].name}var E=i?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),R=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");rn(e,R)||(R="xl/_rels/workbook."+E+".rels");var C=Co($r(e,R,!0),R.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=XR(Mt(e,Qr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=R3(Mt(e,Qr(a.people[0])),t)),C&&(C=h6(C,u.Sheets));var N=Mt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var X="sheet";if(C&&C[v]?(x="xl/"+C[v][1].replace(/[\/]?xl\//,""),rn(e,x)||(x=C[v][1]),rn(e,x)||(x=R.replace(/_rels\/.*$/,"")+C[v][1]),X=C[v][2]):(x="xl/worksheets/sheet"+(v+1-N)+"."+E,x=x.replace(/sheet0\./,"sheet.")),w=x.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,V=0;V!=t.sheets.length;++V)typeof t.sheets[V]=="number"&&t.sheets[V]==v&&(A=1),typeof t.sheets[V]=="string"&&t.sheets[V].toLowerCase()==f.SheetNames[v].toLowerCase()&&(A=1);if(!A)continue e}}d6(e,x,w,f.SheetNames[v],v,g,s,X,t,u,l,c)}return m={Directory:a,Workbook:u,Props:f,Custprops:h,Deps:d,Sheets:s,SheetNames:f.SheetNames,Strings:Ao,Styles:c,Themes:l,SSF:ft(Le)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(T,K){T=T.replace(/^Root Entry[\/]/,""),m.keys.push(T),m.files[T]=e.FileIndex[K]}))),t&&t.bookVBA&&(a.vba.length>0?m.vbaraw=Mt(e,Qr(a.vba[0]),!0):a.defaults&&a.defaults.bin===M3&&(m.vbaraw=Mt(e,"xl/vbaProject.bin",!0))),m}function p6(e,t){var r=t||{},n="Workbook",a=De.find(e,n);try{if(n="/!DataSpaces/Version",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(YC(a.content),n="/!DataSpaces/DataSpaceMap",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=QC(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=ZC(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);tA(a.content)}catch{}if(n="/EncryptionInfo",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=rA(a.content);if(n="/EncryptedPackage",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function m6(e,t){return t.bookType=="ods"?i_(e,t):t.bookType=="numbers"?u6(e,t):t.bookType=="xlsb"?g6(e,t):l_(e,t)}function g6(e,t){fs=1024,e&&!e.SSF&&(e.SSF=ft(Le)),e&&e.SSF&&($s(),bl(e.SSF),t.revssf=Wu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Fo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Fy.indexOf(t.bookType)>-1,a=Yd();hp(t=t||{});var i=Od(),s="",o=0;if(t.cellXfs=[],Ga(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",qe(i,s,Vw(e.Props,t)),a.coreprops.push(s),ot(t.rels,2,s,Xe.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,qe(i,s,Kw(e.Props)),a.extprops.push(s),ot(t.rels,3,s,Xe.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(s="docProps/custom.xml",qe(i,s,Xw(e.Custprops)),a.custprops.push(s),ot(t.rels,4,s,Xe.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,qe(i,s,JR(o-1,s,t,e,u)),a.sheets.push(s),ot(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Xe.WS[0])}if(f){var h=f["!comments"],m=!1,d="";h&&h.length>0&&(d="xl/comments"+o+"."+r,qe(i,d,eO(h,d)),a.comments.push(d),ot(u,-1,"../comments"+o+"."+r,Xe.CMNT),m=!0),f["!legacy"]&&m&&qe(i,"xl/drawings/vmlDrawing"+o+".vml",Cy(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&qe(i,sl(s),ys(u))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,qe(i,s,ZR(t.Strings,s,t)),a.strs.push(s),ot(t.wbrels,-1,"sharedStrings."+r,Xe.SST)),s="xl/workbook."+r,qe(i,s,YR(e,s)),a.workbooks.push(s),ot(t.rels,1,s,Xe.WB),s="xl/theme/theme1.xml",qe(i,s,rp(e.Themes,t)),a.themes.push(s),ot(t.wbrels,-1,"theme/theme1.xml",Xe.THEME),s="xl/styles."+r,qe(i,s,QR(e,s,t)),a.styles.push(s),ot(t.wbrels,-1,"styles."+r,Xe.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",qe(i,s,e.vbaraw),a.vba.push(s),ot(t.wbrels,-1,"vbaProject.bin",Xe.VBA)),s="xl/metadata."+r,qe(i,s,tO(s)),a.metadata.push(s),ot(t.wbrels,-1,"metadata."+r,Xe.XLMETA),qe(i,"[Content_Types].xml",zw(a,t)),qe(i,"_rels/.rels",ys(t.rels)),qe(i,"xl/_rels/workbook."+r+".rels",ys(t.wbrels)),delete t.revssf,delete t.ssf,i}function l_(e,t){fs=1024,e&&!e.SSF&&(e.SSF=ft(Le)),e&&e.SSF&&($s(),bl(e.SSF),t.revssf=Wu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Fo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Fy.indexOf(t.bookType)>-1,a=Yd();hp(t=t||{});var i=Od(),s="",o=0;if(t.cellXfs=[],Ga(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",qe(i,s,Vw(e.Props,t)),a.coreprops.push(s),ot(t.rels,2,s,Xe.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,qe(i,s,Kw(e.Props)),a.extprops.push(s),ot(t.rels,3,s,Xe.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(s="docProps/custom.xml",qe(i,s,Xw(e.Custprops)),a.custprops.push(s),ot(t.rels,4,s,Xe.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],h=(p||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,qe(i,s,jy(o-1,t,e,f)),a.sheets.push(s),ot(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Xe.WS[0])}if(p){var m=p["!comments"],d=!1,v="";if(m&&m.length>0){var g=!1;m.forEach(function(x){x[1].forEach(function(w){w.T==!0&&(g=!0)})}),g&&(v="xl/threadedComments/threadedComment"+o+"."+r,qe(i,v,P3(m,u,t)),a.threadedcomments.push(v),ot(f,-1,"../threadedComments/threadedComment"+o+"."+r,Xe.TCMNT)),v="xl/comments"+o+"."+r,qe(i,v,Ay(m)),a.comments.push(v),ot(f,-1,"../comments"+o+"."+r,Xe.CMNT),d=!0}p["!legacy"]&&d&&qe(i,"xl/drawings/vmlDrawing"+o+".vml",Cy(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&qe(i,sl(s),ys(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,qe(i,s,my(t.Strings,t)),a.strs.push(s),ot(t.wbrels,-1,"sharedStrings."+r,Xe.SST)),s="xl/workbook."+r,qe(i,s,Gy(e)),a.workbooks.push(s),ot(t.rels,1,s,Xe.WB),s="xl/theme/theme1.xml",qe(i,s,rp(e.Themes,t)),a.themes.push(s),ot(t.wbrels,-1,"theme/theme1.xml",Xe.THEME),s="xl/styles."+r,qe(i,s,Sy(e,t)),a.styles.push(s),ot(t.wbrels,-1,"styles."+r,Xe.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",qe(i,s,e.vbaraw),a.vba.push(s),ot(t.wbrels,-1,"vbaProject.bin",Xe.VBA)),s="xl/metadata."+r,qe(i,s,by()),a.metadata.push(s),ot(t.wbrels,-1,"metadata."+r,Xe.XLMETA),u.length>1&&(s="xl/persons/person.xml",qe(i,s,O3(u)),a.people.push(s),ot(t.wbrels,-1,"persons/person.xml",Xe.PEOPLE)),qe(i,"[Content_Types].xml",zw(a,t)),qe(i,"_rels/.rels",ys(t.rels)),qe(i,"xl/_rels/workbook."+r+".rels",ys(t.wbrels)),delete t.revssf,delete t.ssf,i}function dp(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=qr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function v6(e,t){return De.find(e,"EncryptedPackage")?p6(e,t):cp(e,t)}function x6(e,t){var r,n=e,a=t||{};return a.type||(a.type=Ke&&Buffer.isBuffer(e)?"buffer":"base64"),r=_w(n,a),o_(r,a)}function c_(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return hh(e.slice(r),t);default:break e}return Os.to_workbook(e,t)}function w6(e,t){var r="",n=dp(e,t);switch(t.type){case"base64":r=qr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Si(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ut(r)),t.type="binary",c_(r,t)}function y6(e,t){var r=e;return t.type=="base64"&&(r=qr(r)),r=tt.utils.decode(1200,r.slice(2),"str"),t.type="binary",c_(r,t)}function _6(e){return e.match(/[^\x00-\x7F]/)?Ln(e):e}function Gf(e,t,r,n){return n?(r.type="string",Os.to_workbook(e,r)):Os.to_workbook(t,r)}function gu(e,t){$u();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return gu(new Uint8Array(e),(r=ft(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ks={},r.dateNF&&(ks.dateNF=r.dateNF),r.type||(r.type=Ke&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ke?"buffer":"binary",n=kT(e),typeof Uint8Array<"u"&&!Ke&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=_6(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=ft(r),r.type="array",gu(Ad(n),r)}switch((a=dp(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return v6(De.read(n,r),r);break;case 9:if(a[1]<=8)return cp(n,r);break;case 60:return hh(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return IC(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return dy.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?x6(n,r):Gf(e,n,r,i);case 239:return a[3]===60?hh(n,r):Gf(e,n,r,i);case 255:if(a[1]===254)return y6(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return di.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return di.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return fh.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return yy.to_workbook(n,r);break;case 10:case 13:case 32:return w6(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return OC.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?fh.to_workbook(n,r):Gf(e,n,r,i)}function ng(e,t){var r=t||{};return r.type="file",gu(e,r)}function u_(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Cl(t.file,De.write(e,{type:Ke?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return De.write(e,t)}function k6(e,t){var r=ft(t||{}),n=m6(e,r);return f_(n,r)}function S6(e,t){var r=ft(t||{}),n=l_(e,r);return f_(n,r)}function f_(e,t){var r={},n=Ke?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?De.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Tl(a))}return t.password&&typeof encrypt_agile<"u"?u_(encrypt_agile(a,t.password),t):t.type==="file"?Cl(t.file,a):t.type=="string"?ut(a):a}function E6(e,t){var r=t||{},n=CO(e,r);return u_(n,r)}function In(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return tl(Ln(n));case"binary":return Ln(n);case"string":return e;case"file":return Cl(t.file,n,"utf8");case"buffer":return Ke?sa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):In(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function T6(e,t){switch(t.type){case"base64":return tl(e);case"binary":return e;case"string":return e;case"file":return Cl(t.file,e,"binary");case"buffer":return Ke?sa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function dc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?tl(r):t.type=="string"?ut(r):r;case"file":return Cl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function pp(e,t){$u(),Vy(e);var r=ft(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=pp(e,r);return r.type="array",Tl(n)}return S6(e,r)}function Yu(e,t){$u(),Vy(e);var r=ft(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Yu(e,r);return r.type="array",Tl(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return In(yO(e,r),r);case"slk":case"sylk":return In(hy.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return In(t_(e.Sheets[e.SheetNames[a]],r),r);case"txt":return T6(p_(e.Sheets[e.SheetNames[a]],r),r);case"csv":return In(gp(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return In(dy.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return dc(fh.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return In(Os.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return In(yy.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return In(py.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return In(i_(e,r),r);case"wk1":return dc(di.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return dc(di.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),dc(Yy(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),E6(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return k6(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function mp(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function ag(e,t,r){var n=r||{};return n.type="file",n.file=t,mp(n),Yu(e,n)}function b6(e,t,r){var n=r||{};return n.type="file",n.file=t,mp(n),pp(e,n)}function C6(e,t,r,n){var a=r||{};a.type="file",a.file=e,mp(a),a.type="buffer";var i=n;return i instanceof Function||(i=r),Ea.writeFile(e,Yu(t,a),i)}function h_(e,t,r,n,a,i,s,o){var l=Rt(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!s||e[r])for(var h=t.s.c;h<=t.e.c;++h){var m=s?e[r][h]:e[n[h]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;i[h]!=null&&(p[i[h]]=c);continue}var d=m.v;switch(m.t){case"z":if(d==null)break;continue;case"e":d=d==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[h]!=null){if(d==null)if(m.t=="e"&&d===null)p[i[h]]=null;else if(c!==void 0)p[i[h]]=c;else if(u&&d===null)p[i[h]]=null;else continue;else p[i[h]]=u&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?d:jn(m,d,o);d!=null&&(f=!1)}}return{row:p,isempty:f}}function vu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Ze(u);break;case"number":l=Ze(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var f=Rt(l.s.r),p=[],h=[],m=0,d=0,v=Array.isArray(e),g=l.s.r,x=0,w={};v&&!e[g]&&(e[g]=[]);var _=c.skipHidden&&e["!cols"]||[],S=c.skipHidden&&e["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(_[x]||{}).hidden)switch(p[x]=vt(x),r=v?e[g][x]:e[p[x]+f],n){case 1:i[x]=x-l.s.c;break;case 2:i[x]=p[x];break;case 3:i[x]=c.header[x-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=jn(r,null,c),d=w[s]||0,!d)w[s]=1;else{do o=s+"_"+d++;while(w[o]);w[s]=d,w[o]=1}i[x]=o}for(g=l.s.r+a;g<=l.e.r;++g)if(!(S[g]||{}).hidden){var E=h_(e,l,g,p,n,i,v,c);(E.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(h[m++]=E.row)}return h.length=m,h}var ig=/"/g;function d_(e,t,r,n,a,i,s,o){for(var l=!0,c=[],u="",f=Rt(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=o.dense?(e[r]||[])[p]:e[n[p]+f];if(h==null)u="";else if(h.v!=null){l=!1,u=""+(o.rawNumbers&&h.t=="n"?h.v:jn(h,null,o));for(var m=0,d=0;m!==u.length;++m)if((d=u.charCodeAt(m))===a||d===i||d===34||o.forceQuotes){u='"'+u.replace(ig,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(l=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(ig,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function gp(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Ze(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(p[m]||{}).hidden||(f[m]=vt(m));for(var d=0,v=a.s.r;v<=a.e.r;++v)(h[v]||{}).hidden||(u=d_(e,a,v,f,s,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((d++?o:"")+u)));return delete n.dense,r.join("")}function p_(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=gp(e,t);if(typeof tt>"u"||t.type=="string")return r;var n=tt.utils.encode(1200,r,"str");return""+n}function A6(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Ze(e["!ref"]),i="",s=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=vt(o);for(var u=a.s.r;u<=a.e.r;++u)for(i=Rt(u),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function m_(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Tt(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var f=Ze(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(s=f.e.r+1,u.e.r=s+t.length-1+a)}else s==-1&&(s=0,u.e.r=t.length-1+a);var p=n.header||[],h=0;t.forEach(function(d,v){It(d).forEach(function(g){(h=p.indexOf(g))==-1&&(p[h=p.length]=g);var x=d[g],w="z",_="",S=je({c:o+h,r:s+v+a});c=dl(i,S),x&&typeof x=="object"&&!(x instanceof Date)?i[S]=x:(typeof x=="number"?w="n":typeof x=="boolean"?w="b":typeof x=="string"?w="s":x instanceof Date?(w="d",n.cellDates||(w="n",x=qt(x)),_=n.dateNF||Le[14]):x===null&&n.nullError&&(w="e",x=0),c?(c.t=w,c.v=x,delete c.w,delete c.R,_&&(c.z=_)):i[S]=c={t:w,v:x},_&&(c.z=_))})}),u.e.c=Math.max(u.e.c,o+p.length-1);var m=Rt(s);if(a)for(h=0;h<p.length;++h)i[vt(h+o)+m]={t:"s",v:p[h]};return i["!ref"]=Ve(u),i}function F6(e,t){return m_(null,e,t)}function dl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Tt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?dl(e,je(t)):dl(e,je({r:t,c:r||0}))}function P6(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function vp(){return{SheetNames:[],Sheets:{}}}function xp(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(Hy(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function R6(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=P6(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function O6(e,t){return e.z=t,e}function g_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function I6(e,t,r){return g_(e,"#"+t,r)}function N6(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function D6(e,t,r,n){for(var a=typeof t!="string"?t:Ze(t),i=typeof t=="string"?t:Ve(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=dl(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var L6={encode_col:vt,encode_row:Rt,encode_cell:je,encode_range:Ve,decode_col:Hd,decode_row:Wd,split_cell:e4,decode_cell:Tt,decode_range:Cr,format_cell:jn,sheet_add_aoa:Dw,sheet_add_json:m_,sheet_add_dom:r_,aoa_to_sheet:Ws,json_to_sheet:F6,table_to_sheet:n_,table_to_book:VO,sheet_to_csv:gp,sheet_to_txt:p_,sheet_to_json:vu,sheet_to_html:t_,sheet_to_formulae:A6,sheet_to_row_object_array:vu,sheet_get_cell:dl,book_new:vp,book_append_sheet:xp,book_set_sheet_visibility:R6,cell_set_number_format:O6,cell_set_hyperlink:g_,cell_set_internal_link:I6,cell_add_comment:N6,sheet_set_array_formula:D6,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Ju;function B6(e){Ju=e}function U6(e,t){var r=Ju(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var a=Ze(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(p[m]||{}).hidden||(f[m]=vt(m));var d=a.s.r,v=!1,g=0;return r._read=function(){if(!v)return v=!0,r.push("\uFEFF");for(;d<=a.e.r;)if(++d,!(h[d-1]||{}).hidden&&(u=d_(e,a,d-1,f,s,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),u||n.blankrows!==!1)))return r.push((g++?o:"")+u);return r.push(null)},r}function M6(e,t){var r=Ju(),n=t||{},a=n.header!=null?n.header:Qy,i=n.footer!=null?n.footer:Zy;r.push(a);var s=Cr(e["!ref"]);n.dense=Array.isArray(e),r.push(e_(e,s,n));var o=s.s.r,l=!1;return r._read=function(){if(o>s.e.r)return l||(l=!0,r.push("</table>"+i)),r.push(null);for(;o<=s.e.r;){r.push(Jy(e,s,o,n)),++o;break}},r}function j6(e,t){var r=Ju({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},a=0,i=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?a=1:u.header==="A"?a=2:Array.isArray(u.header)&&(a=3),typeof f){case"string":c=Ze(f);break;case"number":c=Ze(e["!ref"]),c.s.r=f;break;default:c=f}a>0&&(i=0);var p=Rt(c.s.r),h=[],m=0,d=Array.isArray(e),v=c.s.r,g=0,x={};d&&!e[v]&&(e[v]=[]);var w=u.skipHidden&&e["!cols"]||[],_=u.skipHidden&&e["!rows"]||[];for(g=c.s.c;g<=c.e.c;++g)if(!(w[g]||{}).hidden)switch(h[g]=vt(g),n=d?e[v][g]:e[h[g]+p],a){case 1:s[g]=g-c.s.c;break;case 2:s[g]=h[g];break;case 3:s[g]=u.header[g-c.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),l=o=jn(n,null,u),m=x[o]||0,!m)x[o]=1;else{do l=o+"_"+m++;while(x[l]);x[o]=m,x[l]=1}s[g]=l}return v=c.s.r+i,r._read=function(){for(;v<=c.e.r;)if(!(_[v-1]||{}).hidden){var S=h_(e,c,v,h,a,s,d,u);if(++v,S.isempty===!1||(a===1?u.blankrows!==!1:u.blankrows)){r.push(S.row);return}}return r.push(null)},r}var $6={to_json:j6,to_html:M6,to_csv:U6,set_readable:B6};const z6=el.version,W6=Object.freeze(Object.defineProperty({__proto__:null,CFB:De,SSF:mw,parse_xlscfb:cp,parse_zip:o_,read:gu,readFile:ng,readFileSync:ng,set_cptable:VE,set_fs:yT,stream:$6,utils:L6,version:z6,write:Yu,writeFile:ag,writeFileAsync:C6,writeFileSync:ag,writeFileXLSX:b6,writeXLSX:pp},Symbol.toStringTag,{value:"Module"})),Rn=W6,sg=e=>String(e).toLowerCase().replace(/[^a-z0-9]/g,""),Je=e=>{if(e==null)return"";if(typeof e=="object")return e instanceof Date?e.toISOString().split("T")[0]:JSON.stringify(e);if(typeof e=="number"&&e>4e4&&e<6e4){const t=new Date(1899,11,30),r=new Date(t.getTime()+e*24*60*60*1e3);return console.log(" Converting Excel date:",e,"",r.toISOString().split("T")[0]),r.toISOString().split("T")[0]}return String(e).trim()},og=e=>{if(e==null||e==="")return"";const t=typeof e=="string"?parseFloat(e):e;if(typeof t=="number"&&!isNaN(t)&&t>=0&&t<1){const r=Math.round(t*24*60),n=Math.floor(r/60),a=r%60,i=`${n.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`;return console.log(" Converting Excel time:",e,"",i),i}return String(e).trim()},Oo={async loadSiteTracker(e){try{const t=await e.arrayBuffer(),r=Rn.read(t,{type:"array"}),n=r.SheetNames[0],a=r.Sheets[n],i=Rn.utils.sheet_to_json(a,{defval:""}),s=[];return i.forEach((o,l)=>{const c={};Object.keys(o).forEach(f=>{c[sg(f)]=o[f]}),l===0&&console.log(" EXCEL COLUMNS (normalized):",Object.keys(c).join(", "));const u=c.siteid||c.id||c.projectid||c.projectno||c.site;u&&s.push({id:Je(u),name:Je(c.sitename||c.name||c.projectname),address:Je(c.address||c.streetaddress),city:Je(c.city),state:Je(c.state),zip:Je(c.zip||c.zipcode||c.postalcode),latitude:Je(c.latitude||c.lat),longitude:Je(c.longitude||c.long||c.lon),phase:Je(c.group||c.phase||c.projectphase),towerOwner:Je(c.towerowner||c.owner),towerOwnerSiteNumber:Je(c.towerownersitenumber),viaeropoc:Je(c.viaeropoc),siteType:Je(c.sitetype||c.towertype),powerCompany:Je(c.powercompany||c.utilityprovider),meterNumber:Je(c.meternumber||c.meterid),telcoProvider:Je(c.telcofiberprovider||c.telco||c.fiberprovider),telcoProviderPOC:Je(c.telcofiberpoc),leaseAreaType:Je(c.leaseareatype||c.leasetype),gateCode:Je(c.gatecode||c.gatesheltercode||c.accesscode),photosUploaded:Je(c.photosuploaded),formUploaded:Je(c.sitewalkformuploaded||c.formuploaded),dateWalked:Je(c.datewalked),walkedBy:Je(c.walkedby),checkedIn:og(c.checkedin),checkedOut:og(c.checkedout),leaseAreaIssues:Je(c.leaseareaissues),measurement1:Je(c.measurement1inches),measurement2:Je(c.measurement2inches),measurement3:Je(c.measurement3inches),measurement4:Je(c.measurement4inches),measurement5:Je(c.measurement5inches),measurement6:Je(c.measurement6inches),measurement7:Je(c.measurement7inches),measurement8:Je(c.measurement8inches),measurement9:Je(c.measurement9inches),measurement10:Je(c.measurement10feet),measurement11:Je(c.measurement11feet)})}),s}catch(t){throw console.error("Error loading site tracker:",t),new Error("Failed to load site tracker Excel file")}},async loadPhotoRequirements(e){try{const t=await e.arrayBuffer(),r=Rn.read(t,{type:"array"}),n=r.SheetNames[0],a=r.Sheets[n],i=Rn.utils.sheet_to_json(a,{defval:""}),s=[];return i.forEach((o,l)=>{const c={};Object.keys(o).forEach(p=>{c[sg(p)]=o[p]});const u=c.photoname||c.name||c.requirement||c.photo,f=c.photoreqid||c.id||c.number||(u?String(l+1):null);(f||u)&&s.push({id:String(f),category:c.category||"General",name:u||`Photo ${f}`,description:c.photodescription||c.description||c.details||""})}),s}catch(t){throw console.error("Error loading photo requirements:",t),new Error("Failed to load photo requirements Excel file")}},async parseQuestionnaire(e){try{const t=await e.arrayBuffer(),r=Rn.read(t,{type:"array"}),n=r.SheetNames[0],a=r.Sheets[n],i=Rn.utils.sheet_to_json(a,{header:1,defval:""}),s={},o=l=>String(l).trim().toLowerCase();return i.forEach(l=>{if(l.length<2)return;const c=o(l[0]),u=Je(l[1]);if(!(!c||!u))if(c==="walked by")s.walkedBy=u;else if(c==="date walked")s.dateWalked=u;else if(c==="checked in")s.checkedIn=u;else if(c==="checked out")s.checkedOut=u;else if(c==="tower owner")s.towerOwner=u;else if(c==="fa number")s.faNumber=u;else if(c==="viaero poc"){const f=u.split(",").map(p=>p.trim());f[0]&&(s.pocName=f[0]),f[1]&&(s.pocPhone=f[1]),f[2]&&(s.pocEmail=f[2])}else if(c==="tower type")s.towerType=u;else if(c==="lease area type")s.leaseAreaType=u;else if(c==="power company")s.powerCompany=u;else if(c==="meter number")s.meterNumber=u;else if(c.includes("telco")&&c.includes("provider"))s.telcoFiberProvider=u;else if(c.includes("telco")&&c.includes("poc"))s.telcoFiberPOC=u;else if(c.startsWith("measurement")){const f=c.match(/measurement (\d+)/);f&&f[1]&&(s[`measurement${f[1]}`]=u)}else c==="lease area issues"?s.leaseAreaIssues=u:c.includes("gate")&&c.includes("code")&&(s.gateShelterCode=u)}),s}catch(t){throw console.error("Error parsing questionnaire:",t),new Error("Failed to parse questionnaire Excel file")}},async generateUpdatedTracker(e,t){try{console.log("Starting Excel generation with SheetJS...");const n=[["SiteID","SiteName","Address","City","State","Zip","County","Latitude","Longitude","Notes","Group","Tower Owner","Tower Owner Site Number","Viaero POC","Site Type","Lease Area Type","Power Company","Meter Number","Telco / Fiber Provider","Telco / Fiber POC","Measurement 1 (inches)","Measurement 2 (inches)","Measurement 3 (inches)","Measurement 4 (inches)","Measurement 5 (inches)","Measurement 6 (inches)","Measurement 7 (inches)","Measurement 8 (inches)","Measurement 9 (inches)","Measurement 10 (feet)","Measurement 11 (feet)","Walked By","Date Walked","Checked In","Checked Out","Lease Area Issues","Gate/Shelter Code","Photos Uploaded","Site Walk Form Uploaded","Measurements PDF Uploaded","Confirmation Email Recv'd","Action Needed"]];e.forEach(o=>{const l=t[o.id],c=[(l==null?void 0:l.pocName)||"",(l==null?void 0:l.pocPhone)||"",(l==null?void 0:l.pocEmail)||""].filter(f=>f&&f!=="N/A").join(" | "),u=[o.id,o.name,o.address,o.city,o.state,o.zip,"",o.latitude,o.longitude,"",o.phase,(l==null?void 0:l.towerOwner)||o.towerOwner,(l==null?void 0:l.faNumber)||"",c,"",(l==null?void 0:l.leaseAreaType)||o.leaseAreaType,(l==null?void 0:l.powerCompany)||o.powerCompany,(l==null?void 0:l.meterNumber)||o.meterNumber,(l==null?void 0:l.telcoProvider)||"",(l==null?void 0:l.telcoPOC)||"",(l==null?void 0:l.measurement1)||"",(l==null?void 0:l.measurement2)||"",(l==null?void 0:l.measurement3)||"",(l==null?void 0:l.measurement4)||"",(l==null?void 0:l.measurement5)||"",(l==null?void 0:l.measurement6)||"",(l==null?void 0:l.measurement7)||"",(l==null?void 0:l.measurement8)||"",(l==null?void 0:l.measurement9)||"",(l==null?void 0:l.measurement10)||"",(l==null?void 0:l.measurement11)||"",(l==null?void 0:l.walkedBy)||"",(l==null?void 0:l.dateWalked)||"",(l==null?void 0:l.checkInTime)||"",(l==null?void 0:l.checkOutTime)||"",(l==null?void 0:l.leaseAreaIssues)||"",(l==null?void 0:l.gateCode)||o.gateCode,"","","","",""];n.push(u)});const a=Rn.utils.book_new(),i=Rn.utils.aoa_to_sheet(n);return Rn.utils.book_append_sheet(a,i,"Site Tracker"),Rn.write(a,{type:"array",bookType:"xlsx"})}catch(r){throw console.error("Error in generateUpdatedTracker:",r),r}}};class H6{async findMatchingFolder(t,r){try{const n=await this.getSiteId(),a=Qe.sharepoint.documentLibrary,s=(await this.proxyRequest(`/sites/${n}/drives`)).value.find(m=>m.name===a);if(!s)return r;const o=t?`/root:/${t}:`:"/root",l=`/sites/${n}/drives/${s.id}${o}/children?select=name,folder`,u=(await this.proxyRequest(l)).value||[],f=u.find(m=>m.name===r);if(f)return f.name;const p=r.toLowerCase(),h=u.find(m=>m.name.toLowerCase()===p);if(h)return h.name;if(r.includes("Phase")){const m=r.replace(/[^0-9]/g,""),d=u.find(v=>v.name.includes(`Phase ${m}`));if(d)return d.name}return r}catch(n){return console.warn(`Could not resolve folder ${r} in ${t}:`,n),r}}async resolveSharePointPath(t,r,n="PHOTOS"){let a=Qe.sharepoint.folderPath;a=await this.findMatchingFolder(null,a);const i=Qe.sharepoint.normalizePhase(t),s=await this.findMatchingFolder(a,i),o=`${a}/${s}`,l=await this.findMatchingFolder(o,r);return n?`${a}/${s}/${l}/${n}`:`${a}/${s}/${l}`}async proxyRequest(t,r="GET",n=null,a=!1){const o={method:"POST",headers:{"Content-Type":"application/json","x-auth-pin":"2025"},body:JSON.stringify({endpoint:t,method:r,body:n})};try{const l=await fetch("/api/proxy",o);if(!l.ok){const c=await l.text();throw new Error(`Proxy Request Failed: ${l.status} ${l.statusText} - ${c}`)}return a?await l.arrayBuffer():await l.json()}catch(l){throw console.error("Proxy fetch failed:",l),new Error(`Proxy Connection Failed: ${l.message}`)}}async getSiteId(){const t=Qe.sharepoint.siteUrl,r=new URL(t).hostname,n=new URL(t).pathname;return(await this.proxyRequest(`/sites/${r}:${n}`)).id}async downloadExcelFile(t){try{const r=await this.getSiteId();console.log(`Downloading file: ${t} from site: ${r}`);const n=await this.proxyRequest(`/sites/${r}/drives`),a=Qe.sharepoint.documentLibrary,i=n.value.find(c=>c.name===a);if(!i)throw new Error(`Document library "${a}" not found`);const o=`${Qe.sharepoint.folderPath}/${t}`;console.log(`Downloading via proxy: ${o}`);const l=`/sites/${r}/drives/${i.id}/root:/${o}:/content`;return await this.proxyRequest(l,"GET",null,!0)}catch(r){throw console.error(`Error downloading ${t}:`,r),r}}async parseWithExcelService(t,r){const n={arrayBuffer:async()=>t};if(r==="tracker")return Oo.loadSiteTracker(n);if(r==="requirements")return Oo.loadPhotoRequirements(n);throw new Error("Unknown parse type")}async loadSiteDetails(){try{const t=Qe.sharepoint.siteDetailsFile,r=await this.downloadExcelFile(t);return await this.parseWithExcelService(r,"tracker")}catch(t){throw console.error("Error loading site details:",t),t}}async getTrackerDriveItemId(){const t=await this.getSiteId(),r=await this.proxyRequest(`/sites/${t}/drives`),n=Qe.sharepoint.documentLibrary,a=r.value.find(f=>f.name===n);if(!a)throw new Error("Document library not found");const i=Qe.sharepoint.folderPath,s=Qe.sharepoint.siteDetailsFile,o=`${i}/${s}`,l=await this.proxyRequest(`/sites/${t}/drives/${a.id}/root:/${o}`),c=await this.proxyRequest(`/sites/${t}/drives/${a.id}/items/${l.id}/workbook/worksheets`),u=c.value&&c.value[0]?c.value[0].name:"Sheet1";return console.log(" Using worksheet:",u),{siteId:t,driveId:a.id,itemId:l.id,worksheetName:u}}async findSiteRowInTracker(t){try{const{siteId:r,driveId:n,itemId:a,worksheetName:i}=await this.getTrackerDriveItemId(),s=`/sites/${r}/drives/${n}/items/${a}/workbook/worksheets('${i}')/range(address='A1:AZ1')`,l=(await this.proxyRequest(s,"GET")).values[0]||[];console.log(" EXCEL COLUMN HEADERS:",l.map((p,h)=>`${h}:${p}`).join(" | "));const c=`/sites/${r}/drives/${n}/items/${a}/workbook/worksheets('${i}')/range(address='A1:A500')`,f=(await this.proxyRequest(c,"GET")).values||[];for(let p=0;p<f.length;p++)if(String(f[p][0]||"").trim()===String(t).trim())return console.log(`Found site ${t} at row ${p+1}`),p+1;return console.warn(`Site ${t} not found in tracker`),null}catch(r){throw console.error("Error finding site row:",r),r}}async updateSiteTrackerRow(t,r){try{console.log(`Updating tracker for site ${t}...`);const{siteId:n,driveId:a,itemId:i,worksheetName:s}=await this.getTrackerDriveItemId(),o=await this.findSiteRowInTracker(t);if(!o)throw new Error(`Site ${t} not found in Site Tracker`);const l=`/sites/${n}/drives/${a}/items/${i}/workbook/worksheets('${s}')/range(address='A1:AZ1')`,u=(await this.proxyRequest(l,"GET")).values[0]||[],f=x=>String(x||"").toLowerCase().replace(/[^a-z0-9]/g,""),p={};u.forEach((x,w)=>{p[f(x)]=w}),console.log(" Column map built:",Object.keys(p).slice(0,20).join(", "));const h=`A${o}:AZ${o}`,d=(await this.proxyRequest(`/sites/${n}/drives/${a}/items/${i}/workbook/worksheets('${s}')/range(address='${h}')`,"GET")).values[0]||[];for(;d.length<52;)d.push("");const v=(x,w)=>{const _=p[f(x)];_!==void 0&&w!==void 0&&(d[_]=w,console.log(`  Set ${x} (col ${_}) = ${String(w).substring(0,30)}`))};v("Walked By",r.walkedBy),v("Date Walked",r.dateWalked),v("Checked In",r.checkedIn),v("Checked Out",r.checkedOut),v("Tower Owner",r.towerOwner),v("Tower Owner Site Number",r.faNumber),v("Lease Area Type",r.leaseAreaType),v("Power Company",r.powerCompany),v("Meter Number",r.meterNumber),v("Telco / Fiber Provider",r.telcoFiberProvider),v("Telco / Fiber POC",r.telcoFiberPOC),v("Lease Area Issues",r.leaseAreaIssues),v("Gate/Shelter Code",r.gateShelterCode);for(let x=1;x<=9;x++)v(`Measurement ${x} (inches)`,r[`measurement${x}`]);v("Measurement 10 (feet)",r.measurement10),v("Measurement 11 (feet)",r.measurement11);const g=`/sites/${n}/drives/${a}/items/${i}/workbook/worksheets('${s}')/range(address='${h}')`;return await this.proxyRequest(g,"PATCH",{values:[d]}),console.log(` Updated tracker row ${o} for site ${t}`),!0}catch(n){throw console.error("Error updating site tracker row:",n),n}}async loadPhotoRequirements(){try{const t=Qe.sharepoint.photoRequirementsFile,r=await this.downloadExcelFile(t);return await this.parseWithExcelService(r,"requirements")}catch(t){throw console.error("Error loading photo requirements:",t),t}}async uploadPhoto(t,r,n,a){try{const i=await this.getSiteId();await this.getSiteId();const o=`${await this.resolveSharePointPath(t,r)}/${n}`;console.log(` STARTING UPLOAD: ${n}`),console.log(` Resolved Target Path: ${o}`),console.log(`Requesting upload session for: ${o}`);const l=await this.proxyRequest(`/sites/${i}/drives`),c=Qe.sharepoint.documentLibrary,u=l.value.find(v=>v.name===c);if(!u)throw new Error("Drive not found");const f=o.split("/").map(v=>encodeURIComponent(v)).join("/"),p=`/sites/${i}/drives/${u.id}/root:/${f}:/createUploadSession`,m=(await this.proxyRequest(p,"POST",{item:{"@microsoft.graph.conflictBehavior":"replace"}})).uploadUrl;console.log("Got upload URL, uploading direct to Microsoft...");const d=await fetch(m,{method:"PUT",headers:{"Content-Range":`bytes 0-${a.size-1}/${a.size}`,"Content-Length":a.size},body:a});if(!d.ok)throw new Error(`Direct Upload Failed: ${d.statusText}`);return console.log(`Photo uploaded successfully: ${o}`),!0}catch(i){throw console.error("Error uploading photo:",i),i}}async uploadZip(t,r,n,a,i){try{const s=await this.getSiteId(),l=`${await this.resolveSharePointPath(t,r,"PHOTOS")}/${a}`;console.log(` STARTING ZIP UPLOAD: ${a}`),console.log(` Resolved Target Path: ${l}`);const c=await this.proxyRequest(`/sites/${s}/drives`),u=Qe.sharepoint.documentLibrary,f=c.value.find(x=>x.name===u);if(!f)throw new Error("Drive not found");const p=l.split("/").map(x=>encodeURIComponent(x)).join("/"),h=`/sites/${s}/drives/${f.id}/root:/${p}:/createUploadSession`,d=(await this.proxyRequest(h,"POST",{item:{"@microsoft.graph.conflictBehavior":"replace"}})).uploadUrl;console.log("Got upload URL, uploading Zip to Microsoft...");const v=10*1024*1024,g=i.size;if(g<=v){console.log(`Small file (${(g/1024/1024).toFixed(2)} MB), uploading in one request...`);try{const x=await fetch(d,{method:"PUT",headers:{"Content-Range":`bytes 0-${g-1}/${g}`,"Content-Length":g.toString()},body:i});if(!x.ok)throw new Error(`Direct Zip Upload Failed: ${x.statusText}`)}catch(x){throw console.error("Upload fetch failed:",x),new Error(`Microsoft Upload Connection Failed: ${x.message}`)}}else{console.log(`Large file (${(g/1024/1024).toFixed(2)} MB), uploading in ${v/1024/1024}MB chunks...`);let x=0,w=1;const _=Math.ceil(g/v);for(;x<g;){const S=Math.min(x+v,g),E=i.slice(x,S);console.log(`Uploading chunk ${w}/${_}: bytes ${x}-${S-1}/${g}`);try{const k=await fetch(d,{method:"PUT",headers:{"Content-Range":`bytes ${x}-${S-1}/${g}`,"Content-Length":(S-x).toString()},body:E});if(!k.ok&&k.status!==202){const C=await k.text();throw new Error(`Chunk upload failed: ${k.status} - ${C}`)}const R=Math.round(S/g*100);console.log(` Chunk ${w} uploaded (${R}% complete)`)}catch(k){throw console.error(`Chunk ${w} upload failed:`,k),new Error(`Microsoft Upload Connection Failed at chunk ${w}: ${k.message}`)}x=S,w++}}return console.log(` Zip uploaded successfully: ${l}`),!0}catch(s){throw console.error("Error uploading zip:",s),s}}async uploadQuestionnaire(t,r,n,a){try{const i=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=await this.getSiteId(),o=await this.resolveSharePointPath(t,r,null),l=`Telamon Site Walk Form ${r} ${n}.xlsx`,c=`${o}/${l}`;console.log(` STARTING QUESTIONNAIRE UPLOAD: ${l}`),console.log(` Resolved Target Path: ${c}`);const u=await this.proxyRequest(`/sites/${s}/drives`),f=Qe.sharepoint.documentLibrary,p=u.value.find(g=>g.name===f),h=c.split("/").map(g=>encodeURIComponent(g)).join("/"),m=`/sites/${s}/drives/${p.id}/root:/${h}:/createUploadSession`,d=await this.proxyRequest(m,"POST",{item:{"@microsoft.graph.conflictBehavior":"replace"}});console.log("Got upload URL, uploading direct to Microsoft...");const v=await fetch(d.uploadUrl,{method:"PUT",headers:{"Content-Range":`bytes 0-${i.size-1}/${i.size}`,"Content-Length":i.size},body:i});if(!v.ok)throw new Error(`Direct Upload Failed: ${v.statusText}`);return!0}catch(i){throw console.error("Error uploading questionnaire:",i),i}}async checkQuestionnaireExists(t,r,n){try{const a=await this.listFiles(t,r,null);console.log(`[CheckQuestionnaire] Found ${a.length} files in ${r} folder`);const i=a.find(s=>{const o=s.name.toLowerCase();return o.endsWith(".xlsx")&&(o.includes("questionnaire")||o.includes("site walk form")||o.includes("form"))});return i?(console.log(`v Found matching questionnaire: ${i.name}`),!0):(console.log(`x No matching questionnaire found. Files: ${a.map(s=>s.name).join(", ")}`),!1)}catch(a){return console.error("Error checking questionnaire existence:",a),!1}}async downloadQuestionnaire(t,r,n){try{const a=`Telamon Site Walk Form ${r} ${n}.xlsx`,i=await this.getSiteId(),o=`${await this.resolveSharePointPath(t,r,null)}/${a}`;console.log(`Downloading questionnaire: ${o}`);const l=await this.proxyRequest(`/sites/${i}/drives`),c=Qe.sharepoint.documentLibrary,u=l.value.find(d=>d.name===c),f=o.split("/").map(d=>encodeURIComponent(d)).join("/"),p=`/sites/${i}/drives/${u.id}/root:/${f}:/content`,h=await this.proxyRequest(p,"GET",null,!0),m={arrayBuffer:async()=>h};return await Oo.parseQuestionnaire(m)}catch(a){throw console.error("Error downloading questionnaire:",a),a}}async deleteFile(t,r,n){try{const a=await this.getSiteId(),s=`${await this.resolveSharePointPath(t,r)}/${n}`,o=await this.proxyRequest(`/sites/${a}/drives`),l=Qe.sharepoint.documentLibrary,c=o.value.find(f=>f.name===l),u=`/sites/${a}/drives/${c.id}/root:/${s}`;return await this.proxyRequest(u,"DELETE"),console.log(` File deleted successfully: ${s}`),!0}catch(a){if(console.error("Error deleting file:",a),a.message.includes("404"))return!0;throw a}}async listFiles(t,r,n="PHOTOS"){try{const a=await this.getSiteId(),i=await this.resolveSharePointPath(t,r,n),s=await this.proxyRequest(`/sites/${a}/drives`),o=Qe.sharepoint.documentLibrary,l=s.value.find(f=>f.name===o),c=`/sites/${a}/drives/${l.id}/root:/${i}:/children?select=name,id,size,lastModifiedDateTime,folder`;return(await this.proxyRequest(c)).value||[]}catch(a){return console.error("Error listing files:",a),[]}}async checkFileExists(t,r,n,a="PHOTOS"){try{return(await this.listFiles(t,r,a)).some(s=>s.name===n)}catch(i){return console.error("Error checking file existence:",i),!1}}async getNextAvailableFilename(t,r,n,a="PHOTOS"){try{const i=await this.listFiles(t,r,a),s=new Set(i.map(f=>f.name.toLowerCase()));if(!s.has(n.toLowerCase()))return n;const o=n.lastIndexOf("."),l=o>0?n.substring(0,o):n,c=o>0?n.substring(o):"";let u=1;for(;u<100;){const f=`${l}_${u}${c}`;if(!s.has(f.toLowerCase()))return f;u++}return`${l}_${Date.now()}${c}`}catch(i){console.error("Error getting next available filename:",i);const s=n.lastIndexOf("."),o=s>0?n.substring(0,s):n,l=s>0?n.substring(s):"";return`${o}_${Date.now()}${l}`}}getPhotoFolderUrl(t,r){const n=Qe.sharepoint.siteUrl,a=Qe.sharepoint.folderPath,i=Qe.sharepoint.normalizePhase(t),s=`/sites/Trid3ntCOPs/Shared Documents/${a}/${i}/${r}/PHOTOS`,o=encodeURIComponent(s);return`${n}/Shared%20Documents/Forms/AllItems.aspx?id=${o}`}getCategoryFolderUrl(t,r,n){const a=Qe.sharepoint.siteUrl,i=Qe.sharepoint.folderPath,s=Qe.sharepoint.normalizePhase(t),o=n.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),l=`/sites/Trid3ntCOPs/Shared Documents/${i}/${s}/${r}/PHOTOS/${o}`,c=encodeURIComponent(l);return`${a}/Shared%20Documents/Forms/AllItems.aspx?id=${c}`}async downloadPhoto(t,r,n){try{const a=await this.getSiteId(),s=`${await this.resolveSharePointPath(t,r)}/${n}`,o=await this.proxyRequest(`/sites/${a}/drives`),l=Qe.sharepoint.documentLibrary,c=o.value.find(p=>p.name===l),u=`/sites/${a}/drives/${c.id}/root:/${s}:/content`,f=await this.proxyRequest(u,"GET",null,!0);return new Blob([f])}catch(a){throw console.error(`Error downloading photo ${n}:`,a),a}}async runDiagnostics(t,r){const n=[],a=i=>n.push(`${new Date().toLocaleTimeString()}: ${i}`);try{a(`Starting diagnostics for: Phase="${t}", Site="${r}"`);const i=await this.getSiteId();a(`Site ID: ${i}`),a("Step 1: finding Document Library...");const s=await this.proxyRequest(`/sites/${i}/drives`),o=Qe.sharepoint.documentLibrary,l=s.value.find(N=>N.name===o);if(!l)return a(` Error: Document Library "${o}" not found. Available: ${s.value.map(N=>N.name).join(", ")}`),n;a(` Found Drive: ${l.name} (${l.id})`),a("Step 2: Finding Root Folder...");let c=Qe.sharepoint.folderPath;const u=`/sites/${i}/drives/${l.id}/root/children`,f=await this.proxyRequest(u);if(!f.value)return a(" Error: Could not list root children."),n;let p=f.value.find(N=>N.name===c);if(p||(a(`! Exact match for "${c}" not found. listing candidates:`),f.value.forEach(N=>a(` - ${N.name}`)),p=f.value.find(N=>N.name.toLowerCase()===c.toLowerCase())),!p)return a(" Error: Root folder not found."),n;a(` Found Root: ${p.name}`),a(`Step 3: Finding Phase Folder ("${t}")...`);const h=Qe.sharepoint.normalizePhase(t);a(`Normalized Phase Target: ${h}`);const m=encodeURIComponent(p.name),d=`/sites/${i}/drives/${l.id}/root:/${m}:/children`,v=await this.proxyRequest(d);let g=v.value.find(N=>N.name===h);if(!g&&h.includes("Phase")){const N=h.replace(/[^0-9]/g,"");g=v.value.find(X=>X.name.includes(`Phase ${N}`))}if(!g)return a(` Error: Phase folder not found. Candidates in ${p.name}:`),v.value.forEach(N=>a(` - ${N.name}`)),n;a(` Found Phase: ${g.name}`),a(`Step 4: Finding Site Folder ("${r}")...`);const x=`${m}/${encodeURIComponent(g.name)}`,w=`/sites/${i}/drives/${l.id}/root:/${x}:/children`,_=await this.proxyRequest(w);let S=_.value.find(N=>N.name===r);if(S||(S=_.value.find(N=>N.name.toLowerCase()===r.toLowerCase())),!S)return a(` Error: Site folder "${r}" not found. Candidates in ${g.name}:`),_.value.forEach(N=>a(` - ${N.name}`)),n;a(` Found Site: ${S.name}`),a("Step 5: Listing Files in Site Folder...");const E=`${x}/${encodeURIComponent(S.name)}`,k=`/sites/${i}/drives/${l.id}/root:/${E}:/children`,R=await this.proxyRequest(k);a(`Found ${R.value.length} items:`),R.value.forEach(N=>a(` [${N.folder?"DIR":"FILE"}] ${N.name}`));const C=R.value.find(N=>N.name==="PHOTOS");return a(C?" PHOTOS folder exists.":"! PHOTOS folder MISSING."),a("Diagnostics Complete."),n}catch(i){return a(`CRITICAL EXCEPTION: ${i.message}`),console.error(i),n}}}const wt=new H6;class V6{async sendUploadNotification(t,r,n,a={}){try{const i=new Date().toLocaleString();let s="";r==="photos"?s=`- ${n} photo${n>1?"s":""}`:r==="questionnaire"?s="- 1 Site Walk Questionnaire":r==="batch"&&(a.photos>0&&(s+=`- ${a.photos} photo${a.photos>1?"s":""}
`),a.questionnaires>0&&(s+=`- ${a.questionnaires} questionnaire${a.questionnaires>1?"s":""}`));const o=a.folderPath||`Documents > Telamon - Viaero Site Walks > ${t}`,l=`
Your site walk data has been successfully uploaded to SharePoint.

Site: ${t}
Items Uploaded:
${s}

Uploaded at: ${i}

Location: ${o}

This is an automated notification from the Site Walk app.
            `.trim(),c={message:{subject:`Site Walk Upload Complete: ${t}`,body:{contentType:"Text",content:l},toRecipients:[{emailAddress:{address:Qe.notifications.email}}]},saveToSentItems:!1},u=Qe.notifications.email;return await wt.proxyRequest(`/users/${u}/sendMail`,"POST",c),console.log(` Email notification sent to ${Qe.notifications.email}`),!0}catch(i){return console.error("Failed to send email notification:",i),console.warn("Upload was successful, but email notification failed"),!1}}}const v_=new V6,mi={isOnline(){return navigator.onLine},async addToQueue(e,t){await ze.addToSyncQueue({type:e,data:t,attempts:0}),console.log(`Added ${e} to sync queue`)},async processQueue(){if(!this.isOnline()){console.log("Offline: Cannot process sync queue");return}const e=await ze.getSyncQueue();if(e.length===0)return;console.log(`Processing ${e.length} items in sync queue...`);let t=0;for(const r of e)try{let n=!1;r.type==="PHOTO"?n=await this.syncPhoto(r.data):r.type==="QUESTIONNAIRE"?n=await this.syncQuestionnaire(r.data):r.type==="DELETE_PHOTO"&&(n=await this.syncDeletePhoto(r.data)),n&&(await ze.removeFromSyncQueue(r.id),t++)}catch(n){console.error(`Error processing queue item ${r.id}:`,n)}return t},async syncPhoto(e){try{const t=(await ze.getPhotos(e.siteId)).find(r=>r.id===e.photoId);return t?(await wt.uploadPhoto(e.phase,e.siteName,t.filename,t.blob),console.log(`Synced photo: ${t.filename}`),!0):(console.error("Photo not found in storage:",e.photoId),!0)}catch(t){return console.error("Sync photo error:",t),!1}},async syncQuestionnaire(e){try{const{phase:t,siteName:r,siteId:n,blob:a}=e;return await wt.uploadQuestionnaire(t,r,n,a),console.log(`Synced questionnaire for ${r}`),!0}catch(t){return console.error("Sync questionnaire error:",t),!1}},async syncDeletePhoto(e){try{const{phase:t,siteName:r,filename:n}=e;return await wt.deleteFile(t,r,n),console.log(`Synced deletion for: ${n}`),!0}catch(t){return console.error("Sync delete photo error:",t),!1}},async reconcilePhotos(e,t,r){if(!this.isOnline())return{deleted:0,downloaded:0};try{console.log(`Reconciling photos for ${r}...`);const n=await wt.listFiles(t,r),a=new Set(n.map(g=>g.name)),i=await ze.getPhotos(e),s=new Set(i.map(g=>g.filename));console.log(" RECONCILIATION DEBUG:"),console.log("Server files:",Array.from(a)),console.log("Local files:",Array.from(s)),console.log("Local photos with status:",i.map(g=>({filename:g.filename,status:g.status,capturedAt:g.capturedAt})));const o=new Map;for(const g of i){const x=o.get(g.filename);if(!x)o.set(g.filename,g);else{const w=new Date(x.capturedAt||0);new Date(g.capturedAt||0)>w?(await ze.deletePhoto(x.id),console.log(` Removed duplicate (older): ${x.filename}`),o.set(g.filename,g)):(await ze.deletePhoto(g.id),console.log(` Removed duplicate (older): ${g.filename}`))}}const l=await ze.getPhotos(e),c=new Set(l.map(g=>g.filename)),u=new Date,f=l.filter(g=>{if(!!a.has(g.filename))return console.log(` Keeping synced photo: ${g.filename}`),!1;if(!(g.status==="pending"))return console.log(` Will delete: ${g.filename} (status: ${g.status})`),!0;const _=g.capturedAt?new Date(g.capturedAt):new Date(0),S=(u-_)/1e3/60;return S>1440?(console.log(` Will delete stale pending photo: ${g.filename} (age: ${S.toFixed(1)} min)`),!0):(console.log(` Skipping recent pending photo: ${g.filename} (age: ${S.toFixed(1)} min)`),!1)}),p=l.filter(g=>(!g.dataUrl||g.dataUrl.startsWith("blob:"))&&a.has(g.filename)?(console.log(` Photo has broken URL, will re-download: ${g.filename}`),!0):!1);for(const g of p)await ze.deletePhoto(g.id),console.log(` Deleted photo with broken URL: ${g.filename}`);const h=await ze.getPhotos(e),m=new Set(h.map(g=>g.filename)),d=n.filter(g=>{const x=!m.has(g.name)&&g.name.toLowerCase().endsWith(".jpg");return x&&console.log(` Will download: ${g.name}`),x});console.log(`Reconciliation Plan: Delete ${f.length}, Download ${d.length}`);for(const g of f)await ze.deletePhoto(g.id),console.log(`Deleted local orphan: ${g.filename}`);const v=await ze.getPhotoRequirements();for(const g of d)try{const x=await wt.downloadPhoto(t,r,g.name);let w=null,_="";const S=[...v].sort((E,k)=>k.name.length-E.name.length);for(const E of S){const k=E.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");if(new RegExp(`${k} \\d`).test(g.name)){w=E,_=E.name;break}}if(!w){const E=g.name.split(" - ");E.length>=3&&(_=E[E.length-1].replace(/ \d+\.\d+\.(jpg|jpeg)$/i,"").trim(),w=v.find(R=>R.name===_))}if(w){const E=await new Promise((R,C)=>{const N=new FileReader;N.onload=()=>R(N.result),N.onerror=C,N.readAsDataURL(x)}),k={id:crypto.randomUUID?crypto.randomUUID():Date.now().toString(),photoReqId:w.id,photoReqName:w.name,filename:g.name,blob:x,dataUrl:E,size:x.size,capturedAt:g.lastModifiedDateTime||new Date().toISOString(),status:"synced"};await ze.savePhoto(e,k),console.log(`Downloaded and saved: ${g.name}`)}else console.warn(`Could not match photo ${g.name} to a requirement. Skipping.`)}catch(x){console.error(`Failed to download ${g.name}:`,x)}return{deleted:f.length,downloaded:d.length}}catch(n){return console.error("Reconciliation error:",n),{deleted:0,downloaded:0}}},init(){window.addEventListener("online",()=>{console.log("Network restored. Processing sync queue..."),this.processQueue()}),this.isOnline()&&setTimeout(()=>this.processQueue(),5e3)}};function pc(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var x_={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,a,i){function s(c,u){if(!a[c]){if(!n[c]){var f=typeof pc=="function"&&pc;if(!u&&f)return f(c,!0);if(o)return o(c,!0);var p=new Error("Cannot find module '"+c+"'");throw p.code="MODULE_NOT_FOUND",p}var h=a[c]={exports:{}};n[c][0].call(h.exports,function(m){var d=n[c][1][m];return s(d||m)},h,h.exports,r,n,a,i)}return a[c].exports}for(var o=typeof pc=="function"&&pc,l=0;l<i.length;l++)s(i[l]);return s}({1:[function(r,n,a){var i=r("./utils"),s=r("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(l){for(var c,u,f,p,h,m,d,v=[],g=0,x=l.length,w=x,_=i.getTypeOf(l)!=="string";g<l.length;)w=x-g,f=_?(c=l[g++],u=g<x?l[g++]:0,g<x?l[g++]:0):(c=l.charCodeAt(g++),u=g<x?l.charCodeAt(g++):0,g<x?l.charCodeAt(g++):0),p=c>>2,h=(3&c)<<4|u>>4,m=1<w?(15&u)<<2|f>>6:64,d=2<w?63&f:64,v.push(o.charAt(p)+o.charAt(h)+o.charAt(m)+o.charAt(d));return v.join("")},a.decode=function(l){var c,u,f,p,h,m,d=0,v=0,g="data:";if(l.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");var x,w=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&w--,l.charAt(l.length-2)===o.charAt(64)&&w--,w%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=s.uint8array?new Uint8Array(0|w):new Array(0|w);d<l.length;)c=o.indexOf(l.charAt(d++))<<2|(p=o.indexOf(l.charAt(d++)))>>4,u=(15&p)<<4|(h=o.indexOf(l.charAt(d++)))>>2,f=(3&h)<<6|(m=o.indexOf(l.charAt(d++))),x[v++]=c,h!==64&&(x[v++]=u),m!==64&&(x[v++]=f);return x}},{"./support":30,"./utils":32}],2:[function(r,n,a){var i=r("./external"),s=r("./stream/DataWorker"),o=r("./stream/Crc32Probe"),l=r("./stream/DataLengthProbe");function c(u,f,p,h,m){this.compressedSize=u,this.uncompressedSize=f,this.crc32=p,this.compression=h,this.compressedContent=m}c.prototype={getContentWorker:function(){var u=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return u.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,f,p){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(f.compressWorker(p)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},n.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,a){var i=r("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},a.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,a){var i=r("./utils"),s=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();n.exports=function(o,l){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(c,u,f,p){var h=s,m=p+f;c^=-1;for(var d=p;d<m;d++)c=c>>>8^h[255&(c^u[d])];return-1^c}(0|l,o,o.length,0):function(c,u,f,p){var h=s,m=p+f;c^=-1;for(var d=p;d<m;d++)c=c>>>8^h[255&(c^u.charCodeAt(d))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(r,n,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(r,n,a){var i=null;i=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:i}},{lie:37}],7:[function(r,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=r("pako"),o=r("./utils"),l=r("./stream/GenericWorker"),c=i?"uint8array":"array";function u(f,p){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=p,this.meta={}}a.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,f.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(p){f.push({data:p,meta:f.meta})}},a.compressWorker=function(f){return new u("Deflate",f)},a.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,a){function i(h,m){var d,v="";for(d=0;d<m;d++)v+=String.fromCharCode(255&h),h>>>=8;return v}function s(h,m,d,v,g,x){var w,_,S=h.file,E=h.compression,k=x!==c.utf8encode,R=o.transformTo("string",x(S.name)),C=o.transformTo("string",c.utf8encode(S.name)),N=S.comment,X=o.transformTo("string",x(N)),A=o.transformTo("string",c.utf8encode(N)),V=C.length!==S.name.length,T=A.length!==N.length,K="",ne="",Q="",oe=S.dir,j=S.date,ae={crc32:0,compressedSize:0,uncompressedSize:0};m&&!d||(ae.crc32=h.crc32,ae.compressedSize=h.compressedSize,ae.uncompressedSize=h.uncompressedSize);var q=0;m&&(q|=8),k||!V&&!T||(q|=2048);var b=0,H=0;oe&&(b|=16),g==="UNIX"?(H=798,b|=function(B,ee){var xe=B;return B||(xe=ee?16893:33204),(65535&xe)<<16}(S.unixPermissions,oe)):(H=20,b|=function(B){return 63&(B||0)}(S.dosPermissions)),w=j.getUTCHours(),w<<=6,w|=j.getUTCMinutes(),w<<=5,w|=j.getUTCSeconds()/2,_=j.getUTCFullYear()-1980,_<<=4,_|=j.getUTCMonth()+1,_<<=5,_|=j.getUTCDate(),V&&(ne=i(1,1)+i(u(R),4)+C,K+="up"+i(ne.length,2)+ne),T&&(Q=i(1,1)+i(u(X),4)+A,K+="uc"+i(Q.length,2)+Q);var U="";return U+=`
\0`,U+=i(q,2),U+=E.magic,U+=i(w,2),U+=i(_,2),U+=i(ae.crc32,4),U+=i(ae.compressedSize,4),U+=i(ae.uncompressedSize,4),U+=i(R.length,2),U+=i(K.length,2),{fileRecord:f.LOCAL_FILE_HEADER+U+R+K,dirRecord:f.CENTRAL_FILE_HEADER+i(H,2)+U+i(X.length,2)+"\0\0\0\0"+i(b,4)+i(v,4)+R+K+X}}var o=r("../utils"),l=r("../stream/GenericWorker"),c=r("../utf8"),u=r("../crc32"),f=r("../signature");function p(h,m,d,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=d,this.encodeFileName=v,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(p,l),p.prototype.push=function(h){var m=h.meta.percent||0,d=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,l.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:d?(m+100*(d-v-1))/d:100}}))},p.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var m=this.streamFiles&&!h.file.dir;if(m){var d=s(h,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:d.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(h){this.accumulate=!1;var m=this.streamFiles&&!h.file.dir,d=s(h,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(d.dirRecord),m)this.push({data:function(v){return f.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:d.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var h=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var d=this.bytesWritten-h,v=function(g,x,w,_,S){var E=o.transformTo("string",S(_));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(g,2)+i(g,2)+i(x,4)+i(w,4)+i(E.length,2)+E}(this.dirRecords.length,d,h,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(h){this._sources.push(h);var m=this;return h.on("data",function(d){m.processChunk(d)}),h.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),h.on("error",function(d){m.error(d)}),this},p.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(h){var m=this._sources;if(!l.prototype.error.call(this,h))return!1;for(var d=0;d<m.length;d++)try{m[d].error(h)}catch{}return!0},p.prototype.lock=function(){l.prototype.lock.call(this);for(var h=this._sources,m=0;m<h.length;m++)h[m].lock()},n.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,a){var i=r("../compressions"),s=r("./ZipFileWorker");a.generateWorker=function(o,l,c){var u=new s(l.streamFiles,c,l.platform,l.encodeFileName),f=0;try{o.forEach(function(p,h){f++;var m=function(x,w){var _=x||w,S=i[_];if(!S)throw new Error(_+" is not a valid compression method !");return S}(h.options.compression,l.compression),d=h.options.compressionOptions||l.compressionOptions||{},v=h.dir,g=h.date;h._compressWorker(m,d).withStreamInfo("file",{name:p,dir:v,date:g,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(u)}),u.entriesCount=f}catch(p){u.error(p)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,a){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var o in this)typeof this[o]!="function"&&(s[o]=this[o]);return s}}(i.prototype=r("./object")).loadAsync=r("./load"),i.support=r("./support"),i.defaults=r("./defaults"),i.version="3.10.1",i.loadAsync=function(s,o){return new i().loadAsync(s,o)},i.external=r("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,a){var i=r("./utils"),s=r("./external"),o=r("./utf8"),l=r("./zipEntries"),c=r("./stream/Crc32Probe"),u=r("./nodejsUtils");function f(p){return new s.Promise(function(h,m){var d=p.decompressed.getContentWorker().pipe(new c);d.on("error",function(v){m(v)}).on("end",function(){d.streamInfo.crc32!==p.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}n.exports=function(p,h){var m=this;return h=i.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(p)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",p,!0,h.optimizedBinaryString,h.base64).then(function(d){var v=new l(h);return v.load(d),v}).then(function(d){var v=[s.Promise.resolve(d)],g=d.files;if(h.checkCRC32)for(var x=0;x<g.length;x++)v.push(f(g[x]));return s.Promise.all(v)}).then(function(d){for(var v=d.shift(),g=v.files,x=0;x<g.length;x++){var w=g[x],_=w.fileNameStr,S=i.resolve(w.fileNameStr);m.file(S,w.decompressed,{binary:!0,optimizedBinaryString:!0,date:w.date,dir:w.dir,comment:w.fileCommentStr.length?w.fileCommentStr:null,unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions,createFolders:h.createFolders}),w.dir||(m.file(S).unsafeOriginalName=_)}return v.zipComment.length&&(m.comment=v.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,a){var i=r("../utils"),s=r("../stream/GenericWorker");function o(l,c){s.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(o,s),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,a){var i=r("readable-stream").Readable;function s(o,l,c){i.call(this,l),this._helper=o;var u=this;o.on("data",function(f,p){u.push(f)||u._helper.pause(),c&&c(p)}).on("error",function(f){u.emit("error",f)}).on("end",function(){u.push(null)})}r("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},n.exports=s},{"../utils":32,"readable-stream":16}],14:[function(r,n,a){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,s)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var s=new Buffer(i);return s.fill(0),s},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(r,n,a){function i(S,E,k){var R,C=o.getTypeOf(E),N=o.extend(k||{},u);N.date=N.date||new Date,N.compression!==null&&(N.compression=N.compression.toUpperCase()),typeof N.unixPermissions=="string"&&(N.unixPermissions=parseInt(N.unixPermissions,8)),N.unixPermissions&&16384&N.unixPermissions&&(N.dir=!0),N.dosPermissions&&16&N.dosPermissions&&(N.dir=!0),N.dir&&(S=g(S)),N.createFolders&&(R=v(S))&&x.call(this,R,!0);var X=C==="string"&&N.binary===!1&&N.base64===!1;k&&k.binary!==void 0||(N.binary=!X),(E instanceof f&&E.uncompressedSize===0||N.dir||!E||E.length===0)&&(N.base64=!1,N.binary=!0,E="",N.compression="STORE",C="string");var A=null;A=E instanceof f||E instanceof l?E:m.isNode&&m.isStream(E)?new d(S,E):o.prepareContent(S,E,N.binary,N.optimizedBinaryString,N.base64);var V=new p(S,A,N);this.files[S]=V}var s=r("./utf8"),o=r("./utils"),l=r("./stream/GenericWorker"),c=r("./stream/StreamHelper"),u=r("./defaults"),f=r("./compressedObject"),p=r("./zipObject"),h=r("./generate"),m=r("./nodejsUtils"),d=r("./nodejs/NodejsStreamInputAdapter"),v=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var E=S.lastIndexOf("/");return 0<E?S.substring(0,E):""},g=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},x=function(S,E){return E=E!==void 0?E:u.createFolders,S=g(S),this.files[S]||i.call(this,S,null,{dir:!0,createFolders:E}),this.files[S]};function w(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var _={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var E,k,R;for(E in this.files)R=this.files[E],(k=E.slice(this.root.length,E.length))&&E.slice(0,this.root.length)===this.root&&S(k,R)},filter:function(S){var E=[];return this.forEach(function(k,R){S(k,R)&&E.push(R)}),E},file:function(S,E,k){if(arguments.length!==1)return S=this.root+S,i.call(this,S,E,k),this;if(w(S)){var R=S;return this.filter(function(N,X){return!X.dir&&R.test(N)})}var C=this.files[this.root+S];return C&&!C.dir?C:null},folder:function(S){if(!S)return this;if(w(S))return this.filter(function(C,N){return N.dir&&S.test(C)});var E=this.root+S,k=x.call(this,E),R=this.clone();return R.root=k.name,R},remove:function(S){S=this.root+S;var E=this.files[S];if(E||(S.slice(-1)!=="/"&&(S+="/"),E=this.files[S]),E&&!E.dir)delete this.files[S];else for(var k=this.filter(function(C,N){return N.name.slice(0,S.length)===S}),R=0;R<k.length;R++)delete this.files[k[R].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var E,k={};try{if((k=o.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=k.type.toLowerCase(),k.compression=k.compression.toUpperCase(),k.type==="binarystring"&&(k.type="string"),!k.type)throw new Error("No output type specified.");o.checkSupport(k.type),k.platform!=="darwin"&&k.platform!=="freebsd"&&k.platform!=="linux"&&k.platform!=="sunos"||(k.platform="UNIX"),k.platform==="win32"&&(k.platform="DOS");var R=k.comment||this.comment||"";E=h.generateWorker(this,k,R)}catch(C){(E=new l("error")).error(C)}return new c(E,k.type||"string",k.mimeType)},generateAsync:function(S,E){return this.generateInternalStream(S).accumulate(E)},generateNodeStream:function(S,E){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(E)}};n.exports=_},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,a){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,a){var i=r("./DataReader");function s(o){i.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}r("../utils").inherits(s,i),s.prototype.byteAt=function(o){return this.data[this.zero+o]},s.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),f=o.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===l&&this.data[p+1]===c&&this.data[p+2]===u&&this.data[p+3]===f)return p-this.zero;return-1},s.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),f=o.charCodeAt(3),p=this.readData(4);return l===p[0]&&c===p[1]&&u===p[2]&&f===p[3]},s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./DataReader":18}],18:[function(r,n,a){var i=r("../utils");function s(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},n.exports=s},{"../utils":32}],19:[function(r,n,a){var i=r("./Uint8ArrayReader");function s(o){i.call(this,o)}r("../utils").inherits(s,i),s.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,a){var i=r("./DataReader");function s(o){i.call(this,o)}r("../utils").inherits(s,i),s.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},s.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},s.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},s.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./DataReader":18}],21:[function(r,n,a){var i=r("./ArrayReader");function s(o){i.call(this,o)}r("../utils").inherits(s,i),s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,a){var i=r("../utils"),s=r("../support"),o=r("./ArrayReader"),l=r("./StringReader"),c=r("./NodeBufferReader"),u=r("./Uint8ArrayReader");n.exports=function(f){var p=i.getTypeOf(f);return i.checkSupport(p),p!=="string"||s.uint8array?p==="nodebuffer"?new c(f):s.uint8array?new u(i.transformTo("uint8array",f)):new o(i.transformTo("array",f)):new l(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,a){var i=r("./GenericWorker"),s=r("../utils");function o(l){i.call(this,"ConvertWorker to "+l),this.destType=l}s.inherits(o,i),o.prototype.processChunk=function(l){this.push({data:s.transformTo(this.destType,l.data),meta:l.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,a){var i=r("./GenericWorker"),s=r("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(o,i),o.prototype.processChunk=function(l){this.streamInfo.crc32=s(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,a){var i=r("../utils"),s=r("./GenericWorker");function o(l){s.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(o,s),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}s.prototype.processChunk.call(this,l)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,a){var i=r("../utils"),s=r("./GenericWorker");function o(l){s.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=i.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}i.inherits(o,s),o.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,a){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,o){return this._listeners[s].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,o){if(this._listeners[s])for(var l=0;l<this._listeners[s].length;l++)this._listeners[s][l].call(this,o)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var o=this;return s.on("data",function(l){o.processChunk(l)}),s.on("end",function(){o.end()}),s.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,o){return this.extraStreamInfo[s]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},n.exports=i},{}],29:[function(r,n,a){var i=r("../utils"),s=r("./ConvertWorker"),o=r("./GenericWorker"),l=r("../base64"),c=r("../support"),u=r("../external"),f=null;if(c.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(m,d){return new u.Promise(function(v,g){var x=[],w=m._internalType,_=m._outputType,S=m._mimeType;m.on("data",function(E,k){x.push(E),d&&d(k)}).on("error",function(E){x=[],g(E)}).on("end",function(){try{var E=function(k,R,C){switch(k){case"blob":return i.newBlob(i.transformTo("arraybuffer",R),C);case"base64":return l.encode(R);default:return i.transformTo(k,R)}}(_,function(k,R){var C,N=0,X=null,A=0;for(C=0;C<R.length;C++)A+=R[C].length;switch(k){case"string":return R.join("");case"array":return Array.prototype.concat.apply([],R);case"uint8array":for(X=new Uint8Array(A),C=0;C<R.length;C++)X.set(R[C],N),N+=R[C].length;return X;case"nodebuffer":return Buffer.concat(R);default:throw new Error("concat : unsupported type '"+k+"'")}}(w,x),S);v(E)}catch(k){g(k)}x=[]}).resume()})}function h(m,d,v){var g=d;switch(d){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=d,this._mimeType=v,i.checkSupport(g),this._worker=m.pipe(new s(g)),m.lock()}catch(x){this._worker=new o("error"),this._worker.error(x)}}h.prototype={accumulate:function(m){return p(this,m)},on:function(m,d){var v=this;return m==="data"?this._worker.on(m,function(g){d.call(v,g.data,g.meta)}):this._worker.on(m,function(){i.delay(d,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},m)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var i=new ArrayBuffer(0);try{a.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),a.blob=s.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!r("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,a){for(var i=r("./utils"),s=r("./support"),o=r("./nodejsUtils"),l=r("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function f(){l.call(this,"utf-8 decode"),this.leftOver=null}function p(){l.call(this,"utf-8 encode")}a.utf8encode=function(h){return s.nodebuffer?o.newBufferFrom(h,"utf-8"):function(m){var d,v,g,x,w,_=m.length,S=0;for(x=0;x<_;x++)(64512&(v=m.charCodeAt(x)))==55296&&x+1<_&&(64512&(g=m.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(g-56320),x++),S+=v<128?1:v<2048?2:v<65536?3:4;for(d=s.uint8array?new Uint8Array(S):new Array(S),x=w=0;w<S;x++)(64512&(v=m.charCodeAt(x)))==55296&&x+1<_&&(64512&(g=m.charCodeAt(x+1)))==56320&&(v=65536+(v-55296<<10)+(g-56320),x++),v<128?d[w++]=v:(v<2048?d[w++]=192|v>>>6:(v<65536?d[w++]=224|v>>>12:(d[w++]=240|v>>>18,d[w++]=128|v>>>12&63),d[w++]=128|v>>>6&63),d[w++]=128|63&v);return d}(h)},a.utf8decode=function(h){return s.nodebuffer?i.transformTo("nodebuffer",h).toString("utf-8"):function(m){var d,v,g,x,w=m.length,_=new Array(2*w);for(d=v=0;d<w;)if((g=m[d++])<128)_[v++]=g;else if(4<(x=c[g]))_[v++]=65533,d+=x-1;else{for(g&=x===2?31:x===3?15:7;1<x&&d<w;)g=g<<6|63&m[d++],x--;1<x?_[v++]=65533:g<65536?_[v++]=g:(g-=65536,_[v++]=55296|g>>10&1023,_[v++]=56320|1023&g)}return _.length!==v&&(_.subarray?_=_.subarray(0,v):_.length=v),i.applyFromCharCode(_)}(h=i.transformTo(s.uint8array?"uint8array":"array",h))},i.inherits(f,l),f.prototype.processChunk=function(h){var m=i.transformTo(s.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var d=m;(m=new Uint8Array(d.length+this.leftOver.length)).set(this.leftOver,0),m.set(d,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var v=function(x,w){var _;for((w=w||x.length)>x.length&&(w=x.length),_=w-1;0<=_&&(192&x[_])==128;)_--;return _<0||_===0?w:_+c[x[_]]>w?_:w}(m),g=m;v!==m.length&&(s.uint8array?(g=m.subarray(0,v),this.leftOver=m.subarray(v,m.length)):(g=m.slice(0,v),this.leftOver=m.slice(v,m.length))),this.push({data:a.utf8decode(g),meta:h.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=f,i.inherits(p,l),p.prototype.processChunk=function(h){this.push({data:a.utf8encode(h.data),meta:h.meta})},a.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,a){var i=r("./support"),s=r("./base64"),o=r("./nodejsUtils"),l=r("./external");function c(d){return d}function u(d,v){for(var g=0;g<d.length;++g)v[g]=255&d.charCodeAt(g);return v}r("setimmediate"),a.newBlob=function(d,v){a.checkSupport("blob");try{return new Blob([d],{type:v})}catch{try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(d),g.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(d,v,g){var x=[],w=0,_=d.length;if(_<=g)return String.fromCharCode.apply(null,d);for(;w<_;)v==="array"||v==="nodebuffer"?x.push(String.fromCharCode.apply(null,d.slice(w,Math.min(w+g,_)))):x.push(String.fromCharCode.apply(null,d.subarray(w,Math.min(w+g,_)))),w+=g;return x.join("")},stringifyByChar:function(d){for(var v="",g=0;g<d.length;g++)v+=String.fromCharCode(d[g]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function p(d){var v=65536,g=a.getTypeOf(d),x=!0;if(g==="uint8array"?x=f.applyCanBeUsed.uint8array:g==="nodebuffer"&&(x=f.applyCanBeUsed.nodebuffer),x)for(;1<v;)try{return f.stringifyByChunk(d,g,v)}catch{v=Math.floor(v/2)}return f.stringifyByChar(d)}function h(d,v){for(var g=0;g<d.length;g++)v[g]=d[g];return v}a.applyFromCharCode=p;var m={};m.string={string:c,array:function(d){return u(d,new Array(d.length))},arraybuffer:function(d){return m.string.uint8array(d).buffer},uint8array:function(d){return u(d,new Uint8Array(d.length))},nodebuffer:function(d){return u(d,o.allocBuffer(d.length))}},m.array={string:p,array:c,arraybuffer:function(d){return new Uint8Array(d).buffer},uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return o.newBufferFrom(d)}},m.arraybuffer={string:function(d){return p(new Uint8Array(d))},array:function(d){return h(new Uint8Array(d),new Array(d.byteLength))},arraybuffer:c,uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return o.newBufferFrom(new Uint8Array(d))}},m.uint8array={string:p,array:function(d){return h(d,new Array(d.length))},arraybuffer:function(d){return d.buffer},uint8array:c,nodebuffer:function(d){return o.newBufferFrom(d)}},m.nodebuffer={string:p,array:function(d){return h(d,new Array(d.length))},arraybuffer:function(d){return m.nodebuffer.uint8array(d).buffer},uint8array:function(d){return h(d,new Uint8Array(d.length))},nodebuffer:c},a.transformTo=function(d,v){if(v=v||"",!d)return v;a.checkSupport(d);var g=a.getTypeOf(v);return m[g][d](v)},a.resolve=function(d){for(var v=d.split("/"),g=[],x=0;x<v.length;x++){var w=v[x];w==="."||w===""&&x!==0&&x!==v.length-1||(w===".."?g.pop():g.push(w))}return g.join("/")},a.getTypeOf=function(d){return typeof d=="string"?"string":Object.prototype.toString.call(d)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(d)?"nodebuffer":i.uint8array&&d instanceof Uint8Array?"uint8array":i.arraybuffer&&d instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(d){if(!i[d.toLowerCase()])throw new Error(d+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(d){var v,g,x="";for(g=0;g<(d||"").length;g++)x+="\\x"+((v=d.charCodeAt(g))<16?"0":"")+v.toString(16).toUpperCase();return x},a.delay=function(d,v,g){setImmediate(function(){d.apply(g||null,v||[])})},a.inherits=function(d,v){function g(){}g.prototype=v.prototype,d.prototype=new g},a.extend=function(){var d,v,g={};for(d=0;d<arguments.length;d++)for(v in arguments[d])Object.prototype.hasOwnProperty.call(arguments[d],v)&&g[v]===void 0&&(g[v]=arguments[d][v]);return g},a.prepareContent=function(d,v,g,x,w){return l.Promise.resolve(v).then(function(_){return i.blob&&(_ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(_))!==-1)&&typeof FileReader<"u"?new l.Promise(function(S,E){var k=new FileReader;k.onload=function(R){S(R.target.result)},k.onerror=function(R){E(R.target.error)},k.readAsArrayBuffer(_)}):_}).then(function(_){var S=a.getTypeOf(_);return S?(S==="arraybuffer"?_=a.transformTo("uint8array",_):S==="string"&&(w?_=s.decode(_):g&&x!==!0&&(_=function(E){return u(E,i.uint8array?new Uint8Array(E.length):new Array(E.length))}(_))),_):l.Promise.reject(new Error("Can't read the data of '"+d+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,a){var i=r("./reader/readerFor"),s=r("./utils"),o=r("./signature"),l=r("./zipEntry"),c=r("./support");function u(f){this.files=[],this.loadOptions=f}u.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(p)+", expected "+s.pretty(f)+")")}},isSignature:function(f,p){var h=this.reader.index;this.reader.setIndex(f);var m=this.reader.readString(4)===p;return this.reader.setIndex(h),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),p=c.uint8array?"uint8array":"array",h=s.transformTo(p,f);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,p,h,m=this.zip64EndOfCentralSize-44;0<m;)f=this.reader.readInt(2),p=this.reader.readInt(4),h=this.reader.readData(p),this.zip64ExtensibleData[f]={id:f,length:p,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,p;for(f=0;f<this.files.length;f++)p=this.files[f],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(f=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var p=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var m=p-h;if(0<m)this.isSignature(p,o.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(f){this.reader=i(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,a){var i=r("./reader/readerFor"),s=r("./utils"),o=r("./compressedObject"),l=r("./crc32"),c=r("./utf8"),u=r("./compressions"),f=r("./support");function p(h,m){this.options=h,this.loadOptions=m}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var m,d;if(h.skip(22),this.fileNameLength=h.readInt(2),d=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(d),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=function(v){for(var g in u)if(Object.prototype.hasOwnProperty.call(u,g)&&u[g].magic===v)return u[g];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,m,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var m=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(m),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var m,d,v,g=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<g;)m=h.readInt(2),d=h.readInt(2),v=h.readData(d),this.extraFields[m]={id:m,length:d,value:v};h.setIndex(g)},handleUTF8:function(){var h=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var d=s.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(d)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var g=s.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var m=i(h.value);return m.readInt(1)!==1||l(this.fileName)!==m.readInt(4)?null:c.utf8decode(m.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var m=i(h.value);return m.readInt(1)!==1||l(this.fileComment)!==m.readInt(4)?null:c.utf8decode(m.readData(h.length-5))}return null}},n.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,a){function i(m,d,v){this.name=m,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=d,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var s=r("./stream/StreamHelper"),o=r("./stream/DataWorker"),l=r("./utf8"),c=r("./compressedObject"),u=r("./stream/GenericWorker");i.prototype={internalStream:function(m){var d=null,v="string";try{if(!m)throw new Error("No output type specified.");var g=(v=m.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),d=this._decompressWorker();var x=!this._dataBinary;x&&!g&&(d=d.pipe(new l.Utf8EncodeWorker)),!x&&g&&(d=d.pipe(new l.Utf8DecodeWorker))}catch(w){(d=new u("error")).error(w)}return new s(d,v,"")},async:function(m,d){return this.internalStream(m).accumulate(d)},nodeStream:function(m,d){return this.internalStream(m||"nodebuffer").toNodejsStream(d)},_compressWorker:function(m,d){if(this._data instanceof c&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(v,m,d)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<f.length;h++)i.prototype[f[h]]=p;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,a){(function(i){var s,o,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,u=new l(m),f=i.document.createTextNode("");u.observe(f,{characterData:!0}),s=function(){f.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var d=i.document.createElement("script");d.onreadystatechange=function(){m(),d.onreadystatechange=null,d.parentNode.removeChild(d),d=null},i.document.documentElement.appendChild(d)}:function(){setTimeout(m,0)};else{var p=new i.MessageChannel;p.port1.onmessage=m,s=function(){p.port2.postMessage(0)}}var h=[];function m(){var d,v;o=!0;for(var g=h.length;g;){for(v=h,h=[],d=-1;++d<g;)v[d]();g=h.length}o=!1}n.exports=function(d){h.push(d)!==1||o||s()}}).call(this,typeof jl<"u"?jl:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,a){var i=r("immediate");function s(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function f(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,g!==s&&d(this,g)}function p(g,x,w){this.promise=g,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}function h(g,x,w){i(function(){var _;try{_=x(w)}catch(S){return o.reject(g,S)}_===g?o.reject(g,new TypeError("Cannot resolve promise with itself")):o.resolve(g,_)})}function m(g){var x=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof x=="function")return function(){x.apply(g,arguments)}}function d(g,x){var w=!1;function _(k){w||(w=!0,o.reject(g,k))}function S(k){w||(w=!0,o.resolve(g,k))}var E=v(function(){x(S,_)});E.status==="error"&&_(E.value)}function v(g,x){var w={};try{w.value=g(x),w.status="success"}catch(_){w.status="error",w.value=_}return w}(n.exports=f).prototype.finally=function(g){if(typeof g!="function")return this;var x=this.constructor;return this.then(function(w){return x.resolve(g()).then(function(){return w})},function(w){return x.resolve(g()).then(function(){throw w})})},f.prototype.catch=function(g){return this.then(null,g)},f.prototype.then=function(g,x){if(typeof g!="function"&&this.state===c||typeof x!="function"&&this.state===l)return this;var w=new this.constructor(s);return this.state!==u?h(w,this.state===c?g:x,this.outcome):this.queue.push(new p(w,g,x)),w},p.prototype.callFulfilled=function(g){o.resolve(this.promise,g)},p.prototype.otherCallFulfilled=function(g){h(this.promise,this.onFulfilled,g)},p.prototype.callRejected=function(g){o.reject(this.promise,g)},p.prototype.otherCallRejected=function(g){h(this.promise,this.onRejected,g)},o.resolve=function(g,x){var w=v(m,x);if(w.status==="error")return o.reject(g,w.value);var _=w.value;if(_)d(g,_);else{g.state=c,g.outcome=x;for(var S=-1,E=g.queue.length;++S<E;)g.queue[S].callFulfilled(x)}return g},o.reject=function(g,x){g.state=l,g.outcome=x;for(var w=-1,_=g.queue.length;++w<_;)g.queue[w].callRejected(x);return g},f.resolve=function(g){return g instanceof this?g:o.resolve(new this(s),g)},f.reject=function(g){var x=new this(s);return o.reject(x,g)},f.all=function(g){var x=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=g.length,_=!1;if(!w)return this.resolve([]);for(var S=new Array(w),E=0,k=-1,R=new this(s);++k<w;)C(g[k],k);return R;function C(N,X){x.resolve(N).then(function(A){S[X]=A,++E!==w||_||(_=!0,o.resolve(R,S))},function(A){_||(_=!0,o.reject(R,A))})}},f.race=function(g){var x=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=g.length,_=!1;if(!w)return this.resolve([]);for(var S=-1,E=new this(s);++S<w;)k=g[S],x.resolve(k).then(function(R){_||(_=!0,o.resolve(E,R))},function(R){_||(_=!0,o.reject(E,R))});var k;return E}},{immediate:36}],38:[function(r,n,a){var i={};(0,r("./lib/utils/common").assign)(i,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,a){var i=r("./zlib/deflate"),s=r("./utils/common"),o=r("./utils/strings"),l=r("./zlib/messages"),c=r("./zlib/zstream"),u=Object.prototype.toString,f=0,p=-1,h=0,m=8;function d(g){if(!(this instanceof d))return new d(g);this.options=s.assign({level:p,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},g||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var w=i.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(w!==f)throw new Error(l[w]);if(x.header&&i.deflateSetHeader(this.strm,x.header),x.dictionary){var _;if(_=typeof x.dictionary=="string"?o.string2buf(x.dictionary):u.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(w=i.deflateSetDictionary(this.strm,_))!==f)throw new Error(l[w]);this._dict_set=!0}}function v(g,x){var w=new d(x);if(w.push(g,!0),w.err)throw w.msg||l[w.err];return w.result}d.prototype.push=function(g,x){var w,_,S=this.strm,E=this.options.chunkSize;if(this.ended)return!1;_=x===~~x?x:x===!0?4:0,typeof g=="string"?S.input=o.string2buf(g):u.call(g)==="[object ArrayBuffer]"?S.input=new Uint8Array(g):S.input=g,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new s.Buf8(E),S.next_out=0,S.avail_out=E),(w=i.deflate(S,_))!==1&&w!==f)return this.onEnd(w),!(this.ended=!0);S.avail_out!==0&&(S.avail_in!==0||_!==4&&_!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(s.shrinkBuf(S.output,S.next_out))):this.onData(s.shrinkBuf(S.output,S.next_out)))}while((0<S.avail_in||S.avail_out===0)&&w!==1);return _===4?(w=i.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===f):_!==2||(this.onEnd(f),!(S.avail_out=0))},d.prototype.onData=function(g){this.chunks.push(g)},d.prototype.onEnd=function(g){g===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},a.Deflate=d,a.deflate=v,a.deflateRaw=function(g,x){return(x=x||{}).raw=!0,v(g,x)},a.gzip=function(g,x){return(x=x||{}).gzip=!0,v(g,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,a){var i=r("./zlib/inflate"),s=r("./utils/common"),o=r("./utils/strings"),l=r("./zlib/constants"),c=r("./zlib/messages"),u=r("./zlib/zstream"),f=r("./zlib/gzheader"),p=Object.prototype.toString;function h(d){if(!(this instanceof h))return new h(d);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},d||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||d&&d.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&!(15&v.windowBits)&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var g=i.inflateInit2(this.strm,v.windowBits);if(g!==l.Z_OK)throw new Error(c[g]);this.header=new f,i.inflateGetHeader(this.strm,this.header)}function m(d,v){var g=new h(v);if(g.push(d,!0),g.err)throw g.msg||c[g.err];return g.result}h.prototype.push=function(d,v){var g,x,w,_,S,E,k=this.strm,R=this.options.chunkSize,C=this.options.dictionary,N=!1;if(this.ended)return!1;x=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof d=="string"?k.input=o.binstring2buf(d):p.call(d)==="[object ArrayBuffer]"?k.input=new Uint8Array(d):k.input=d,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new s.Buf8(R),k.next_out=0,k.avail_out=R),(g=i.inflate(k,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&C&&(E=typeof C=="string"?o.string2buf(C):p.call(C)==="[object ArrayBuffer]"?new Uint8Array(C):C,g=i.inflateSetDictionary(this.strm,E)),g===l.Z_BUF_ERROR&&N===!0&&(g=l.Z_OK,N=!1),g!==l.Z_STREAM_END&&g!==l.Z_OK)return this.onEnd(g),!(this.ended=!0);k.next_out&&(k.avail_out!==0&&g!==l.Z_STREAM_END&&(k.avail_in!==0||x!==l.Z_FINISH&&x!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(w=o.utf8border(k.output,k.next_out),_=k.next_out-w,S=o.buf2string(k.output,w),k.next_out=_,k.avail_out=R-_,_&&s.arraySet(k.output,k.output,w,_,0),this.onData(S)):this.onData(s.shrinkBuf(k.output,k.next_out)))),k.avail_in===0&&k.avail_out===0&&(N=!0)}while((0<k.avail_in||k.avail_out===0)&&g!==l.Z_STREAM_END);return g===l.Z_STREAM_END&&(x=l.Z_FINISH),x===l.Z_FINISH?(g=i.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===l.Z_OK):x!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(k.avail_out=0))},h.prototype.onData=function(d){this.chunks.push(d)},h.prototype.onEnd=function(d){d===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},a.Inflate=h,a.inflate=m,a.inflateRaw=function(d,v){return(v=v||{}).raw=!0,m(d,v)},a.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var f in u)u.hasOwnProperty(f)&&(l[f]=u[f])}}return l},a.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var s={arraySet:function(l,c,u,f,p){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+f),p);else for(var h=0;h<f;h++)l[p+h]=c[u+h]},flattenChunks:function(l){var c,u,f,p,h,m;for(c=f=0,u=l.length;c<u;c++)f+=l[c].length;for(m=new Uint8Array(f),c=p=0,u=l.length;c<u;c++)h=l[c],m.set(h,p),p+=h.length;return m}},o={arraySet:function(l,c,u,f,p){for(var h=0;h<f;h++)l[p+h]=c[u+h]},flattenChunks:function(l){return[].concat.apply([],l)}};a.setTyped=function(l){l?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,s)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,o))},a.setTyped(i)},{}],42:[function(r,n,a){var i=r("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(f,p){if(p<65537&&(f.subarray&&o||!f.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(f,p));for(var h="",m=0;m<p;m++)h+=String.fromCharCode(f[m]);return h}l[254]=l[254]=1,a.string2buf=function(f){var p,h,m,d,v,g=f.length,x=0;for(d=0;d<g;d++)(64512&(h=f.charCodeAt(d)))==55296&&d+1<g&&(64512&(m=f.charCodeAt(d+1)))==56320&&(h=65536+(h-55296<<10)+(m-56320),d++),x+=h<128?1:h<2048?2:h<65536?3:4;for(p=new i.Buf8(x),d=v=0;v<x;d++)(64512&(h=f.charCodeAt(d)))==55296&&d+1<g&&(64512&(m=f.charCodeAt(d+1)))==56320&&(h=65536+(h-55296<<10)+(m-56320),d++),h<128?p[v++]=h:(h<2048?p[v++]=192|h>>>6:(h<65536?p[v++]=224|h>>>12:(p[v++]=240|h>>>18,p[v++]=128|h>>>12&63),p[v++]=128|h>>>6&63),p[v++]=128|63&h);return p},a.buf2binstring=function(f){return u(f,f.length)},a.binstring2buf=function(f){for(var p=new i.Buf8(f.length),h=0,m=p.length;h<m;h++)p[h]=f.charCodeAt(h);return p},a.buf2string=function(f,p){var h,m,d,v,g=p||f.length,x=new Array(2*g);for(h=m=0;h<g;)if((d=f[h++])<128)x[m++]=d;else if(4<(v=l[d]))x[m++]=65533,h+=v-1;else{for(d&=v===2?31:v===3?15:7;1<v&&h<g;)d=d<<6|63&f[h++],v--;1<v?x[m++]=65533:d<65536?x[m++]=d:(d-=65536,x[m++]=55296|d>>10&1023,x[m++]=56320|1023&d)}return u(x,m)},a.utf8border=function(f,p){var h;for((p=p||f.length)>f.length&&(p=f.length),h=p-1;0<=h&&(192&f[h])==128;)h--;return h<0||h===0?p:h+l[f[h]]>p?h:p}},{"./common":41}],43:[function(r,n,a){n.exports=function(i,s,o,l){for(var c=65535&i|0,u=i>>>16&65535|0,f=0;o!==0;){for(o-=f=2e3<o?2e3:o;u=u+(c=c+s[l++]|0)|0,--f;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(r,n,a){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,a){var i=function(){for(var s,o=[],l=0;l<256;l++){s=l;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;o[l]=s}return o}();n.exports=function(s,o,l,c){var u=i,f=c+l;s^=-1;for(var p=c;p<f;p++)s=s>>>8^u[255&(s^o[p])];return-1^s}},{}],46:[function(r,n,a){var i,s=r("../utils/common"),o=r("./trees"),l=r("./adler32"),c=r("./crc32"),u=r("./messages"),f=0,p=4,h=0,m=-2,d=-1,v=4,g=2,x=8,w=9,_=286,S=30,E=19,k=2*_+1,R=15,C=3,N=258,X=N+C+1,A=42,V=113,T=1,K=2,ne=3,Q=4;function oe(y,Z){return y.msg=u[Z],Z}function j(y){return(y<<1)-(4<y?9:0)}function ae(y){for(var Z=y.length;0<=--Z;)y[Z]=0}function q(y){var Z=y.state,J=Z.pending;J>y.avail_out&&(J=y.avail_out),J!==0&&(s.arraySet(y.output,Z.pending_buf,Z.pending_out,J,y.next_out),y.next_out+=J,Z.pending_out+=J,y.total_out+=J,y.avail_out-=J,Z.pending-=J,Z.pending===0&&(Z.pending_out=0))}function b(y,Z){o._tr_flush_block(y,0<=y.block_start?y.block_start:-1,y.strstart-y.block_start,Z),y.block_start=y.strstart,q(y.strm)}function H(y,Z){y.pending_buf[y.pending++]=Z}function U(y,Z){y.pending_buf[y.pending++]=Z>>>8&255,y.pending_buf[y.pending++]=255&Z}function B(y,Z){var J,P,I=y.max_chain_length,Y=y.strstart,ue=y.prev_length,pe=y.nice_match,te=y.strstart>y.w_size-X?y.strstart-(y.w_size-X):0,_e=y.window,Ae=y.w_mask,ke=y.prev,Re=y.strstart+N,et=_e[Y+ue-1],Be=_e[Y+ue];y.prev_length>=y.good_match&&(I>>=2),pe>y.lookahead&&(pe=y.lookahead);do if(_e[(J=Z)+ue]===Be&&_e[J+ue-1]===et&&_e[J]===_e[Y]&&_e[++J]===_e[Y+1]){Y+=2,J++;do;while(_e[++Y]===_e[++J]&&_e[++Y]===_e[++J]&&_e[++Y]===_e[++J]&&_e[++Y]===_e[++J]&&_e[++Y]===_e[++J]&&_e[++Y]===_e[++J]&&_e[++Y]===_e[++J]&&_e[++Y]===_e[++J]&&Y<Re);if(P=N-(Re-Y),Y=Re-N,ue<P){if(y.match_start=Z,pe<=(ue=P))break;et=_e[Y+ue-1],Be=_e[Y+ue]}}while((Z=ke[Z&Ae])>te&&--I!=0);return ue<=y.lookahead?ue:y.lookahead}function ee(y){var Z,J,P,I,Y,ue,pe,te,_e,Ae,ke=y.w_size;do{if(I=y.window_size-y.lookahead-y.strstart,y.strstart>=ke+(ke-X)){for(s.arraySet(y.window,y.window,ke,ke,0),y.match_start-=ke,y.strstart-=ke,y.block_start-=ke,Z=J=y.hash_size;P=y.head[--Z],y.head[Z]=ke<=P?P-ke:0,--J;);for(Z=J=ke;P=y.prev[--Z],y.prev[Z]=ke<=P?P-ke:0,--J;);I+=ke}if(y.strm.avail_in===0)break;if(ue=y.strm,pe=y.window,te=y.strstart+y.lookahead,_e=I,Ae=void 0,Ae=ue.avail_in,_e<Ae&&(Ae=_e),J=Ae===0?0:(ue.avail_in-=Ae,s.arraySet(pe,ue.input,ue.next_in,Ae,te),ue.state.wrap===1?ue.adler=l(ue.adler,pe,Ae,te):ue.state.wrap===2&&(ue.adler=c(ue.adler,pe,Ae,te)),ue.next_in+=Ae,ue.total_in+=Ae,Ae),y.lookahead+=J,y.lookahead+y.insert>=C)for(Y=y.strstart-y.insert,y.ins_h=y.window[Y],y.ins_h=(y.ins_h<<y.hash_shift^y.window[Y+1])&y.hash_mask;y.insert&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[Y+C-1])&y.hash_mask,y.prev[Y&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=Y,Y++,y.insert--,!(y.lookahead+y.insert<C)););}while(y.lookahead<X&&y.strm.avail_in!==0)}function xe(y,Z){for(var J,P;;){if(y.lookahead<X){if(ee(y),y.lookahead<X&&Z===f)return T;if(y.lookahead===0)break}if(J=0,y.lookahead>=C&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,J=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),J!==0&&y.strstart-J<=y.w_size-X&&(y.match_length=B(y,J)),y.match_length>=C)if(P=o._tr_tally(y,y.strstart-y.match_start,y.match_length-C),y.lookahead-=y.match_length,y.match_length<=y.max_lazy_match&&y.lookahead>=C){for(y.match_length--;y.strstart++,y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,J=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart,--y.match_length!=0;);y.strstart++}else y.strstart+=y.match_length,y.match_length=0,y.ins_h=y.window[y.strstart],y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+1])&y.hash_mask;else P=o._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++;if(P&&(b(y,!1),y.strm.avail_out===0))return T}return y.insert=y.strstart<C-1?y.strstart:C-1,Z===p?(b(y,!0),y.strm.avail_out===0?ne:Q):y.last_lit&&(b(y,!1),y.strm.avail_out===0)?T:K}function de(y,Z){for(var J,P,I;;){if(y.lookahead<X){if(ee(y),y.lookahead<X&&Z===f)return T;if(y.lookahead===0)break}if(J=0,y.lookahead>=C&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,J=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),y.prev_length=y.match_length,y.prev_match=y.match_start,y.match_length=C-1,J!==0&&y.prev_length<y.max_lazy_match&&y.strstart-J<=y.w_size-X&&(y.match_length=B(y,J),y.match_length<=5&&(y.strategy===1||y.match_length===C&&4096<y.strstart-y.match_start)&&(y.match_length=C-1)),y.prev_length>=C&&y.match_length<=y.prev_length){for(I=y.strstart+y.lookahead-C,P=o._tr_tally(y,y.strstart-1-y.prev_match,y.prev_length-C),y.lookahead-=y.prev_length-1,y.prev_length-=2;++y.strstart<=I&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+C-1])&y.hash_mask,J=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),--y.prev_length!=0;);if(y.match_available=0,y.match_length=C-1,y.strstart++,P&&(b(y,!1),y.strm.avail_out===0))return T}else if(y.match_available){if((P=o._tr_tally(y,0,y.window[y.strstart-1]))&&b(y,!1),y.strstart++,y.lookahead--,y.strm.avail_out===0)return T}else y.match_available=1,y.strstart++,y.lookahead--}return y.match_available&&(P=o._tr_tally(y,0,y.window[y.strstart-1]),y.match_available=0),y.insert=y.strstart<C-1?y.strstart:C-1,Z===p?(b(y,!0),y.strm.avail_out===0?ne:Q):y.last_lit&&(b(y,!1),y.strm.avail_out===0)?T:K}function he(y,Z,J,P,I){this.good_length=y,this.max_lazy=Z,this.nice_length=J,this.max_chain=P,this.func=I}function ve(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*k),this.dyn_dtree=new s.Buf16(2*(2*S+1)),this.bl_tree=new s.Buf16(2*(2*E+1)),ae(this.dyn_ltree),ae(this.dyn_dtree),ae(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(R+1),this.heap=new s.Buf16(2*_+1),ae(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*_+1),ae(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ie(y){var Z;return y&&y.state?(y.total_in=y.total_out=0,y.data_type=g,(Z=y.state).pending=0,Z.pending_out=0,Z.wrap<0&&(Z.wrap=-Z.wrap),Z.status=Z.wrap?A:V,y.adler=Z.wrap===2?0:1,Z.last_flush=f,o._tr_init(Z),h):oe(y,m)}function O(y){var Z=ie(y);return Z===h&&function(J){J.window_size=2*J.w_size,ae(J.head),J.max_lazy_match=i[J.level].max_lazy,J.good_match=i[J.level].good_length,J.nice_match=i[J.level].nice_length,J.max_chain_length=i[J.level].max_chain,J.strstart=0,J.block_start=0,J.lookahead=0,J.insert=0,J.match_length=J.prev_length=C-1,J.match_available=0,J.ins_h=0}(y.state),Z}function we(y,Z,J,P,I,Y){if(!y)return m;var ue=1;if(Z===d&&(Z=6),P<0?(ue=0,P=-P):15<P&&(ue=2,P-=16),I<1||w<I||J!==x||P<8||15<P||Z<0||9<Z||Y<0||v<Y)return oe(y,m);P===8&&(P=9);var pe=new ve;return(y.state=pe).strm=y,pe.wrap=ue,pe.gzhead=null,pe.w_bits=P,pe.w_size=1<<pe.w_bits,pe.w_mask=pe.w_size-1,pe.hash_bits=I+7,pe.hash_size=1<<pe.hash_bits,pe.hash_mask=pe.hash_size-1,pe.hash_shift=~~((pe.hash_bits+C-1)/C),pe.window=new s.Buf8(2*pe.w_size),pe.head=new s.Buf16(pe.hash_size),pe.prev=new s.Buf16(pe.w_size),pe.lit_bufsize=1<<I+6,pe.pending_buf_size=4*pe.lit_bufsize,pe.pending_buf=new s.Buf8(pe.pending_buf_size),pe.d_buf=1*pe.lit_bufsize,pe.l_buf=3*pe.lit_bufsize,pe.level=Z,pe.strategy=Y,pe.method=J,O(y)}i=[new he(0,0,0,0,function(y,Z){var J=65535;for(J>y.pending_buf_size-5&&(J=y.pending_buf_size-5);;){if(y.lookahead<=1){if(ee(y),y.lookahead===0&&Z===f)return T;if(y.lookahead===0)break}y.strstart+=y.lookahead,y.lookahead=0;var P=y.block_start+J;if((y.strstart===0||y.strstart>=P)&&(y.lookahead=y.strstart-P,y.strstart=P,b(y,!1),y.strm.avail_out===0)||y.strstart-y.block_start>=y.w_size-X&&(b(y,!1),y.strm.avail_out===0))return T}return y.insert=0,Z===p?(b(y,!0),y.strm.avail_out===0?ne:Q):(y.strstart>y.block_start&&(b(y,!1),y.strm.avail_out),T)}),new he(4,4,8,4,xe),new he(4,5,16,8,xe),new he(4,6,32,32,xe),new he(4,4,16,16,de),new he(8,16,32,32,de),new he(8,16,128,128,de),new he(8,32,128,256,de),new he(32,128,258,1024,de),new he(32,258,258,4096,de)],a.deflateInit=function(y,Z){return we(y,Z,x,15,8,0)},a.deflateInit2=we,a.deflateReset=O,a.deflateResetKeep=ie,a.deflateSetHeader=function(y,Z){return y&&y.state?y.state.wrap!==2?m:(y.state.gzhead=Z,h):m},a.deflate=function(y,Z){var J,P,I,Y;if(!y||!y.state||5<Z||Z<0)return y?oe(y,m):m;if(P=y.state,!y.output||!y.input&&y.avail_in!==0||P.status===666&&Z!==p)return oe(y,y.avail_out===0?-5:m);if(P.strm=y,J=P.last_flush,P.last_flush=Z,P.status===A)if(P.wrap===2)y.adler=0,H(P,31),H(P,139),H(P,8),P.gzhead?(H(P,(P.gzhead.text?1:0)+(P.gzhead.hcrc?2:0)+(P.gzhead.extra?4:0)+(P.gzhead.name?8:0)+(P.gzhead.comment?16:0)),H(P,255&P.gzhead.time),H(P,P.gzhead.time>>8&255),H(P,P.gzhead.time>>16&255),H(P,P.gzhead.time>>24&255),H(P,P.level===9?2:2<=P.strategy||P.level<2?4:0),H(P,255&P.gzhead.os),P.gzhead.extra&&P.gzhead.extra.length&&(H(P,255&P.gzhead.extra.length),H(P,P.gzhead.extra.length>>8&255)),P.gzhead.hcrc&&(y.adler=c(y.adler,P.pending_buf,P.pending,0)),P.gzindex=0,P.status=69):(H(P,0),H(P,0),H(P,0),H(P,0),H(P,0),H(P,P.level===9?2:2<=P.strategy||P.level<2?4:0),H(P,3),P.status=V);else{var ue=x+(P.w_bits-8<<4)<<8;ue|=(2<=P.strategy||P.level<2?0:P.level<6?1:P.level===6?2:3)<<6,P.strstart!==0&&(ue|=32),ue+=31-ue%31,P.status=V,U(P,ue),P.strstart!==0&&(U(P,y.adler>>>16),U(P,65535&y.adler)),y.adler=1}if(P.status===69)if(P.gzhead.extra){for(I=P.pending;P.gzindex<(65535&P.gzhead.extra.length)&&(P.pending!==P.pending_buf_size||(P.gzhead.hcrc&&P.pending>I&&(y.adler=c(y.adler,P.pending_buf,P.pending-I,I)),q(y),I=P.pending,P.pending!==P.pending_buf_size));)H(P,255&P.gzhead.extra[P.gzindex]),P.gzindex++;P.gzhead.hcrc&&P.pending>I&&(y.adler=c(y.adler,P.pending_buf,P.pending-I,I)),P.gzindex===P.gzhead.extra.length&&(P.gzindex=0,P.status=73)}else P.status=73;if(P.status===73)if(P.gzhead.name){I=P.pending;do{if(P.pending===P.pending_buf_size&&(P.gzhead.hcrc&&P.pending>I&&(y.adler=c(y.adler,P.pending_buf,P.pending-I,I)),q(y),I=P.pending,P.pending===P.pending_buf_size)){Y=1;break}Y=P.gzindex<P.gzhead.name.length?255&P.gzhead.name.charCodeAt(P.gzindex++):0,H(P,Y)}while(Y!==0);P.gzhead.hcrc&&P.pending>I&&(y.adler=c(y.adler,P.pending_buf,P.pending-I,I)),Y===0&&(P.gzindex=0,P.status=91)}else P.status=91;if(P.status===91)if(P.gzhead.comment){I=P.pending;do{if(P.pending===P.pending_buf_size&&(P.gzhead.hcrc&&P.pending>I&&(y.adler=c(y.adler,P.pending_buf,P.pending-I,I)),q(y),I=P.pending,P.pending===P.pending_buf_size)){Y=1;break}Y=P.gzindex<P.gzhead.comment.length?255&P.gzhead.comment.charCodeAt(P.gzindex++):0,H(P,Y)}while(Y!==0);P.gzhead.hcrc&&P.pending>I&&(y.adler=c(y.adler,P.pending_buf,P.pending-I,I)),Y===0&&(P.status=103)}else P.status=103;if(P.status===103&&(P.gzhead.hcrc?(P.pending+2>P.pending_buf_size&&q(y),P.pending+2<=P.pending_buf_size&&(H(P,255&y.adler),H(P,y.adler>>8&255),y.adler=0,P.status=V)):P.status=V),P.pending!==0){if(q(y),y.avail_out===0)return P.last_flush=-1,h}else if(y.avail_in===0&&j(Z)<=j(J)&&Z!==p)return oe(y,-5);if(P.status===666&&y.avail_in!==0)return oe(y,-5);if(y.avail_in!==0||P.lookahead!==0||Z!==f&&P.status!==666){var pe=P.strategy===2?function(te,_e){for(var Ae;;){if(te.lookahead===0&&(ee(te),te.lookahead===0)){if(_e===f)return T;break}if(te.match_length=0,Ae=o._tr_tally(te,0,te.window[te.strstart]),te.lookahead--,te.strstart++,Ae&&(b(te,!1),te.strm.avail_out===0))return T}return te.insert=0,_e===p?(b(te,!0),te.strm.avail_out===0?ne:Q):te.last_lit&&(b(te,!1),te.strm.avail_out===0)?T:K}(P,Z):P.strategy===3?function(te,_e){for(var Ae,ke,Re,et,Be=te.window;;){if(te.lookahead<=N){if(ee(te),te.lookahead<=N&&_e===f)return T;if(te.lookahead===0)break}if(te.match_length=0,te.lookahead>=C&&0<te.strstart&&(ke=Be[Re=te.strstart-1])===Be[++Re]&&ke===Be[++Re]&&ke===Be[++Re]){et=te.strstart+N;do;while(ke===Be[++Re]&&ke===Be[++Re]&&ke===Be[++Re]&&ke===Be[++Re]&&ke===Be[++Re]&&ke===Be[++Re]&&ke===Be[++Re]&&ke===Be[++Re]&&Re<et);te.match_length=N-(et-Re),te.match_length>te.lookahead&&(te.match_length=te.lookahead)}if(te.match_length>=C?(Ae=o._tr_tally(te,1,te.match_length-C),te.lookahead-=te.match_length,te.strstart+=te.match_length,te.match_length=0):(Ae=o._tr_tally(te,0,te.window[te.strstart]),te.lookahead--,te.strstart++),Ae&&(b(te,!1),te.strm.avail_out===0))return T}return te.insert=0,_e===p?(b(te,!0),te.strm.avail_out===0?ne:Q):te.last_lit&&(b(te,!1),te.strm.avail_out===0)?T:K}(P,Z):i[P.level].func(P,Z);if(pe!==ne&&pe!==Q||(P.status=666),pe===T||pe===ne)return y.avail_out===0&&(P.last_flush=-1),h;if(pe===K&&(Z===1?o._tr_align(P):Z!==5&&(o._tr_stored_block(P,0,0,!1),Z===3&&(ae(P.head),P.lookahead===0&&(P.strstart=0,P.block_start=0,P.insert=0))),q(y),y.avail_out===0))return P.last_flush=-1,h}return Z!==p?h:P.wrap<=0?1:(P.wrap===2?(H(P,255&y.adler),H(P,y.adler>>8&255),H(P,y.adler>>16&255),H(P,y.adler>>24&255),H(P,255&y.total_in),H(P,y.total_in>>8&255),H(P,y.total_in>>16&255),H(P,y.total_in>>24&255)):(U(P,y.adler>>>16),U(P,65535&y.adler)),q(y),0<P.wrap&&(P.wrap=-P.wrap),P.pending!==0?h:1)},a.deflateEnd=function(y){var Z;return y&&y.state?(Z=y.state.status)!==A&&Z!==69&&Z!==73&&Z!==91&&Z!==103&&Z!==V&&Z!==666?oe(y,m):(y.state=null,Z===V?oe(y,-3):h):m},a.deflateSetDictionary=function(y,Z){var J,P,I,Y,ue,pe,te,_e,Ae=Z.length;if(!y||!y.state||(Y=(J=y.state).wrap)===2||Y===1&&J.status!==A||J.lookahead)return m;for(Y===1&&(y.adler=l(y.adler,Z,Ae,0)),J.wrap=0,Ae>=J.w_size&&(Y===0&&(ae(J.head),J.strstart=0,J.block_start=0,J.insert=0),_e=new s.Buf8(J.w_size),s.arraySet(_e,Z,Ae-J.w_size,J.w_size,0),Z=_e,Ae=J.w_size),ue=y.avail_in,pe=y.next_in,te=y.input,y.avail_in=Ae,y.next_in=0,y.input=Z,ee(J);J.lookahead>=C;){for(P=J.strstart,I=J.lookahead-(C-1);J.ins_h=(J.ins_h<<J.hash_shift^J.window[P+C-1])&J.hash_mask,J.prev[P&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=P,P++,--I;);J.strstart=P,J.lookahead=C-1,ee(J)}return J.strstart+=J.lookahead,J.block_start=J.strstart,J.insert=J.lookahead,J.lookahead=0,J.match_length=J.prev_length=C-1,J.match_available=0,y.next_in=pe,y.input=te,y.avail_in=ue,J.wrap=Y,h},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,a){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,a){n.exports=function(i,s){var o,l,c,u,f,p,h,m,d,v,g,x,w,_,S,E,k,R,C,N,X,A,V,T,K;o=i.state,l=i.next_in,T=i.input,c=l+(i.avail_in-5),u=i.next_out,K=i.output,f=u-(s-i.avail_out),p=u+(i.avail_out-257),h=o.dmax,m=o.wsize,d=o.whave,v=o.wnext,g=o.window,x=o.hold,w=o.bits,_=o.lencode,S=o.distcode,E=(1<<o.lenbits)-1,k=(1<<o.distbits)-1;e:do{w<15&&(x+=T[l++]<<w,w+=8,x+=T[l++]<<w,w+=8),R=_[x&E];t:for(;;){if(x>>>=C=R>>>24,w-=C,(C=R>>>16&255)===0)K[u++]=65535&R;else{if(!(16&C)){if(!(64&C)){R=_[(65535&R)+(x&(1<<C)-1)];continue t}if(32&C){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}N=65535&R,(C&=15)&&(w<C&&(x+=T[l++]<<w,w+=8),N+=x&(1<<C)-1,x>>>=C,w-=C),w<15&&(x+=T[l++]<<w,w+=8,x+=T[l++]<<w,w+=8),R=S[x&k];r:for(;;){if(x>>>=C=R>>>24,w-=C,!(16&(C=R>>>16&255))){if(!(64&C)){R=S[(65535&R)+(x&(1<<C)-1)];continue r}i.msg="invalid distance code",o.mode=30;break e}if(X=65535&R,w<(C&=15)&&(x+=T[l++]<<w,(w+=8)<C&&(x+=T[l++]<<w,w+=8)),h<(X+=x&(1<<C)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(x>>>=C,w-=C,(C=u-f)<X){if(d<(C=X-C)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(V=g,(A=0)===v){if(A+=m-C,C<N){for(N-=C;K[u++]=g[A++],--C;);A=u-X,V=K}}else if(v<C){if(A+=m+v-C,(C-=v)<N){for(N-=C;K[u++]=g[A++],--C;);if(A=0,v<N){for(N-=C=v;K[u++]=g[A++],--C;);A=u-X,V=K}}}else if(A+=v-C,C<N){for(N-=C;K[u++]=g[A++],--C;);A=u-X,V=K}for(;2<N;)K[u++]=V[A++],K[u++]=V[A++],K[u++]=V[A++],N-=3;N&&(K[u++]=V[A++],1<N&&(K[u++]=V[A++]))}else{for(A=u-X;K[u++]=K[A++],K[u++]=K[A++],K[u++]=K[A++],2<(N-=3););N&&(K[u++]=K[A++],1<N&&(K[u++]=K[A++]))}break}}break}}while(l<c&&u<p);l-=N=w>>3,x&=(1<<(w-=N<<3))-1,i.next_in=l,i.next_out=u,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=u<p?p-u+257:257-(u-p),o.hold=x,o.bits=w}},{}],49:[function(r,n,a){var i=r("../utils/common"),s=r("./adler32"),o=r("./crc32"),l=r("./inffast"),c=r("./inftrees"),u=1,f=2,p=0,h=-2,m=1,d=852,v=592;function g(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function w(A){var V;return A&&A.state?(V=A.state,A.total_in=A.total_out=V.total=0,A.msg="",V.wrap&&(A.adler=1&V.wrap),V.mode=m,V.last=0,V.havedict=0,V.dmax=32768,V.head=null,V.hold=0,V.bits=0,V.lencode=V.lendyn=new i.Buf32(d),V.distcode=V.distdyn=new i.Buf32(v),V.sane=1,V.back=-1,p):h}function _(A){var V;return A&&A.state?((V=A.state).wsize=0,V.whave=0,V.wnext=0,w(A)):h}function S(A,V){var T,K;return A&&A.state?(K=A.state,V<0?(T=0,V=-V):(T=1+(V>>4),V<48&&(V&=15)),V&&(V<8||15<V)?h:(K.window!==null&&K.wbits!==V&&(K.window=null),K.wrap=T,K.wbits=V,_(A))):h}function E(A,V){var T,K;return A?(K=new x,(A.state=K).window=null,(T=S(A,V))!==p&&(A.state=null),T):h}var k,R,C=!0;function N(A){if(C){var V;for(k=new i.Buf32(512),R=new i.Buf32(32),V=0;V<144;)A.lens[V++]=8;for(;V<256;)A.lens[V++]=9;for(;V<280;)A.lens[V++]=7;for(;V<288;)A.lens[V++]=8;for(c(u,A.lens,0,288,k,0,A.work,{bits:9}),V=0;V<32;)A.lens[V++]=5;c(f,A.lens,0,32,R,0,A.work,{bits:5}),C=!1}A.lencode=k,A.lenbits=9,A.distcode=R,A.distbits=5}function X(A,V,T,K){var ne,Q=A.state;return Q.window===null&&(Q.wsize=1<<Q.wbits,Q.wnext=0,Q.whave=0,Q.window=new i.Buf8(Q.wsize)),K>=Q.wsize?(i.arraySet(Q.window,V,T-Q.wsize,Q.wsize,0),Q.wnext=0,Q.whave=Q.wsize):(K<(ne=Q.wsize-Q.wnext)&&(ne=K),i.arraySet(Q.window,V,T-K,ne,Q.wnext),(K-=ne)?(i.arraySet(Q.window,V,T-K,K,0),Q.wnext=K,Q.whave=Q.wsize):(Q.wnext+=ne,Q.wnext===Q.wsize&&(Q.wnext=0),Q.whave<Q.wsize&&(Q.whave+=ne))),0}a.inflateReset=_,a.inflateReset2=S,a.inflateResetKeep=w,a.inflateInit=function(A){return E(A,15)},a.inflateInit2=E,a.inflate=function(A,V){var T,K,ne,Q,oe,j,ae,q,b,H,U,B,ee,xe,de,he,ve,ie,O,we,y,Z,J,P,I=0,Y=new i.Buf8(4),ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&A.avail_in!==0)return h;(T=A.state).mode===12&&(T.mode=13),oe=A.next_out,ne=A.output,ae=A.avail_out,Q=A.next_in,K=A.input,j=A.avail_in,q=T.hold,b=T.bits,H=j,U=ae,Z=p;e:for(;;)switch(T.mode){case m:if(T.wrap===0){T.mode=13;break}for(;b<16;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}if(2&T.wrap&&q===35615){Y[T.check=0]=255&q,Y[1]=q>>>8&255,T.check=o(T.check,Y,2,0),b=q=0,T.mode=2;break}if(T.flags=0,T.head&&(T.head.done=!1),!(1&T.wrap)||(((255&q)<<8)+(q>>8))%31){A.msg="incorrect header check",T.mode=30;break}if((15&q)!=8){A.msg="unknown compression method",T.mode=30;break}if(b-=4,y=8+(15&(q>>>=4)),T.wbits===0)T.wbits=y;else if(y>T.wbits){A.msg="invalid window size",T.mode=30;break}T.dmax=1<<y,A.adler=T.check=1,T.mode=512&q?10:12,b=q=0;break;case 2:for(;b<16;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}if(T.flags=q,(255&T.flags)!=8){A.msg="unknown compression method",T.mode=30;break}if(57344&T.flags){A.msg="unknown header flags set",T.mode=30;break}T.head&&(T.head.text=q>>8&1),512&T.flags&&(Y[0]=255&q,Y[1]=q>>>8&255,T.check=o(T.check,Y,2,0)),b=q=0,T.mode=3;case 3:for(;b<32;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}T.head&&(T.head.time=q),512&T.flags&&(Y[0]=255&q,Y[1]=q>>>8&255,Y[2]=q>>>16&255,Y[3]=q>>>24&255,T.check=o(T.check,Y,4,0)),b=q=0,T.mode=4;case 4:for(;b<16;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}T.head&&(T.head.xflags=255&q,T.head.os=q>>8),512&T.flags&&(Y[0]=255&q,Y[1]=q>>>8&255,T.check=o(T.check,Y,2,0)),b=q=0,T.mode=5;case 5:if(1024&T.flags){for(;b<16;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}T.length=q,T.head&&(T.head.extra_len=q),512&T.flags&&(Y[0]=255&q,Y[1]=q>>>8&255,T.check=o(T.check,Y,2,0)),b=q=0}else T.head&&(T.head.extra=null);T.mode=6;case 6:if(1024&T.flags&&(j<(B=T.length)&&(B=j),B&&(T.head&&(y=T.head.extra_len-T.length,T.head.extra||(T.head.extra=new Array(T.head.extra_len)),i.arraySet(T.head.extra,K,Q,B,y)),512&T.flags&&(T.check=o(T.check,K,B,Q)),j-=B,Q+=B,T.length-=B),T.length))break e;T.length=0,T.mode=7;case 7:if(2048&T.flags){if(j===0)break e;for(B=0;y=K[Q+B++],T.head&&y&&T.length<65536&&(T.head.name+=String.fromCharCode(y)),y&&B<j;);if(512&T.flags&&(T.check=o(T.check,K,B,Q)),j-=B,Q+=B,y)break e}else T.head&&(T.head.name=null);T.length=0,T.mode=8;case 8:if(4096&T.flags){if(j===0)break e;for(B=0;y=K[Q+B++],T.head&&y&&T.length<65536&&(T.head.comment+=String.fromCharCode(y)),y&&B<j;);if(512&T.flags&&(T.check=o(T.check,K,B,Q)),j-=B,Q+=B,y)break e}else T.head&&(T.head.comment=null);T.mode=9;case 9:if(512&T.flags){for(;b<16;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}if(q!==(65535&T.check)){A.msg="header crc mismatch",T.mode=30;break}b=q=0}T.head&&(T.head.hcrc=T.flags>>9&1,T.head.done=!0),A.adler=T.check=0,T.mode=12;break;case 10:for(;b<32;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}A.adler=T.check=g(q),b=q=0,T.mode=11;case 11:if(T.havedict===0)return A.next_out=oe,A.avail_out=ae,A.next_in=Q,A.avail_in=j,T.hold=q,T.bits=b,2;A.adler=T.check=1,T.mode=12;case 12:if(V===5||V===6)break e;case 13:if(T.last){q>>>=7&b,b-=7&b,T.mode=27;break}for(;b<3;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}switch(T.last=1&q,b-=1,3&(q>>>=1)){case 0:T.mode=14;break;case 1:if(N(T),T.mode=20,V!==6)break;q>>>=2,b-=2;break e;case 2:T.mode=17;break;case 3:A.msg="invalid block type",T.mode=30}q>>>=2,b-=2;break;case 14:for(q>>>=7&b,b-=7&b;b<32;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}if((65535&q)!=(q>>>16^65535)){A.msg="invalid stored block lengths",T.mode=30;break}if(T.length=65535&q,b=q=0,T.mode=15,V===6)break e;case 15:T.mode=16;case 16:if(B=T.length){if(j<B&&(B=j),ae<B&&(B=ae),B===0)break e;i.arraySet(ne,K,Q,B,oe),j-=B,Q+=B,ae-=B,oe+=B,T.length-=B;break}T.mode=12;break;case 17:for(;b<14;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}if(T.nlen=257+(31&q),q>>>=5,b-=5,T.ndist=1+(31&q),q>>>=5,b-=5,T.ncode=4+(15&q),q>>>=4,b-=4,286<T.nlen||30<T.ndist){A.msg="too many length or distance symbols",T.mode=30;break}T.have=0,T.mode=18;case 18:for(;T.have<T.ncode;){for(;b<3;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}T.lens[ue[T.have++]]=7&q,q>>>=3,b-=3}for(;T.have<19;)T.lens[ue[T.have++]]=0;if(T.lencode=T.lendyn,T.lenbits=7,J={bits:T.lenbits},Z=c(0,T.lens,0,19,T.lencode,0,T.work,J),T.lenbits=J.bits,Z){A.msg="invalid code lengths set",T.mode=30;break}T.have=0,T.mode=19;case 19:for(;T.have<T.nlen+T.ndist;){for(;he=(I=T.lencode[q&(1<<T.lenbits)-1])>>>16&255,ve=65535&I,!((de=I>>>24)<=b);){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}if(ve<16)q>>>=de,b-=de,T.lens[T.have++]=ve;else{if(ve===16){for(P=de+2;b<P;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}if(q>>>=de,b-=de,T.have===0){A.msg="invalid bit length repeat",T.mode=30;break}y=T.lens[T.have-1],B=3+(3&q),q>>>=2,b-=2}else if(ve===17){for(P=de+3;b<P;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}b-=de,y=0,B=3+(7&(q>>>=de)),q>>>=3,b-=3}else{for(P=de+7;b<P;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}b-=de,y=0,B=11+(127&(q>>>=de)),q>>>=7,b-=7}if(T.have+B>T.nlen+T.ndist){A.msg="invalid bit length repeat",T.mode=30;break}for(;B--;)T.lens[T.have++]=y}}if(T.mode===30)break;if(T.lens[256]===0){A.msg="invalid code -- missing end-of-block",T.mode=30;break}if(T.lenbits=9,J={bits:T.lenbits},Z=c(u,T.lens,0,T.nlen,T.lencode,0,T.work,J),T.lenbits=J.bits,Z){A.msg="invalid literal/lengths set",T.mode=30;break}if(T.distbits=6,T.distcode=T.distdyn,J={bits:T.distbits},Z=c(f,T.lens,T.nlen,T.ndist,T.distcode,0,T.work,J),T.distbits=J.bits,Z){A.msg="invalid distances set",T.mode=30;break}if(T.mode=20,V===6)break e;case 20:T.mode=21;case 21:if(6<=j&&258<=ae){A.next_out=oe,A.avail_out=ae,A.next_in=Q,A.avail_in=j,T.hold=q,T.bits=b,l(A,U),oe=A.next_out,ne=A.output,ae=A.avail_out,Q=A.next_in,K=A.input,j=A.avail_in,q=T.hold,b=T.bits,T.mode===12&&(T.back=-1);break}for(T.back=0;he=(I=T.lencode[q&(1<<T.lenbits)-1])>>>16&255,ve=65535&I,!((de=I>>>24)<=b);){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}if(he&&!(240&he)){for(ie=de,O=he,we=ve;he=(I=T.lencode[we+((q&(1<<ie+O)-1)>>ie)])>>>16&255,ve=65535&I,!(ie+(de=I>>>24)<=b);){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}q>>>=ie,b-=ie,T.back+=ie}if(q>>>=de,b-=de,T.back+=de,T.length=ve,he===0){T.mode=26;break}if(32&he){T.back=-1,T.mode=12;break}if(64&he){A.msg="invalid literal/length code",T.mode=30;break}T.extra=15&he,T.mode=22;case 22:if(T.extra){for(P=T.extra;b<P;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}T.length+=q&(1<<T.extra)-1,q>>>=T.extra,b-=T.extra,T.back+=T.extra}T.was=T.length,T.mode=23;case 23:for(;he=(I=T.distcode[q&(1<<T.distbits)-1])>>>16&255,ve=65535&I,!((de=I>>>24)<=b);){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}if(!(240&he)){for(ie=de,O=he,we=ve;he=(I=T.distcode[we+((q&(1<<ie+O)-1)>>ie)])>>>16&255,ve=65535&I,!(ie+(de=I>>>24)<=b);){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}q>>>=ie,b-=ie,T.back+=ie}if(q>>>=de,b-=de,T.back+=de,64&he){A.msg="invalid distance code",T.mode=30;break}T.offset=ve,T.extra=15&he,T.mode=24;case 24:if(T.extra){for(P=T.extra;b<P;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}T.offset+=q&(1<<T.extra)-1,q>>>=T.extra,b-=T.extra,T.back+=T.extra}if(T.offset>T.dmax){A.msg="invalid distance too far back",T.mode=30;break}T.mode=25;case 25:if(ae===0)break e;if(B=U-ae,T.offset>B){if((B=T.offset-B)>T.whave&&T.sane){A.msg="invalid distance too far back",T.mode=30;break}ee=B>T.wnext?(B-=T.wnext,T.wsize-B):T.wnext-B,B>T.length&&(B=T.length),xe=T.window}else xe=ne,ee=oe-T.offset,B=T.length;for(ae<B&&(B=ae),ae-=B,T.length-=B;ne[oe++]=xe[ee++],--B;);T.length===0&&(T.mode=21);break;case 26:if(ae===0)break e;ne[oe++]=T.length,ae--,T.mode=21;break;case 27:if(T.wrap){for(;b<32;){if(j===0)break e;j--,q|=K[Q++]<<b,b+=8}if(U-=ae,A.total_out+=U,T.total+=U,U&&(A.adler=T.check=T.flags?o(T.check,ne,U,oe-U):s(T.check,ne,U,oe-U)),U=ae,(T.flags?q:g(q))!==T.check){A.msg="incorrect data check",T.mode=30;break}b=q=0}T.mode=28;case 28:if(T.wrap&&T.flags){for(;b<32;){if(j===0)break e;j--,q+=K[Q++]<<b,b+=8}if(q!==(4294967295&T.total)){A.msg="incorrect length check",T.mode=30;break}b=q=0}T.mode=29;case 29:Z=1;break e;case 30:Z=-3;break e;case 31:return-4;case 32:default:return h}return A.next_out=oe,A.avail_out=ae,A.next_in=Q,A.avail_in=j,T.hold=q,T.bits=b,(T.wsize||U!==A.avail_out&&T.mode<30&&(T.mode<27||V!==4))&&X(A,A.output,A.next_out,U-A.avail_out)?(T.mode=31,-4):(H-=A.avail_in,U-=A.avail_out,A.total_in+=H,A.total_out+=U,T.total+=U,T.wrap&&U&&(A.adler=T.check=T.flags?o(T.check,ne,U,A.next_out-U):s(T.check,ne,U,A.next_out-U)),A.data_type=T.bits+(T.last?64:0)+(T.mode===12?128:0)+(T.mode===20||T.mode===15?256:0),(H==0&&U===0||V===4)&&Z===p&&(Z=-5),Z)},a.inflateEnd=function(A){if(!A||!A.state)return h;var V=A.state;return V.window&&(V.window=null),A.state=null,p},a.inflateGetHeader=function(A,V){var T;return A&&A.state&&2&(T=A.state).wrap?((T.head=V).done=!1,p):h},a.inflateSetDictionary=function(A,V){var T,K=V.length;return A&&A.state?(T=A.state).wrap!==0&&T.mode!==11?h:T.mode===11&&s(1,V,K,0)!==T.check?-3:X(A,V,K,K)?(T.mode=31,-4):(T.havedict=1,p):h},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,a){var i=r("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(u,f,p,h,m,d,v,g){var x,w,_,S,E,k,R,C,N,X=g.bits,A=0,V=0,T=0,K=0,ne=0,Q=0,oe=0,j=0,ae=0,q=0,b=null,H=0,U=new i.Buf16(16),B=new i.Buf16(16),ee=null,xe=0;for(A=0;A<=15;A++)U[A]=0;for(V=0;V<h;V++)U[f[p+V]]++;for(ne=X,K=15;1<=K&&U[K]===0;K--);if(K<ne&&(ne=K),K===0)return m[d++]=20971520,m[d++]=20971520,g.bits=1,0;for(T=1;T<K&&U[T]===0;T++);for(ne<T&&(ne=T),A=j=1;A<=15;A++)if(j<<=1,(j-=U[A])<0)return-1;if(0<j&&(u===0||K!==1))return-1;for(B[1]=0,A=1;A<15;A++)B[A+1]=B[A]+U[A];for(V=0;V<h;V++)f[p+V]!==0&&(v[B[f[p+V]]++]=V);if(k=u===0?(b=ee=v,19):u===1?(b=s,H-=257,ee=o,xe-=257,256):(b=l,ee=c,-1),A=T,E=d,oe=V=q=0,_=-1,S=(ae=1<<(Q=ne))-1,u===1&&852<ae||u===2&&592<ae)return 1;for(;;){for(R=A-oe,N=v[V]<k?(C=0,v[V]):v[V]>k?(C=ee[xe+v[V]],b[H+v[V]]):(C=96,0),x=1<<A-oe,T=w=1<<Q;m[E+(q>>oe)+(w-=x)]=R<<24|C<<16|N|0,w!==0;);for(x=1<<A-1;q&x;)x>>=1;if(x!==0?(q&=x-1,q+=x):q=0,V++,--U[A]==0){if(A===K)break;A=f[p+v[V]]}if(ne<A&&(q&S)!==_){for(oe===0&&(oe=ne),E+=T,j=1<<(Q=A-oe);Q+oe<K&&!((j-=U[Q+oe])<=0);)Q++,j<<=1;if(ae+=1<<Q,u===1&&852<ae||u===2&&592<ae)return 1;m[_=q&S]=ne<<24|Q<<16|E-d|0}}return q!==0&&(m[E+q]=A-oe<<24|64<<16|0),g.bits=ne,0}},{"../utils/common":41}],51:[function(r,n,a){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,a){var i=r("../utils/common"),s=0,o=1;function l(I){for(var Y=I.length;0<=--Y;)I[Y]=0}var c=0,u=29,f=256,p=f+1+u,h=30,m=19,d=2*p+1,v=15,g=16,x=7,w=256,_=16,S=17,E=18,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=new Array(2*(p+2));l(X);var A=new Array(2*h);l(A);var V=new Array(512);l(V);var T=new Array(256);l(T);var K=new Array(u);l(K);var ne,Q,oe,j=new Array(h);function ae(I,Y,ue,pe,te){this.static_tree=I,this.extra_bits=Y,this.extra_base=ue,this.elems=pe,this.max_length=te,this.has_stree=I&&I.length}function q(I,Y){this.dyn_tree=I,this.max_code=0,this.stat_desc=Y}function b(I){return I<256?V[I]:V[256+(I>>>7)]}function H(I,Y){I.pending_buf[I.pending++]=255&Y,I.pending_buf[I.pending++]=Y>>>8&255}function U(I,Y,ue){I.bi_valid>g-ue?(I.bi_buf|=Y<<I.bi_valid&65535,H(I,I.bi_buf),I.bi_buf=Y>>g-I.bi_valid,I.bi_valid+=ue-g):(I.bi_buf|=Y<<I.bi_valid&65535,I.bi_valid+=ue)}function B(I,Y,ue){U(I,ue[2*Y],ue[2*Y+1])}function ee(I,Y){for(var ue=0;ue|=1&I,I>>>=1,ue<<=1,0<--Y;);return ue>>>1}function xe(I,Y,ue){var pe,te,_e=new Array(v+1),Ae=0;for(pe=1;pe<=v;pe++)_e[pe]=Ae=Ae+ue[pe-1]<<1;for(te=0;te<=Y;te++){var ke=I[2*te+1];ke!==0&&(I[2*te]=ee(_e[ke]++,ke))}}function de(I){var Y;for(Y=0;Y<p;Y++)I.dyn_ltree[2*Y]=0;for(Y=0;Y<h;Y++)I.dyn_dtree[2*Y]=0;for(Y=0;Y<m;Y++)I.bl_tree[2*Y]=0;I.dyn_ltree[2*w]=1,I.opt_len=I.static_len=0,I.last_lit=I.matches=0}function he(I){8<I.bi_valid?H(I,I.bi_buf):0<I.bi_valid&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0}function ve(I,Y,ue,pe){var te=2*Y,_e=2*ue;return I[te]<I[_e]||I[te]===I[_e]&&pe[Y]<=pe[ue]}function ie(I,Y,ue){for(var pe=I.heap[ue],te=ue<<1;te<=I.heap_len&&(te<I.heap_len&&ve(Y,I.heap[te+1],I.heap[te],I.depth)&&te++,!ve(Y,pe,I.heap[te],I.depth));)I.heap[ue]=I.heap[te],ue=te,te<<=1;I.heap[ue]=pe}function O(I,Y,ue){var pe,te,_e,Ae,ke=0;if(I.last_lit!==0)for(;pe=I.pending_buf[I.d_buf+2*ke]<<8|I.pending_buf[I.d_buf+2*ke+1],te=I.pending_buf[I.l_buf+ke],ke++,pe===0?B(I,te,Y):(B(I,(_e=T[te])+f+1,Y),(Ae=k[_e])!==0&&U(I,te-=K[_e],Ae),B(I,_e=b(--pe),ue),(Ae=R[_e])!==0&&U(I,pe-=j[_e],Ae)),ke<I.last_lit;);B(I,w,Y)}function we(I,Y){var ue,pe,te,_e=Y.dyn_tree,Ae=Y.stat_desc.static_tree,ke=Y.stat_desc.has_stree,Re=Y.stat_desc.elems,et=-1;for(I.heap_len=0,I.heap_max=d,ue=0;ue<Re;ue++)_e[2*ue]!==0?(I.heap[++I.heap_len]=et=ue,I.depth[ue]=0):_e[2*ue+1]=0;for(;I.heap_len<2;)_e[2*(te=I.heap[++I.heap_len]=et<2?++et:0)]=1,I.depth[te]=0,I.opt_len--,ke&&(I.static_len-=Ae[2*te+1]);for(Y.max_code=et,ue=I.heap_len>>1;1<=ue;ue--)ie(I,_e,ue);for(te=Re;ue=I.heap[1],I.heap[1]=I.heap[I.heap_len--],ie(I,_e,1),pe=I.heap[1],I.heap[--I.heap_max]=ue,I.heap[--I.heap_max]=pe,_e[2*te]=_e[2*ue]+_e[2*pe],I.depth[te]=(I.depth[ue]>=I.depth[pe]?I.depth[ue]:I.depth[pe])+1,_e[2*ue+1]=_e[2*pe+1]=te,I.heap[1]=te++,ie(I,_e,1),2<=I.heap_len;);I.heap[--I.heap_max]=I.heap[1],function(Be,_t){var We,at,Kt,Ge,Jr,Bi,pn=_t.dyn_tree,Dl=_t.max_code,Ll=_t.stat_desc.static_tree,Bl=_t.stat_desc.has_stree,Ul=_t.stat_desc.extra_bits,Ml=_t.stat_desc.extra_base,qa=_t.stat_desc.max_length,Wn=0;for(Ge=0;Ge<=v;Ge++)Be.bl_count[Ge]=0;for(pn[2*Be.heap[Be.heap_max]+1]=0,We=Be.heap_max+1;We<d;We++)qa<(Ge=pn[2*pn[2*(at=Be.heap[We])+1]+1]+1)&&(Ge=qa,Wn++),pn[2*at+1]=Ge,Dl<at||(Be.bl_count[Ge]++,Jr=0,Ml<=at&&(Jr=Ul[at-Ml]),Bi=pn[2*at],Be.opt_len+=Bi*(Ge+Jr),Bl&&(Be.static_len+=Bi*(Ll[2*at+1]+Jr)));if(Wn!==0){do{for(Ge=qa-1;Be.bl_count[Ge]===0;)Ge--;Be.bl_count[Ge]--,Be.bl_count[Ge+1]+=2,Be.bl_count[qa]--,Wn-=2}while(0<Wn);for(Ge=qa;Ge!==0;Ge--)for(at=Be.bl_count[Ge];at!==0;)Dl<(Kt=Be.heap[--We])||(pn[2*Kt+1]!==Ge&&(Be.opt_len+=(Ge-pn[2*Kt+1])*pn[2*Kt],pn[2*Kt+1]=Ge),at--)}}(I,Y),xe(_e,et,I.bl_count)}function y(I,Y,ue){var pe,te,_e=-1,Ae=Y[1],ke=0,Re=7,et=4;for(Ae===0&&(Re=138,et=3),Y[2*(ue+1)+1]=65535,pe=0;pe<=ue;pe++)te=Ae,Ae=Y[2*(pe+1)+1],++ke<Re&&te===Ae||(ke<et?I.bl_tree[2*te]+=ke:te!==0?(te!==_e&&I.bl_tree[2*te]++,I.bl_tree[2*_]++):ke<=10?I.bl_tree[2*S]++:I.bl_tree[2*E]++,_e=te,et=(ke=0)===Ae?(Re=138,3):te===Ae?(Re=6,3):(Re=7,4))}function Z(I,Y,ue){var pe,te,_e=-1,Ae=Y[1],ke=0,Re=7,et=4;for(Ae===0&&(Re=138,et=3),pe=0;pe<=ue;pe++)if(te=Ae,Ae=Y[2*(pe+1)+1],!(++ke<Re&&te===Ae)){if(ke<et)for(;B(I,te,I.bl_tree),--ke!=0;);else te!==0?(te!==_e&&(B(I,te,I.bl_tree),ke--),B(I,_,I.bl_tree),U(I,ke-3,2)):ke<=10?(B(I,S,I.bl_tree),U(I,ke-3,3)):(B(I,E,I.bl_tree),U(I,ke-11,7));_e=te,et=(ke=0)===Ae?(Re=138,3):te===Ae?(Re=6,3):(Re=7,4)}}l(j);var J=!1;function P(I,Y,ue,pe){U(I,(c<<1)+(pe?1:0),3),function(te,_e,Ae,ke){he(te),H(te,Ae),H(te,~Ae),i.arraySet(te.pending_buf,te.window,_e,Ae,te.pending),te.pending+=Ae}(I,Y,ue)}a._tr_init=function(I){J||(function(){var Y,ue,pe,te,_e,Ae=new Array(v+1);for(te=pe=0;te<u-1;te++)for(K[te]=pe,Y=0;Y<1<<k[te];Y++)T[pe++]=te;for(T[pe-1]=te,te=_e=0;te<16;te++)for(j[te]=_e,Y=0;Y<1<<R[te];Y++)V[_e++]=te;for(_e>>=7;te<h;te++)for(j[te]=_e<<7,Y=0;Y<1<<R[te]-7;Y++)V[256+_e++]=te;for(ue=0;ue<=v;ue++)Ae[ue]=0;for(Y=0;Y<=143;)X[2*Y+1]=8,Y++,Ae[8]++;for(;Y<=255;)X[2*Y+1]=9,Y++,Ae[9]++;for(;Y<=279;)X[2*Y+1]=7,Y++,Ae[7]++;for(;Y<=287;)X[2*Y+1]=8,Y++,Ae[8]++;for(xe(X,p+1,Ae),Y=0;Y<h;Y++)A[2*Y+1]=5,A[2*Y]=ee(Y,5);ne=new ae(X,k,f+1,p,v),Q=new ae(A,R,0,h,v),oe=new ae(new Array(0),C,0,m,x)}(),J=!0),I.l_desc=new q(I.dyn_ltree,ne),I.d_desc=new q(I.dyn_dtree,Q),I.bl_desc=new q(I.bl_tree,oe),I.bi_buf=0,I.bi_valid=0,de(I)},a._tr_stored_block=P,a._tr_flush_block=function(I,Y,ue,pe){var te,_e,Ae=0;0<I.level?(I.strm.data_type===2&&(I.strm.data_type=function(ke){var Re,et=4093624447;for(Re=0;Re<=31;Re++,et>>>=1)if(1&et&&ke.dyn_ltree[2*Re]!==0)return s;if(ke.dyn_ltree[18]!==0||ke.dyn_ltree[20]!==0||ke.dyn_ltree[26]!==0)return o;for(Re=32;Re<f;Re++)if(ke.dyn_ltree[2*Re]!==0)return o;return s}(I)),we(I,I.l_desc),we(I,I.d_desc),Ae=function(ke){var Re;for(y(ke,ke.dyn_ltree,ke.l_desc.max_code),y(ke,ke.dyn_dtree,ke.d_desc.max_code),we(ke,ke.bl_desc),Re=m-1;3<=Re&&ke.bl_tree[2*N[Re]+1]===0;Re--);return ke.opt_len+=3*(Re+1)+5+5+4,Re}(I),te=I.opt_len+3+7>>>3,(_e=I.static_len+3+7>>>3)<=te&&(te=_e)):te=_e=ue+5,ue+4<=te&&Y!==-1?P(I,Y,ue,pe):I.strategy===4||_e===te?(U(I,2+(pe?1:0),3),O(I,X,A)):(U(I,4+(pe?1:0),3),function(ke,Re,et,Be){var _t;for(U(ke,Re-257,5),U(ke,et-1,5),U(ke,Be-4,4),_t=0;_t<Be;_t++)U(ke,ke.bl_tree[2*N[_t]+1],3);Z(ke,ke.dyn_ltree,Re-1),Z(ke,ke.dyn_dtree,et-1)}(I,I.l_desc.max_code+1,I.d_desc.max_code+1,Ae+1),O(I,I.dyn_ltree,I.dyn_dtree)),de(I),pe&&he(I)},a._tr_tally=function(I,Y,ue){return I.pending_buf[I.d_buf+2*I.last_lit]=Y>>>8&255,I.pending_buf[I.d_buf+2*I.last_lit+1]=255&Y,I.pending_buf[I.l_buf+I.last_lit]=255&ue,I.last_lit++,Y===0?I.dyn_ltree[2*ue]++:(I.matches++,Y--,I.dyn_ltree[2*(T[ue]+f+1)]++,I.dyn_dtree[2*b(Y)]++),I.last_lit===I.lit_bufsize-1},a._tr_align=function(I){U(I,2,3),B(I,w,X),function(Y){Y.bi_valid===16?(H(Y,Y.bi_buf),Y.bi_buf=0,Y.bi_valid=0):8<=Y.bi_valid&&(Y.pending_buf[Y.pending++]=255&Y.bi_buf,Y.bi_buf>>=8,Y.bi_valid-=8)}(I)}},{"../utils/common":41}],53:[function(r,n,a){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,a){(function(i){(function(s,o){if(!s.setImmediate){var l,c,u,f,p=1,h={},m=!1,d=s.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(s);v=v&&v.setTimeout?v:s,l={}.toString.call(s.process)==="[object process]"?function(_){process.nextTick(function(){x(_)})}:function(){if(s.postMessage&&!s.importScripts){var _=!0,S=s.onmessage;return s.onmessage=function(){_=!1},s.postMessage("","*"),s.onmessage=S,_}}()?(f="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",w,!1):s.attachEvent("onmessage",w),function(_){s.postMessage(f+_,"*")}):s.MessageChannel?((u=new MessageChannel).port1.onmessage=function(_){x(_.data)},function(_){u.port2.postMessage(_)}):d&&"onreadystatechange"in d.createElement("script")?(c=d.documentElement,function(_){var S=d.createElement("script");S.onreadystatechange=function(){x(_),S.onreadystatechange=null,c.removeChild(S),S=null},c.appendChild(S)}):function(_){setTimeout(x,0,_)},v.setImmediate=function(_){typeof _!="function"&&(_=new Function(""+_));for(var S=new Array(arguments.length-1),E=0;E<S.length;E++)S[E]=arguments[E+1];var k={callback:_,args:S};return h[p]=k,l(p),p++},v.clearImmediate=g}function g(_){delete h[_]}function x(_){if(m)setTimeout(x,0,_);else{var S=h[_];if(S){m=!0;try{(function(E){var k=E.callback,R=E.args;switch(R.length){case 0:k();break;case 1:k(R[0]);break;case 2:k(R[0],R[1]);break;case 3:k(R[0],R[1],R[2]);break;default:k.apply(o,R)}})(S)}finally{g(_),m=!1}}}}function w(_){_.source===s&&typeof _.data=="string"&&_.data.indexOf(f)===0&&x(+_.data.slice(f.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof jl<"u"?jl:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(x_);var G6=x_.exports;const q6=Ng(G6);function K6(){const{siteId:e}=bd(),t=js(),[r,n]=fe.useState(null),[a,i]=fe.useState([]),[s,o]=fe.useState({}),[l,c]=fe.useState({}),[u,f]=fe.useState(!1),[p,h]=fe.useState(null),[m,d]=fe.useState(!1),[v,g]=fe.useState(!1),[x,w]=fe.useState(navigator.onLine),[_,S]=fe.useState([]),E=T=>S(K=>[...K,`${new Date().toLocaleTimeString()}: ${T}`]);fe.useEffect(()=>{const T=()=>w(!0),K=()=>w(!1);return window.addEventListener("online",T),window.addEventListener("offline",K),()=>{window.removeEventListener("online",T),window.removeEventListener("offline",K)}},[]),fe.useEffect(()=>{(async()=>{const ne=(await ze.getSites()).find(b=>b.id.toString()===e);if(!ne){t("/");return}n(ne),await ze.setCurrentSite(e);const Q=await ze.getPhotoRequirements();E(`Loaded ${Q.length} photo requirements`);const oe={};E(`Online Status: ${x}`),E("Grouping photo requirements..."),Q.forEach(b=>{const H=b.category||"General";oe[H]||(oe[H]=[]),oe[H].push(b)}),i(oe),E("Loading local photo metadata (lightweight)...");const j=await ze.getPhotoMetadata(e),ae={};if(j.filter(b=>b.status==="pending").forEach(b=>{const H=b.photoReqId.toString();ae[H]=(ae[H]||0)+1}),o(ae),E(`Found ${Object.values(ae).reduce((b,H)=>b+H,0)} local pending photos`),x){f(!0);try{E("Checking SharePoint for uploaded photos...");const b=await wt.listFiles(ne.phase,ne.name,"PHOTOS");E(`SharePoint PHOTOS folder has ${b.length} items`);const H=O=>O.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),U={};Q.forEach(O=>{const we=H(O.name);U[we]=O.id.toString()});const B={},ee=new Set,xe=b.filter(O=>O.folder&&U[H(O.name)]),de=b.filter(O=>!O.folder&&!O.name.endsWith(".zip"));if(E(`Found ${xe.length} category folders, ${de.length} root files`),xe.length>0){const O=xe.map(async y=>{try{const Z=`PHOTOS/${y.name}`,P=(await wt.listFiles(ne.phase,ne.name,Z)).filter(I=>!I.name.endsWith(".zip"));return{folder:y,files:P}}catch{return{folder:y,files:[]}}}),we=await Promise.all(O);for(const{folder:y,files:Z}of we){const J=H(y.name),P=U[J];P&&Z.length>0&&(B[P]=(B[P]||0)+Z.length,Z.forEach(I=>ee.add(I.name)))}}for(const O of de){let we=null,y=0;Q.forEach(Z=>{O.name.toLowerCase().includes(Z.name.toLowerCase())&&Z.name.length>y&&(y=Z.name.length,we=Z.id.toString())}),we&&(B[we]=(B[we]||0)+1),ee.add(O.name)}c(B);const he=Object.values(B).reduce((O,we)=>O+we,0);E(`Found ${he} photos in SharePoint across ${Object.keys(B).length} requirements`);const ve=await ze.getPhotos(e);let ie=0;for(const O of ve)O.status==="pending"&&ee.has(O.filename)&&(await ze.updatePhotoStatus(O.id,"synced"),ie++);if(ie>0){E(`Auto-synced ${ie} local photos that were already in SharePoint`);const O=await ze.getPhotoMetadata(e),we={};O.filter(y=>y.status==="pending").forEach(y=>{const Z=y.photoReqId.toString();we[Z]=(we[Z]||0)+1}),o(we)}}catch(b){E(`SharePoint count check failed: ${b.message}`)}finally{f(!1)}}const q=await ze.getQuestionnaire(e);if(h(q),x){E(`Checking questionnaire: ${ne.phase} / ${ne.name}`);try{E("Testing Path Resolution...");const b=await wt.resolveSharePointPath(ne.phase,ne.name);E(`Resolved Path: ${b}`)}catch(b){E(`Resolution Error: ${b.message}`)}wt.checkQuestionnaireExists(ne.phase,ne.name,e).then(async b=>{if(E(`Questionnaire exists: ${b}`),d(b),!b&&x){const H=await ze.getQuestionnaire(e);H&&H.status==="synced"&&(E("Remote missing & local is synced. Reseting local state."),await ze.deleteQuestionnaire(e),h(null))}}).catch(b=>E(`Err check quest: ${b.message}`))}else E("Skipping remote check: Offline");x&&(E("[SYSTEM] Starting Deep Diagnostics..."),wt.runDiagnostics(ne.phase,ne.name).then(b=>{b.forEach(H=>E(`[DIAG] ${H.split(": ").slice(1).join(": ")}`))}).catch(b=>E(`[DIAG] CRITICAL FAILURE: ${b.message}`)),wt.listFiles(ne.phase,ne.name,null).then(b=>{E(`[DEBUG] Site Root Files: ${b.map(H=>H.name).join(", ")}`)}).catch(b=>{E(`[DEBUG] Failed to list files: ${b.message}`)}),mi.reconcilePhotos(e,ne.phase,ne.name).then(b=>{const{deleted:H,downloaded:U}=b;(H>0||U>0)&&(console.log(`Reconciliation: Deleted ${H}, Downloaded ${U} photos`),ze.getPhotoMetadata(e).then(B=>{const ee={};B.filter(xe=>xe.status==="pending").forEach(xe=>{const de=xe.photoReqId.toString();ee[de]=(ee[de]||0)+1}),o(ee)}))}).catch(b=>{console.error("Reconciliation failed:",b)}))})()},[e,t]);const[k,R]=fe.useState({current:0,total:0,status:""}),[C,N]=fe.useState(!1),X=async()=>{if(!r)return;const K=(await ze.getPhotos(e)).filter(Q=>Q.status==="pending");if(K.length===0){alert("No photos to upload");return}const ne=mi.isOnline();N(!0),R({current:0,total:K.length,status:ne?"Starting upload...":"Queueing for sync (Offline)..."});try{let Q=0,oe=0;const j=[],ae=[];if(ne){const q={};for(const B of K){const ee=B.photoReqName||"uncategorized";q[ee]||(q[ee]=[]),q[ee].push(B)}const b=Object.keys(q),H=b.length;let U=0;R({current:0,total:H,status:`Creating ${H} category ZIP files...`});for(const B of b){const ee=q[B],de=`${B.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"")}.zip`;R({current:U,total:H,status:`Processing "${B}" (${ee.length} photos)...`});try{const he=new q6;for(const we of ee){let y=we.blob;!y&&we.dataUrl&&(y=await(await fetch(we.dataUrl)).blob()),y&&he.file(we.filename,y)}const ve=await he.generateAsync({type:"blob"}),ie=(ve.size/1024/1024).toFixed(2),O=await wt.getNextAvailableFilename(r.phase,r.name,de,"PHOTOS");R({current:U,total:H,status:`Uploading "${O}" (${ie} MB)...`}),await wt.uploadZip(r.phase,r.name,r.id,O,ve);for(const we of ee)await ze.updatePhotoStatus(we.id,"synced");ae.push(`${O} (${ee.length} photos, ${ie} MB)`),Q+=ee.length,E(` Uploaded: ${O}`)}catch(he){console.error(`Error uploading category ${B}:`,he),j.push(`${B}: ${he.message}`),oe+=ee.length}U++}}else for(let q=0;q<K.length;q++){const b=K[q];console.log(`Queueing photo ${q+1}/${K.length}: ${b.filename}`),await mi.addToQueue("PHOTO",{siteId:r.id,photoId:b.id,phase:r.phase,siteName:r.name}),Q++}if(oe===0)if(ne){const q=`Documents > Telamon - Viaero Site Walks > ${Qe.sharepoint.normalizePhase(r.phase)} > ${r.name} > PHOTOS`;R({current:100,total:100,status:` Success! ${Q} photos uploaded.

Files created:
${ae.join(`
`)}

Location: ${q}`}),v_.sendUploadNotification(r.name,"photos",Q,{folderPath:q}).catch(b=>console.error("Email notification failed:",b))}else R({current:K.length,total:K.length,status:` Offline Mode: All ${Q} photos queued.

They will automatically upload when you reconnect to the internet.`});else R({current:K.length,total:K.length,status:` Partial Success

${Q} ${ne?"uploaded":"queued"}
${oe} failed

Errors:
${j.slice(0,3).join(`
`)}`});g(!1)}catch(Q){g(!1),console.error("Upload error:",Q),R({current:0,total:K.length,status:` Process failed: ${Q.message}`})}},A=()=>{N(!1),R({current:0,total:0,status:""})};if(!r)return D.jsx("div",{className:"spinner"});const V=`https://www.google.com/maps?q=${r.latitude},${r.longitude}`;return D.jsxs("div",{children:[D.jsx("div",{className:"header",children:D.jsxs("div",{className:"container",style:{display:"flex",alignItems:"center",gap:"12px"},children:[D.jsx(So,{to:"/",style:{color:"white",fontSize:"24px",textDecoration:"none"},children:""}),D.jsxs("div",{children:[D.jsx("h1",{style:{fontSize:"18px"},children:r.name}),D.jsxs("p",{style:{margin:0,opacity:.9,fontSize:"12px"},children:["Project #",r.id]})]})]})}),D.jsxs("div",{className:"container",children:[D.jsxs("div",{className:"card mb-3",children:[D.jsx("h3",{style:{marginBottom:"12px"},children:"Site Information"}),D.jsxs("div",{style:{marginBottom:"8px"},children:[D.jsx("strong",{children:"Phase:"})," ",r.phase]}),D.jsxs("div",{style:{marginBottom:"8px"},children:[D.jsx("strong",{children:"Address:"}),D.jsx("br",{}),r.address,D.jsx("br",{}),r.city,", ",r.state," ",r.zip]}),D.jsxs("div",{style:{marginBottom:"12px"},children:[D.jsx("strong",{children:"Coordinates:"}),D.jsx("br",{}),r.latitude,", ",r.longitude]}),D.jsx("a",{href:V,target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary",style:{width:"100%"},children:" Open in Google Maps"})]}),D.jsxs("div",{className:"card mb-3",children:[D.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[D.jsx("h3",{style:{margin:0},children:"Photo Requirements"}),r&&D.jsx("button",{onClick:()=>window.open(wt.getPhotoFolderUrl(r.phase,r.name),"_blank"),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px"},children:" View All in SharePoint"})]}),u&&D.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"12px"},children:" Checking SharePoint for uploaded photos..."}),Object.entries(a).map(([T,K])=>D.jsxs("div",{style:{marginBottom:"16px"},children:[D.jsx("h4",{style:{fontSize:"16px",marginBottom:"8px",color:"var(--primary-color)"},children:T}),K.map(ne=>{const Q=l[ne.id]||0,oe=s[ne.id]||0,ae=Q+oe>0;return D.jsx(So,{to:`/site/${e}/photo/${ne.id}`,style:{textDecoration:"none",color:"inherit"},children:D.jsx("div",{style:{padding:"12px",marginBottom:"8px",backgroundColor:ae?"#e8f5e9":"var(--surface)",border:`2px solid ${ae?"var(--success-color)":"var(--border-color)"}`,borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease"},children:D.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[D.jsxs("div",{style:{flex:1},children:[D.jsxs("div",{style:{fontWeight:"500",marginBottom:"4px"},children:[ne.id,": ",ne.name]}),ne.description&&D.jsx("div",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:ne.description}),D.jsxs("div",{style:{fontSize:"12px",marginTop:"4px",display:"flex",gap:"12px",flexWrap:"wrap"},children:[Q>0&&D.jsxs("span",{style:{color:"#4caf50",cursor:"pointer",textDecoration:"underline"},onClick:q=>{q.preventDefault(),q.stopPropagation(),window.open(wt.getCategoryFolderUrl(r.phase,r.name,ne.name),"_blank")},children:[" ",Q," in SharePoint "]}),oe>0&&D.jsxs("span",{style:{color:"#ff9800"},children:[" ",oe," pending upload"]})]})]}),D.jsx("div",{style:{fontSize:"24px"},children:ae?"":""})]})})},ne.id)})]},T)),Object.values(s).reduce((T,K)=>T+K,0)>0&&D.jsxs("div",{style:{marginTop:"20px",paddingTop:"20px",borderTop:"2px solid var(--border-color)"},children:[D.jsx("button",{onClick:X,disabled:v,className:"btn btn-primary",style:{width:"100%",padding:"16px",fontSize:"16px"},children:v?D.jsx(D.Fragment,{children:" Uploading to SharePoint..."}):D.jsxs(D.Fragment,{children:[" Upload All Photos to SharePoint (",Object.values(s).reduce((T,K)=>T+K,0)," photos)"]})}),D.jsxs("p",{style:{fontSize:"12px",color:"var(--text-secondary)",marginTop:"8px",textAlign:"center"},children:["Photos will be uploaded to: Documents > Telamon - Viaero Site Walks > ",Qe.sharepoint.normalizePhase(r.phase)," > ",r.name," > PHOTOS"]})]})]}),D.jsxs("div",{className:"card mb-3",children:[D.jsx("h3",{style:{marginBottom:"12px"},children:"Site Walk Questionnaire"}),D.jsx("p",{className:"text-muted mb-2",children:"Complete the questionnaire after capturing all photos."}),D.jsx(So,{to:`/site/${e}/questionnaire`,state:{loadFromCloud:m},children:D.jsx("button",{className:`btn ${p||m?"btn-success":"btn-primary"}`,style:{width:"100%"},children:p||m?" View/Edit Questionnaire":" Start Questionnaire"})}),p&&!m&&x&&D.jsxs("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#fff3e0",borderRadius:"8px",border:"1px solid #ffe0b2"},children:[D.jsxs("p",{style:{fontSize:"12px",color:"#e65100",margin:"0 0 8px 0"},children:[" ",D.jsx("strong",{children:"Sync Conflict:"})," You have a local draft, but the file is missing from SharePoint."]}),D.jsxs("div",{style:{display:"flex",gap:"8px"},children:[D.jsx("button",{onClick:async()=>{window.confirm("Are you sure you want to discard this local draft? This cannot be undone.")&&(await ze.deleteQuestionnaire(e),h(null))},className:"btn btn-secondary",style:{flex:1,fontSize:"12px",padding:"8px",backgroundColor:"#ef5350",color:"white",border:"none"},children:"Discard Draft"}),D.jsx("button",{onClick:X,className:"btn btn-primary",style:{flex:1,fontSize:"12px",padding:"8px"},children:"Upload to Restore"})]})]})]})]}),C&&D.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:D.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",boxShadow:"0 4px 20px rgba(0,0,0,0.3)"},children:[D.jsx("h3",{style:{marginTop:0,marginBottom:"16px"},children:"Uploading to SharePoint"}),D.jsx("div",{style:{width:"100%",height:"24px",backgroundColor:"#e0e0e0",borderRadius:"12px",overflow:"hidden",marginBottom:"16px"},children:D.jsxs("div",{style:{width:`${k.total>0?k.current/k.total*100:0}%`,height:"100%",backgroundColor:"var(--primary-color)",transition:"width 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"12px",fontWeight:"bold"},children:[k.current," / ",k.total]})}),D.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:"14px",marginBottom:"20px",minHeight:"60px"},children:k.status}),k.current===k.total&&k.total>0&&D.jsx("button",{onClick:A,className:"btn btn-primary",style:{width:"100%"},children:"Close"})]})}),D.jsxs("div",{style:{padding:"10px",backgroundColor:"#f5f5f5",borderTop:"1px solid #ccc",maxHeight:"150px",overflowY:"auto",fontSize:"10px"},children:[D.jsx("strong",{children:"Debug Console:"}),_.map((T,K)=>D.jsx("div",{children:T},K))]})]})}function lg(e,t,r,n,a=1){const i=e.trim(),s=r.trim(),o=`${n}.${a}`;return`${i} ${t} ${s} ${o}`}function cg(e,t){const r=e.filter(i=>i.photoReqName===t);if(r.length===0)return{sequential:1,sub:1};const n=r.map(i=>{const s=i.filename.match(/(\d+)\.(\d+)(?:\.[a-zA-Z0-9]+)?$/);return s?{sequential:parseInt(s[1]),sub:parseInt(s[2])}:{sequential:1,sub:1}});n.sort((i,s)=>i.sequential!==s.sequential?i.sequential-s.sequential:i.sub-s.sub);const a=n[n.length-1];return{sequential:a.sequential,sub:a.sub+1}}function X6(){const{siteId:e,photoReqId:t}=bd(),r=js(),[n,a]=fe.useState(null),[i,s]=fe.useState(null),[o,l]=fe.useState([]),c=fe.useRef([]),[u,f]=fe.useState(!1),[p,h]=fe.useState(null),[m,d]=fe.useState(null),v=fe.useRef(null),g=fe.useRef(null),x=fe.useRef(null),w=fe.useRef(null),[_,S]=fe.useState("searching"),[E,k]=fe.useState(null),[R,C]=fe.useState(null),N=fe.useRef(null),[X,A]=fe.useState(1),[V,T]=fe.useState({min:1,max:3,step:.1}),[K,ne]=fe.useState(!1),[Q,oe]=fe.useState(null),[j,ae]=fe.useState(!1);fe.useEffect(()=>{(async()=>{try{const Z=(await ze.getSites()).find(ue=>ue.id.toString()===e),P=(await ze.getPhotoRequirements()).find(ue=>ue.id.toString()===t);if(!Z||!P){r(`/site/${e}`);return}a(Z),s(P);const Y=(await ze.getPhotos(e)).filter(ue=>ue.photoReqId.toString()===t&&ue.status==="pending");l(Y),c.current=Y,console.log(`Loaded ${Y.length} pending photos for display`)}catch(y){console.error("Error loading photo capture data:",y),alert("Failed to load data. Please try again."),r(`/site/${e}`)}})(),(async()=>{if(!(!e||!t))try{ae(!0);const Z=(await ze.getSites()).find(J=>J.id.toString()===e);if(Z){const P=(await ze.getPhotoRequirements()).find(I=>I.id.toString()===t);if(P){const I=P.name.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"");try{const Y=`PHOTOS/${I}`,pe=(await wt.listFiles(Z.phase,Z.name,Y)).filter(te=>!te.name.endsWith(".zip")).length;oe(pe),console.log(`SharePoint subfolder "${I}": ${pe} photos`)}catch{const pe=(await wt.listFiles(Z.phase,Z.name,"PHOTOS")).filter(te=>!te.name.endsWith(".zip")&&te.name.toLowerCase().includes(P.name.toLowerCase()));oe(pe.length),console.log(`SharePoint root (fallback) for "${P.name}": ${pe.length}`)}}}}catch(y){console.error("Error fetching SharePoint photo count:",y),oe(0)}finally{ae(!1)}})();let we=null;if(navigator.geolocation){console.log("Starting GPS watch..."),S("searching");const y={enableHighAccuracy:!0,timeout:1e4,maximumAge:0},Z=P=>{const{latitude:I,longitude:Y,accuracy:ue}=P.coords,pe={latitude:I,longitude:Y,accuracy:ue};d(pe),v.current=pe,S("locked"),k(null),console.log(`GPS Updated: ${I.toFixed(6)}, ${Y.toFixed(6)} (Acc: ${Math.round(ue)}m)`)},J=P=>{console.warn("GPS Error:",P.message),S("error");let I="GPS Unavailable";switch(P.code){case 1:I="Location denied. Please enable permission.";break;case 2:I="Location unavailable. Check GPS signal.";break;case 3:I="Location timed out. Retrying...";break}k(I),P.code===3&&y.enableHighAccuracy&&(console.log("Retrying with low accuracy..."),y.enableHighAccuracy=!1,navigator.geolocation.clearWatch(we),we=navigator.geolocation.watchPosition(Z,J,y))};we=navigator.geolocation.watchPosition(Z,J,y)}else console.error("Geolocation not supported"),S("error"),k("GPS not supported on this device");return()=>{we!==null&&navigator.geolocation.clearWatch(we)}},[e,t,r]),fe.useEffect(()=>{let ie=null;const O=we=>{let y=null;we.webkitCompassHeading!==void 0?y=we.webkitCompassHeading:we.alpha!==null&&(y=360-we.alpha),y!==null&&(C(Math.round(y)),N.current=Math.round(y))};return typeof DeviceOrientationEvent<"u"&&typeof DeviceOrientationEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(we=>{we==="granted"&&(window.addEventListener("deviceorientationabsolute",O),window.addEventListener("deviceorientation",O),ie=O)}).catch(console.error):"DeviceOrientationEvent"in window&&(window.addEventListener("deviceorientationabsolute",O),window.addEventListener("deviceorientation",O),ie=O),()=>{ie&&(window.removeEventListener("deviceorientationabsolute",ie),window.removeEventListener("deviceorientation",ie))}},[]),fe.useEffect(()=>()=>{x.current&&(console.log("Cleaning up camera stream on unmount"),x.current.getTracks().forEach(ie=>ie.stop()),x.current=null),g.current&&(g.current.srcObject=null)},[]);const q=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert(`Camera access requires HTTPS or localhost. Please access the app via:

 On this computer: http://localhost:3000
 For testing: Use the file upload feature instead

Note: Camera features work when the app is properly deployed with HTTPS.`);return}const ie=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",zoom:!0},audio:!1});x.current=ie;const O=ie.getVideoTracks()[0],we=O.getCapabilities?O.getCapabilities():{};"zoom"in we?(console.log("Camera supports zoom:",we.zoom),ne(!0),T({min:we.zoom.min,max:we.zoom.max,step:we.zoom.step}),A(we.zoom.min)):(console.log("Camera does NOT support zoom"),ne(!1)),f(!0),setTimeout(()=>{g.current&&(g.current.srcObject=ie,g.current.play().catch(y=>{console.error("Error playing video:",y),alert("Error starting camera playback. Please try again.")}))},100)}catch(ie){console.error("Camera error:",ie),ie.name==="NotAllowedError"?alert("Camera permission denied. Please allow camera access in your browser settings."):ie.name==="NotFoundError"?alert("No camera found on this device."):alert("Unable to access camera: "+ie.message)}},b=()=>{x.current&&(x.current.getTracks().forEach(ie=>ie.stop()),x.current=null),f(!1),ne(!1)},H=async ie=>{const O=parseFloat(ie.target.value);if(A(O),x.current){const we=x.current.getVideoTracks()[0];try{await we.applyConstraints({advanced:[{zoom:O}]})}catch(y){console.error("Zoom failed:",y)}}},U=()=>{try{const ie=new(window.AudioContext||window.webkitAudioContext),O=.15,we=ie.currentTime,y=ie.createOscillator(),Z=ie.createGain();y.type="square",y.frequency.setValueAtTime(1200,we),y.frequency.exponentialRampToValueAtTime(400,we+O),Z.gain.setValueAtTime(.3,we),Z.gain.exponentialRampToValueAtTime(.01,we+O),y.connect(Z),Z.connect(ie.destination);const J=ie.createOscillator(),P=ie.createGain();J.type="sine",J.frequency.setValueAtTime(150,we),J.frequency.exponentialRampToValueAtTime(50,we+O*.5),P.gain.setValueAtTime(.4,we),P.gain.exponentialRampToValueAtTime(.01,we+O*.5),J.connect(P),P.connect(ie.destination),y.start(we),y.stop(we+O),J.start(we),J.stop(we+O*.5),setTimeout(()=>ie.close(),200)}catch(ie){console.log("Audio not supported:",ie)}},B=fe.useCallback(async()=>{if(!g.current||!n||!i){console.error("Missing data for capture:",{video:!!g.current,site:!!n,photoReq:!!i}),alert("Error: Missing required data. Please go back and try again.");return}const ie=document.createElement("canvas");if(ie.width=g.current.videoWidth,ie.height=g.current.videoHeight,console.log("Canvas size:",ie.width,"x",ie.height),ie.width===0||ie.height===0){console.error("Video dimensions are zero"),alert("Error: Camera not ready. Please wait for the video to load.");return}U();const O=ie.getContext("2d");O.drawImage(g.current,0,0);try{const y=new Date().toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0});let Z="Location: Not Available";const J=v.current;if(J){const ke=J.latitude>=0?"N":"S",Re=J.longitude>=0?"E":"W";Z=`Location: ${Math.abs(J.latitude).toFixed(6)} ${ke}, ${Math.abs(J.longitude).toFixed(6)} ${Re}`}else console.warn("GPS location missing from ref at capture time");const P=[`Site: ${n.name} (${n.id})`,Z],I=N.current;if(I!==null){const ke=["N","NE","E","SE","S","SW","W","NW"],Re=Math.round(I/45)%8,et=ke[Re];P.push(`Heading: ${I} ${et}`)}P.push(`Date: ${y}`);const Y=Math.max(16,Math.floor(ie.height/40));O.font=`${Y}px Arial`,O.textAlign="right",O.textBaseline="bottom";const ue=Y*1.3,pe=Y*.5,_e=Math.max(...P.map(ke=>O.measureText(ke).width))+pe*2,Ae=P.length*ue+pe*2;O.fillStyle="rgba(0, 0, 0, 0.6)",O.fillRect(ie.width-_e-10,ie.height-Ae-10,_e,Ae),O.fillStyle="white",P.forEach((ke,Re)=>{O.fillText(ke,ie.width-pe-10,ie.height-pe-10-(P.length-1-Re)*ue)}),console.log("Timestamp overlay added:",P)}catch(we){console.error("Failed to add timestamp overlay:",we)}ie.toBlob(async we=>{if(!we){console.error("Failed to create blob from canvas"),alert("Error: Failed to capture photo. Please try again.");return}console.log("Blob created, size:",we.size);const y=i.name||`Photo ${i.id}`,Z=cg(c.current,y),J=lg(n.name,n.id,y,Z.sequential,Z.sub);console.log("Generated filename:",J);const I={id:crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,photoReqId:i.id,photoReqName:y,filename:J+".jpg",blob:we,dataUrl:ie.toDataURL("image/jpeg",.9),size:we.size,width:ie.width,height:ie.height,capturedAt:new Date().toISOString(),status:"pending"};console.log("Saving photo data:",{id:I.id,filename:I.filename,size:I.size});const Y=[...c.current,I];c.current=Y,l(Y);try{await ze.savePhoto(n.id,I),console.log("Photo saved successfully to IndexedDB")}catch(ue){console.error("Error saving photo:",ue),alert("Failed to save photo. Please try again."),c.current=c.current.filter(pe=>pe.id!==I.id),l(c.current)}},"image/jpeg",.9)},[n,i,e,m]),ee=async ie=>{try{const O=o.find(we=>we.id===ie);if(!O){console.error("Photo not found:",ie),alert("Error: Photo not found");return}if(console.log("Deleting photo:",O.filename),await ze.deletePhoto(ie),console.log(" Deleted from local storage"),l(we=>{const y=we.filter(Z=>Z.id!==ie);return c.current=y,y}),h(null),console.log("Queueing deletion sync for:",O.filename),await mi.addToQueue("DELETE_PHOTO",{phase:n.phase,siteName:n.name,filename:O.filename}),console.log(" Added to sync queue"),mi.isOnline()){console.log("Online - processing sync queue immediately");const we=await mi.processQueue();console.log("Sync queue processed, success count:",we),we>0?alert("Photo deleted locally and from SharePoint"):alert("Photo deleted locally. Will sync to SharePoint when connection is restored.")}else console.log("Offline - will sync when connection is restored"),alert("Photo deleted locally. Will sync to SharePoint when online.")}catch(O){console.error("Error in confirmDelete:",O),alert(`Error deleting photo: ${O.message}`)}},xe=()=>{o.forEach(ie=>{const O=document.createElement("a");O.href=ie.dataUrl,O.download=ie.filename,O.click()})},de=()=>{if(n&&i){const ie=wt.getCategoryFolderUrl(n.phase,n.name,i.name);console.log("Opening SharePoint category URL:",ie),window.open(ie,"_blank")}else if(n){const ie=wt.getPhotoFolderUrl(n.phase,n.name);window.open(ie,"_blank")}else{const ie=Qe.sharepoint.siteUrl;window.open(`${ie}/Shared%20Documents`,"_blank")}},he=(ie,O=1920,we=.8)=>new Promise((y,Z)=>{const J=new Image,P=URL.createObjectURL(ie);J.onload=()=>{URL.revokeObjectURL(P);let I=J.width,Y=J.height;I>O&&(Y=Y*O/I,I=O);const ue=document.createElement("canvas");ue.width=I,ue.height=Y,ue.getContext("2d").drawImage(J,0,0,I,Y),ue.toBlob(te=>{if(te){const _e=new FileReader;_e.onload=()=>{y({blob:te,dataUrl:_e.result,width:I,height:Y})},_e.onerror=Z,_e.readAsDataURL(te)}else Z(new Error("Failed to compress image"))},"image/jpeg",we)},J.onerror=()=>{URL.revokeObjectURL(P),Z(new Error("Failed to load image"))},J.src=P}),ve=async ie=>{const O=ie.target.files;if(!(!O||O.length===0)){console.log(` Processing ${O.length} file(s) from gallery...`);for(let we=0;we<O.length;we++){const y=O[we];console.log(`Processing file ${we+1}/${O.length}: ${y.name} (${(y.size/1024/1024).toFixed(2)} MB)`);try{const Z=await he(y);console.log(`Compressed: ${(Z.blob.size/1024/1024).toFixed(2)} MB`);const J=i.name||`Photo ${i.id}`,P=cg(c.current,J),I=lg(n.name,n.id,J,P.sequential,P.sub),ue={id:crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,photoReqId:i.id,photoReqName:J,filename:I+".jpg",blob:Z.blob,dataUrl:Z.dataUrl,size:Z.blob.size,width:Z.width,height:Z.height,capturedAt:new Date().toISOString(),status:"pending",source:"gallery"},pe=[...c.current,ue];c.current=pe,l(pe),await ze.savePhoto(n.id,ue),console.log(" Gallery photo saved:",ue.filename)}catch(Z){console.error(`Error processing file ${y.name}:`,Z),alert(`Failed to process photo: ${y.name}`)}}console.log(` Finished processing ${O.length} file(s)`),ie.target.value=""}};return!n||!i?D.jsx("div",{className:"spinner"}):D.jsxs("div",{children:[D.jsx("div",{className:"header",children:D.jsxs("div",{className:"container",style:{display:"flex",alignItems:"center",gap:"12px"},children:[D.jsx(So,{to:`/site/${e}`,style:{color:"white",fontSize:"24px",textDecoration:"none"},children:""}),D.jsxs("div",{children:[D.jsxs("h1",{style:{fontSize:"16px"},children:[i.id,": ",i.name]}),D.jsxs("p",{style:{margin:0,opacity:.9,fontSize:"12px"},children:[n.name," - Project #",n.id]})]})]})}),D.jsxs("div",{className:"container",children:[D.jsxs("div",{className:"card mb-3",children:[D.jsx("h3",{style:{fontSize:"16px",marginBottom:"8px"},children:"Photo Description"}),D.jsx("p",{className:"text-muted",style:{marginBottom:"12px"},children:i.description||"No description available"}),D.jsxs("div",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:["Category: ",i.category]})]}),u?D.jsxs("div",{className:"card mb-3",children:[D.jsx("video",{ref:g,autoPlay:!0,playsInline:!0,style:{width:"100%",borderRadius:"8px",marginBottom:"12px",backgroundColor:"#000"}}),D.jsxs("div",{className:"grid grid-2",children:[D.jsx("button",{onClick:B,className:"btn btn-success",children:" Capture"}),D.jsx("button",{onClick:b,className:"btn btn-danger",children:" Close Camera"})]}),K&&D.jsxs("div",{style:{marginTop:"12px",padding:"0 8px"},children:[D.jsxs("label",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",marginBottom:"4px"},children:[D.jsxs("span",{children:["Zoom: ",X.toFixed(1),"x"]}),D.jsxs("span",{children:[V.max,"x"]})]}),D.jsx("input",{type:"range",min:V.min,max:V.max,step:V.step,value:X,onChange:H,style:{width:"100%",accentColor:"var(--primary-color)"}})]})]}):D.jsxs("div",{className:"card mb-3 text-center",children:[D.jsx("button",{onClick:q,className:"btn btn-primary",style:{width:"100%",marginBottom:"10px"},children:" Open Camera"}),D.jsx("button",{onClick:()=>{var ie;return(ie=w.current)==null?void 0:ie.click()},className:"btn btn-secondary",style:{width:"100%"},children:" Upload From Gallery"}),D.jsx("input",{type:"file",ref:w,accept:"image/*",multiple:!0,hidden:!0,onChange:ve})]}),D.jsxs("div",{className:"card mb-3",children:[D.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px",flexWrap:"wrap",gap:"8px"},children:[D.jsxs("div",{children:[D.jsx("h3",{style:{fontSize:"16px",margin:0},children:"Photos"}),D.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:[j?D.jsx("span",{children:" Checking SharePoint..."}):Q!==null?D.jsxs("span",{style:{color:Q>0?"#4caf50":"#999"},children:[" ",Q," in SharePoint"]}):D.jsx("span",{children:" Could not check SharePoint"}),o.length>0&&D.jsxs("span",{style:{marginLeft:"12px"},children:[" ",o.length," local (pending upload)"]})]})]}),D.jsxs("div",{style:{fontSize:"12px",display:"flex",alignItems:"center",gap:"12px"},children:[D.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[D.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:_==="locked"?"#4caf50":_==="error"?"#f44336":"#ff9800",boxShadow:`0 0 4px ${_==="locked"?"#4caf50":_==="error"?"#f44336":"#ff9800"}`}}),D.jsx("span",{style:{color:"#666"},children:_==="locked"?"GPS":_==="error"?"GPS Error":"GPS..."})]}),D.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[D.jsx("span",{style:{fontSize:"14px"},children:""}),D.jsx("span",{style:{color:R!==null?"#666":"#999"},children:R!==null?D.jsxs(D.Fragment,{children:[R," ",["N","NE","E","SE","S","SW","W","NW"][Math.round(R/45)%8]]}):"No compass"})]})]}),D.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.length>0&&D.jsx("button",{onClick:xe,className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"14px"},children:" Download"}),D.jsx("button",{onClick:de,className:"btn btn-primary",style:{padding:"6px 12px",fontSize:"14px"},children:" View in SharePoint"})]})]}),o.length===0?D.jsx("div",{className:"text-muted text-center",style:{padding:"12px"},children:Q>0?D.jsxs("p",{style:{margin:0},children:[" ",Q," photos already uploaded to SharePoint.",D.jsx("br",{}),D.jsx("span",{style:{fontSize:"12px"},children:'Use "View in SharePoint" to see them.'})]}):D.jsx("p",{style:{margin:0},children:"No photos captured yet"})}):D.jsx("div",{className:"grid",children:o.map(ie=>D.jsxs("div",{style:{border:"2px solid var(--border-color)",borderRadius:"8px",padding:"8px"},children:[D.jsx("img",{src:ie.dataUrl,alt:ie.filename,style:{width:"100%",borderRadius:"4px",marginBottom:"8px"}}),D.jsx("div",{style:{fontSize:"12px",marginBottom:"4px",wordBreak:"break-word"},children:D.jsx("strong",{children:ie.filename})}),D.jsx("div",{style:{fontSize:"11px",color:"var(--text-secondary)",marginBottom:"8px"},children:new Date(ie.capturedAt).toLocaleString()}),p===ie.id?D.jsxs("div",{className:"grid grid-2",style:{gap:"8px"},children:[D.jsx("button",{onClick:()=>ee(ie.id),className:"btn btn-danger",style:{padding:"6px",fontSize:"12px"},children:" Confirm"}),D.jsx("button",{onClick:()=>h(null),className:"btn btn-secondary",style:{padding:"6px",fontSize:"12px"},children:" Cancel"})]}):D.jsx("button",{onClick:()=>h(ie.id),className:"btn btn-danger",style:{width:"100%",padding:"6px",fontSize:"12px"},children:" Delete"})]},ie.id))})]}),D.jsxs("div",{className:"card",style:{backgroundColor:"#e3f2fd"},children:[D.jsx("h4",{style:{fontSize:"14px",marginBottom:"8px",color:"var(--primary-dark)"},children:" Instructions"}),D.jsxs("ul",{style:{fontSize:"12px",marginLeft:"20px",color:"var(--text-primary)"},children:[D.jsx("li",{children:"Photos are automatically named with site and requirement info"}),D.jsx("li",{children:"You can capture multiple photos for this requirement"}),D.jsx("li",{children:"Download photos to save them to your device"}),D.jsxs("li",{children:["Upload photos to SharePoint manually following folder structure: ",n.phase," ",">"," ",n.name," ",">"," Photos"]})]})]})]})]})}function Y6(){const{siteId:e}=bd(),t=js(),r=Ms(),[n,a]=fe.useState(null),[i,s]=fe.useState(!0),[o,l]=fe.useState(!1),[c,u]=fe.useState({current:0,total:0,status:""}),[f,p]=fe.useState({}),[h,m]=fe.useState({walkedBy:"",dateWalked:new Date().toISOString().split("T")[0],checkedIn:"",checkedOut:"",towerOwner:"",faNumber:"",pocName:"",pocPhone:"",pocEmail:"",towerType:"",leaseAreaType:"",powerCompany:"",meterNumber:"",telcoFiberProvider:"",telcoFiberPOC:"",measurement1:"",measurement2:"",measurement3:"",measurement4:"",measurement5:"",measurement6:"",measurement7:"",measurement8:"",measurement9:"",measurement10:"",measurement11:"",leaseAreaIssues:"",gateShelterCode:""}),[d,v]=fe.useState({measurement1:!1,measurement2:!1,measurement3:!1,measurement4:!1,measurement5:!1,measurement6:!1,measurement7:!1,measurement8:!1,measurement9:!1,measurement10:!1,measurement11:!1,leaseAreaIssues:!1,gateShelterCode:!1});fe.useEffect(()=>{(async()=>{var k;try{const C=(await ze.getSites()).find(N=>N.id===e);if(C){a(C);let N={towerOwner:C.towerOwner||"",faNumber:C.towerOwnerSiteNumber||"",powerCompany:C.powerCompany||"",meterNumber:C.meterNumber||"",telcoFiberProvider:C.telcoProvider||"",telcoFiberPOC:C.telcoProviderPOC||"",leaseAreaType:C.leaseAreaType||"",gateShelterCode:C.gateCode||"",towerType:C.siteType||"",walkedBy:C.walkedBy||"",dateWalked:C.dateWalked||new Date().toISOString().split("T")[0],checkedIn:C.checkedIn||"",checkedOut:C.checkedOut||"",leaseAreaIssues:C.leaseAreaIssues||"",measurement1:C.measurement1||"",measurement2:C.measurement2||"",measurement3:C.measurement3||"",measurement4:C.measurement4||"",measurement5:C.measurement5||"",measurement6:C.measurement6||"",measurement7:C.measurement7||"",measurement8:C.measurement8||"",measurement9:C.measurement9||"",measurement10:C.measurement10||"",measurement11:C.measurement11||""};if(C.viaeropoc){const V=C.viaeropoc.split(",").map(T=>T.trim());console.log(" PARSING VIAERO POC:",C.viaeropoc,"",V),V[0]&&(N.pocName=V[0]),V[1]&&(N.pocPhone=V[1]),V[2]&&(N.pocEmail=V[2])}console.log(" SITE DATA FOR PRE-POPULATION:",C),console.log(" INITIAL DATA WITH POC:",{pocName:N.pocName,pocPhone:N.pocPhone,pocEmail:N.pocEmail});const X=await ze.getQuestionnaire(e);if(X&&X.data){console.log("Loaded saved questionnaire:",X.data),N={...N,...X.data},C.towerOwnerSiteNumber&&(N.faNumber=C.towerOwnerSiteNumber),C.towerOwner&&(N.towerOwner=C.towerOwner),C.powerCompany&&(N.powerCompany=C.powerCompany),C.meterNumber&&(N.meterNumber=C.meterNumber),C.telcoProvider&&(N.telcoFiberProvider=C.telcoProvider),C.telcoProviderPOC&&(N.telcoFiberPOC=C.telcoProviderPOC),C.leaseAreaType&&(N.leaseAreaType=C.leaseAreaType),C.gateCode&&(N.gateShelterCode=C.gateCode),C.dateWalked&&(N.dateWalked=C.dateWalked),C.walkedBy&&(N.walkedBy=C.walkedBy),C.checkedIn&&(N.checkedIn=C.checkedIn),C.checkedOut&&(N.checkedOut=C.checkedOut),C.leaseAreaIssues&&(N.leaseAreaIssues=C.leaseAreaIssues);for(let V=1;V<=11;V++)C[`measurement${V}`]&&(N[`measurement${V}`]=C[`measurement${V}`]);console.log(" Re-applied tracker values over local cache")}if((k=r.state)!=null&&k.loadFromCloud)try{console.log("Loading remote questionnaire...");const V=await wt.downloadQuestionnaire(C.phase,C.name,C.id);V&&(console.log("Loaded remote data:",V),N={...N,...V},await ze.saveQuestionnaire(e,N,"synced"))}catch(V){console.error("Failed to load remote questionnaire:",V)}const A={...d};Object.keys(A).forEach(V=>{N[V]==="N/A"?A[V]=!0:A[V]=!1}),v(A),console.log(" FINAL initialData being set to formData:",N),m(V=>{const T={...V,...N};return console.log(" NEW formData after merge:",T),T})}}catch(R){console.error("Error loading data:",R)}finally{s(!1)}})()},[e]);const g=(E,k)=>{m(R=>({...R,[E]:k})),f[E]&&p(R=>({...R,[E]:null}))},x=E=>{v(k=>{const R={...k,[E]:!k[E]};return R[E]?m(C=>({...C,[E]:"N/A"})):m(C=>({...C,[E]:""})),R}),f[E]&&p(k=>({...k,[E]:null}))},w=()=>{const E={};return Object.keys(h).forEach(R=>{(!h[R]||h[R].trim()==="")&&(E[R]="This field is required")}),p(E),Object.keys(E).length===0},_=async()=>{if(!w()){alert("Please fill in all required fields.");return}l(!0),u({current:0,total:1,status:"Updating Site Tracker..."});try{await wt.updateSiteTrackerRow(n.id,h),u({current:1,total:1,status:` Success! Site Tracker updated directly.

Site: ${n.name}

Sending email notification...`});try{const E=`Documents > Telamon - Viaero Site Walks > ${Qe.sharepoint.siteDetailsFile}`;await v_.sendUploadNotification(n.name,"questionnaire",1,{folderPath:E}),u(k=>({...k,status:` Success! Site Tracker updated directly.

Site: ${n.name}

 Email notification sent!`}))}catch(E){console.error("Email notification failed:",E)}await ze.saveQuestionnaire(n.id,{data:h,uploadedAt:new Date().toISOString()},"synced")}catch(E){console.error("Update error:",E),u({current:0,total:1,status:` Update failed: ${E.message}`})}},S=(E,k,R=null,C=!1,N="text",X="")=>{const A=C&&d[k];return D.jsxs("div",{style:{marginBottom:"16px"},children:[D.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[D.jsxs("label",{style:{fontWeight:"500",fontSize:"14px"},children:[E," ",D.jsx("span",{style:{color:"red"},children:"*"})]}),C&&D.jsxs("label",{style:{fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},children:[D.jsx("input",{type:"checkbox",checked:d[k],onChange:()=>x(k)}),"N/A"]})]}),R&&D.jsx("p",{style:{fontSize:"12px",color:"#666",margin:"0 0 4px 0"},children:R}),N==="textarea"?D.jsx("textarea",{value:h[k],onChange:V=>g(k,V.target.value),disabled:A,placeholder:X,style:{width:"100%",padding:"10px",borderRadius:"6px",border:f[k]?"2px solid red":"1px solid #ddd",fontSize:"14px",minHeight:"80px",backgroundColor:A?"#f5f5f5":"white"}}):D.jsx("input",{type:N,value:h[k],onChange:V=>g(k,V.target.value),disabled:A,placeholder:X,style:{width:"100%",padding:"10px",borderRadius:"6px",border:f[k]?"2px solid red":"1px solid #ddd",fontSize:"14px",backgroundColor:A?"#f5f5f5":"white"}}),f[k]&&D.jsx("p",{style:{color:"red",fontSize:"12px",margin:"4px 0 0 0"},children:f[k]})]})};return i?D.jsx("div",{style:{padding:"20px"},children:"Loading Site..."}):n?D.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f5f5f5"},children:[D.jsx("div",{className:"header",children:D.jsxs("div",{className:"container",style:{display:"flex",alignItems:"center",gap:"12px"},children:[D.jsx("button",{onClick:()=>t(-1),style:{background:"none",border:"none",color:"white",fontSize:"24px",cursor:"pointer"},children:""}),D.jsxs("div",{children:[D.jsx("h1",{style:{fontSize:"18px",margin:0},children:"Site Walk Questionnaire"}),D.jsxs("p",{style:{margin:0,opacity:.9,fontSize:"12px"},children:[n.name," - Site ID: ",n.id]})]})]})}),D.jsxs("div",{className:"container",style:{padding:"20px",paddingBottom:"100px"},children:[D.jsxs("div",{className:"card",style:{marginBottom:"16px"},children:[D.jsx("h3",{style:{marginTop:0,marginBottom:"16px",borderBottom:"1px solid #eee",paddingBottom:"8px"},children:" Basic Information"}),S("Walked By","walkedBy",null,!1,"text","Technician name"),S("Date Walked","dateWalked",null,!1,"date"),S("Checked In","checkedIn",null,!1,"time"),S("Checked Out","checkedOut",null,!1,"time")]}),D.jsxs("div",{className:"card",style:{marginBottom:"16px"},children:[D.jsx("h3",{style:{marginTop:0,marginBottom:"16px",borderBottom:"1px solid #eee",paddingBottom:"8px"},children:" Site Details"}),S("Tower Owner","towerOwner"),S("FA Number","faNumber","Tower Owner Site Number"),S("Tower Type","towerType",null,!1,"text","e.g., Monopole, Lattice, Guyed"),S("Lease Area Type","leaseAreaType",null,!1,"text","e.g., Compound, Rooftop")]}),D.jsxs("div",{className:"card",style:{marginBottom:"16px"},children:[D.jsx("h3",{style:{marginTop:0,marginBottom:"16px",borderBottom:"1px solid #eee",paddingBottom:"8px"},children:" Contact Information"}),S("POC Name","pocName"),S("POC Phone","pocPhone",null,!1,"tel"),S("POC Email","pocEmail",null,!1,"email")]}),D.jsxs("div",{className:"card",style:{marginBottom:"16px"},children:[D.jsx("h3",{style:{marginTop:0,marginBottom:"16px",borderBottom:"1px solid #eee",paddingBottom:"8px"},children:" Utility Information"}),S("Power Company","powerCompany"),S("Meter Number","meterNumber"),S("Telco / Fiber Provider","telcoFiberProvider"),S("Telco / Fiber POC","telcoFiberPOC")]}),D.jsxs("div",{className:"card",style:{marginBottom:"16px"},children:[D.jsx("h3",{style:{marginTop:0,marginBottom:"16px",borderBottom:"1px solid #eee",paddingBottom:"8px"},children:" Measurements"}),S("Measurement 1 (inches)","measurement1","Horizontal distance from AC Load Center to DC Power Plant (How a conduit would route)",!0),S("Measurement 2 (inches)","measurement2","Horizontal distance from Ran Rack to DC Power Plant along cable tray",!0),S("Measurement 3 (inches)","measurement3","Horizontal distance from Ran Rack to Alarm Panel along cable tray to wall above Alarm Panel J-Box",!0),S("Measurement 4 (inches)","measurement4","Horizontal distance from Ran Rack to Shelter Exit Port",!0),S("Measurement 5 (inches)","measurement5","Horizontal distance from DC Power Plant to Shelter Exit Port",!0),S("Measurement 6 (inches)","measurement6","Horizontal & Vertical distance from Ran Rack to GPS Arrestor (Usually mounted on Shelter MGB)",!0),S("Measurement 7 (inches)","measurement7","Horizontal distance from GPS Arrestor to existing GPS Antenna outdoors (Usually on Ice Bridge post)",!0),S("Measurement 8 (inches)","measurement8","Horizontal distance from Ran Rack to Shelter Master Ground Bar (MGB)",!0),S("Measurement 9 (inches)","measurement9","Horizontal distance from Ice Bridge Post, where proposed OVPs and Unistrut will be installed, to Tower face",!0),S("Measurement 10 (feet)","measurement10","Carrier RAD center",!0),S("Measurement 11 (feet)","measurement11","Tower Face Width",!0)]}),D.jsxs("div",{className:"card",style:{marginBottom:"16px"},children:[D.jsx("h3",{style:{marginTop:0,marginBottom:"16px",borderBottom:"1px solid #eee",paddingBottom:"8px"},children:" Additional Information"}),S("Lease Area Issues","leaseAreaIssues",null,!0,"textarea","Describe any issues with the lease area..."),S("Gate/Shelter Code","gateShelterCode",null,!0)]}),D.jsx("button",{onClick:_,className:"btn btn-primary",style:{width:"100%",padding:"16px",fontSize:"16px",fontWeight:"600"},children:" Save & Upload to SharePoint"})]}),o&&D.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:D.jsxs("div",{style:{backgroundColor:"white",padding:"24px",borderRadius:"12px",maxWidth:"400px",width:"90%"},children:[D.jsx("h3",{style:{marginTop:0},children:"Uploading to SharePoint"}),c.current<c.total&&D.jsx("div",{style:{height:"8px",backgroundColor:"#e0e0e0",borderRadius:"4px",marginBottom:"16px",overflow:"hidden"},children:D.jsx("div",{style:{height:"100%",width:"100%",backgroundColor:"#1976d2",animation:"pulse 1.5s infinite"}})}),D.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:"14px",marginBottom:"20px",minHeight:"60px"},children:c.status}),(c.current===c.total||c.status.includes(""))&&D.jsx("button",{onClick:()=>{l(!1),c.current===c.total&&!c.status.includes("")&&t(-1)},className:"btn btn-primary",style:{width:"100%"},children:"Close"})]})}),D.jsx("style",{children:`
                @keyframes pulse {
                    0%, 100% { opacity: 1; }
                    50% { opacity: 0.5; }
                }
            `})]}):D.jsx("div",{style:{padding:"20px"},children:"Site not found"})}function J6({onDataLoaded:e}){const t=js(),[r,n]=fe.useState(!1),[a,i]=fe.useState(""),[s,o]=fe.useState(null),[l,c]=fe.useState(null),[u,f]=fe.useState(!1),[p,h]=fe.useState(!1),m=async x=>{const w=x.target.files[0];w&&(o(w),i(""),f(!0))},d=async x=>{const w=x.target.files[0];w&&(c(w),i(""),h(!0))},v=async()=>{if(!s||!l){i("Please upload both files before continuing.");return}n(!0),i("");try{const x=await Oo.loadSiteTracker(s);if(x.length===0){i("No sites found in the Site Tracker file. Please check the file format."),n(!1);return}const w=await Oo.loadPhotoRequirements(l);if(w.length===0){i("No photo requirements found in the Photo Requirements file. Please check the file format."),n(!1);return}ze.savePhotoRequirements(w),await e(x),n(!1),t("/")}catch(x){i(x.message||"Failed to load Excel files. Please try again."),n(!1)}},g=()=>{e([{id:"435",name:"NE-FRANKLIN",address:"123 Tower Road",city:"Franklin",state:"NE",zip:"68939",latitude:"40.0969",longitude:"-99.2168",phase:"Phase 9",towerOwner:"American Tower",powerCompany:"Southern Power District",meterNumber:"12345678",telcoProvider:"AT&T",leaseAreaType:"Compound",gateCode:"",photosUploaded:"",formUploaded:"",dateWalked:"",walkedBy:""},{id:"436",name:"NE-BRYNWOOD",address:"456 Signal Ave",city:"Brynwood",state:"NE",zip:"68001",latitude:"41.2565",longitude:"-96.0086",phase:"Phase 9",towerOwner:"Crown Castle",powerCompany:"Nebraska Public Power",meterNumber:"87654321",telcoProvider:"Verizon",leaseAreaType:"Rooftop",gateCode:"1234",photosUploaded:"",formUploaded:"",dateWalked:"",walkedBy:""}])};return D.jsxs("div",{children:[D.jsx("div",{className:"header",children:D.jsx("div",{className:"container",children:D.jsx("h1",{children:" Viaero Site Walk"})})}),D.jsx("div",{className:"container",style:{paddingTop:"40px"},children:D.jsxs("div",{className:"card",style:{maxWidth:"600px",margin:"0 auto"},children:[D.jsx("h2",{style:{marginBottom:"8px",textAlign:"center"},children:"Welcome"}),D.jsx("p",{className:"text-muted mb-3",style:{textAlign:"center"},children:"Upload both Excel files to get started."}),a&&D.jsx("div",{style:{padding:"12px",marginBottom:"16px",backgroundColor:"#ffebee",color:"#c62828",borderRadius:"8px"},children:a}),D.jsxs("div",{style:{marginBottom:"20px"},children:[D.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",fontSize:"14px"},children:"1. Site Tracker File"}),D.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:m,style:{display:"none"},id:"site-tracker-upload",disabled:r}),D.jsx("label",{htmlFor:"site-tracker-upload",className:`btn ${u?"btn-secondary":"btn-primary"} ${r?"disabled":""}`,style:{display:"block",cursor:r?"not-allowed":"pointer"},children:u?D.jsxs(D.Fragment,{children:[" ",s.name]}):D.jsx(D.Fragment,{children:" Upload Site Tracker"})}),D.jsx("p",{className:"text-muted",style:{fontSize:"12px",marginTop:"4px"},children:"Expected: Telamon Site Details"})]}),D.jsxs("div",{style:{marginBottom:"20px"},children:[D.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",fontSize:"14px"},children:"2. Photo Requirements File"}),D.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:d,style:{display:"none"},id:"photo-reqs-upload",disabled:r}),D.jsx("label",{htmlFor:"photo-reqs-upload",className:`btn ${p?"btn-secondary":"btn-primary"} ${r?"disabled":""}`,style:{display:"block",cursor:r?"not-allowed":"pointer"},children:p?D.jsxs(D.Fragment,{children:[" ",l.name]}):D.jsx(D.Fragment,{children:" Upload Photo Requirements"})}),D.jsx("p",{className:"text-muted",style:{fontSize:"12px",marginTop:"4px"},children:"Expected: Telamon Photo Requirements.xlsx"})]}),D.jsx("button",{onClick:v,className:"btn btn-primary",disabled:r||!u||!p,style:{width:"100%",marginBottom:"12px",opacity:!u||!p?.5:1},children:r?D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"spinner",style:{width:"20px",height:"20px",display:"inline-block",marginRight:"8px"}}),"Loading..."]}):D.jsx(D.Fragment,{children:"Continue "})}),D.jsx("button",{onClick:g,className:"btn btn-secondary",disabled:r,style:{width:"100%"},children:" Load Demo Data (Testing)"})]})})]})}const Q6=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class wp extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Z6 extends wp{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class ug extends wp{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class fg extends wp{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var mh;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(mh||(mh={}));class eI{constructor(t,{headers:r={},customFetch:n,region:a=mh.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Q6(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return ME(this,arguments,void 0,function*(r,n={}){var a;let i,s;try{const{headers:o,method:l,body:c,signal:u,timeout:f}=n;let p={},{region:h}=n;h||(h=this.region);const m=new URL(`${this.url}/${r}`);h&&h!=="any"&&(p["x-region"]=h,m.searchParams.set("forceFunctionRegion",h));let d;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",d=c):typeof c=="string"?(p["Content-Type"]="text/plain",d=c):typeof FormData<"u"&&c instanceof FormData?d=c:(p["Content-Type"]="application/json",d=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?d=JSON.stringify(c):d=c;let v=u;f&&(s=new AbortController,i=setTimeout(()=>s.abort(),f),u?(v=s.signal,u.addEventListener("abort",()=>s.abort())):v=s.signal);const g=yield this.fetch(m.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),o),body:d,signal:v}).catch(S=>{throw new Z6(S)}),x=g.headers.get("x-relay-error");if(x&&x==="true")throw new ug(g);if(!g.ok)throw new fg(g);let w=((a=g.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),_;return w==="application/json"?_=yield g.json():w==="application/octet-stream"||w==="application/pdf"?_=yield g.blob():w==="text/event-stream"?_=g:w==="multipart/form-data"?_=yield g.formData():_=yield g.text(),{data:_,error:null,response:g}}catch(o){return{data:null,error:o,response:o instanceof fg||o instanceof ug?o.context:void 0}}finally{i&&clearTimeout(i)}})}}var tI=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},rI=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let s=null,o=null,l=null,c=i.status,u=i.statusText;if(i.ok){var f,p;if(r.method!=="HEAD"){var h;const g=await i.text();g===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((h=r.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?o=g:o=JSON.parse(g))}const d=(f=r.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),v=(p=i.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");d&&v&&v.length>1&&(l=parseInt(v[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(s={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,c=406,u="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var m;const d=await i.text();try{s=JSON.parse(d),Array.isArray(s)&&i.status===404&&(o=[],s=null,c=200,u="OK")}catch{i.status===404&&d===""?(c=204,u="No Content"):s={message:d}}if(s&&r.isMaybeSingle&&(!(s==null||(m=s.details)===null||m===void 0)&&m.includes("0 rows"))&&(s=null,c=200,u="OK"),s&&r.shouldThrowOnError)throw new tI(s)}return{error:s,data:o,count:l,status:c,statusText:u}});return this.shouldThrowOnError||(a=a.catch(i=>{var s;let o="";const l=i==null?void 0:i.cause;if(l){var c,u,f,p;const m=(c=l==null?void 0:l.message)!==null&&c!==void 0?c:"",d=(u=l==null?void 0:l.code)!==null&&u!==void 0?u:"";o=`${(f=i==null?void 0:i.name)!==null&&f!==void 0?f:"FetchError"}: ${i==null?void 0:i.message}`,o+=`

Caused by: ${(p=l==null?void 0:l.name)!==null&&p!==void 0?p:"Error"}: ${m}`,d&&(o+=` (${d})`),l!=null&&l.stack&&(o+=`
${l.stack}`)}else{var h;o=(h=i==null?void 0:i.stack)!==null&&h!==void 0?h:""}return{error:{message:`${(s=i==null?void 0:i.name)!==null&&s!==void 0?s:"FetchError"}: ${i==null?void 0:i.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},nI=class extends rI{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}={}){const i=a?`${a}.order`:"order",s=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${s?`${s},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:i="text"}={}){var s;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=(s=this.headers.get("Accept"))!==null&&s!==void 0?s:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const hg=new RegExp("[,()]");var Xi=class extends nI{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&hg.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&hg.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},aI=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},a=r?"HEAD":"GET";let i=!1;const s=(e??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join(""),{url:o,headers:l}=this.cloneRequestState();return o.searchParams.set("select",s),n&&l.append("Prefer",`count=${n}`),new Xi({method:a,url:o,headers:l,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const a="POST",{url:i,headers:s}=this.cloneRequestState();if(t&&s.append("Prefer",`count=${t}`),r||s.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);i.searchParams.set("columns",l.join(","))}}return new Xi({method:a,url:i,headers:s,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}={}){var i;const s="POST",{url:o,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&l.append("Prefer",`count=${n}`),a||l.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(c.length>0){const u=[...new Set(c)].map(f=>`"${f}"`);o.searchParams.set("columns",u.join(","))}}return new Xi({method:s,url:o,headers:l,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:a,headers:i}=this.cloneRequestState();return t&&i.append("Prefer",`count=${t}`),new Xi({method:n,url:a,headers:i,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new Xi({method:r,url:n,headers:a,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},iI=class w_{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new aI(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new w_(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){var s;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;const u=h=>h!==null&&typeof h=="object"&&(!Array.isArray(h)||h.some(u)),f=n&&Object.values(r).some(u);f?(o="POST",c=r):n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([h,m])=>m!==void 0).map(([h,m])=>[h,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([h,m])=>{l.searchParams.append(h,m)})):(o="POST",c=r);const p=new Headers(this.headers);return f?p.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&p.set("Prefer",`count=${i}`),new Xi({method:o,url:l,headers:p,schema:this.schemaName,body:c,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};class sI{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const a=n.node,i=parseInt(a.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const oI="2.93.3",lI=`realtime-js/${oI}`,cI="1.0.0",y_="2.0.0",dg=y_,gh=1e4,uI=1e3,fI=100;var pa;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(pa||(pa={}));var Wt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Wt||(Wt={}));var _n;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(_n||(_n={}));var vh;(function(e){e.websocket="websocket"})(vh||(vh={}));var ri;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ri||(ri={}));class hI{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},s=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,s)}_encodeUserBroadcastPush(t,r,n){var a,i;const s=t.topic,o=(a=t.ref)!==null&&a!==void 0?a:"",l=(i=t.join_ref)!==null&&i!==void 0?i:"",c=t.payload.event,u=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},f=Object.keys(u).length===0?"":JSON.stringify(u);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(s.length>255)throw new Error(`topic length ${s.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`metadata length ${f.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+s.length+c.length+f.length,h=new ArrayBuffer(this.HEADER_LENGTH+p);let m=new DataView(h),d=0;m.setUint8(d++,this.KINDS.userBroadcastPush),m.setUint8(d++,l.length),m.setUint8(d++,o.length),m.setUint8(d++,s.length),m.setUint8(d++,c.length),m.setUint8(d++,f.length),m.setUint8(d++,r),Array.from(l,g=>m.setUint8(d++,g.charCodeAt(0))),Array.from(o,g=>m.setUint8(d++,g.charCodeAt(0))),Array.from(s,g=>m.setUint8(d++,g.charCodeAt(0))),Array.from(c,g=>m.setUint8(d++,g.charCodeAt(0))),Array.from(f,g=>m.setUint8(d++,g.charCodeAt(0)));var v=new Uint8Array(h.byteLength+n.byteLength);return v.set(new Uint8Array(h),0),v.set(new Uint8Array(n),h.byteLength),v.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[a,i,s,o,l]=n;return r({join_ref:a,ref:i,topic:s,event:o,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2),s=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const c=n.decode(t.slice(l,l+a));l=l+a;const u=n.decode(t.slice(l,l+i));l=l+i;const f=n.decode(t.slice(l,l+s));l=l+s;const p=t.slice(l,t.byteLength),h=o===this.JSON_ENCODING?JSON.parse(n.decode(p)):p,m={type:this.BROADCAST_EVENT,event:u,payload:h};return s>0&&(m.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:m}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class __{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ht;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ht||(ht={}));const pg=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,s)=>(i[s]=dI(s,e,t,a),i),{}):{}},dI=(e,t,r,n)=>{const a=t.find(o=>o.name===e),i=a==null?void 0:a.type,s=r[e];return i&&!n.includes(i)?k_(i,s):xh(s)},k_=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return vI(t,r)}switch(e){case ht.bool:return pI(t);case ht.float4:case ht.float8:case ht.int2:case ht.int4:case ht.int8:case ht.numeric:case ht.oid:return mI(t);case ht.json:case ht.jsonb:return gI(t);case ht.timestamp:return xI(t);case ht.abstime:case ht.date:case ht.daterange:case ht.int4range:case ht.int8range:case ht.money:case ht.reltime:case ht.text:case ht.time:case ht.timestamptz:case ht.timetz:case ht.tsrange:case ht.tstzrange:return xh(t);default:return xh(t)}},xh=e=>e,pI=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},mI=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},gI=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},vI=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const s=e.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(o=>k_(t,o))}return e},xI=e=>typeof e=="string"?e.replace(" ","T"):e,S_=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class qf{constructor(t,r,n={},a=gh){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var mg;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(mg||(mg={}));class Io{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Io.syncState(this.state,a,i,s),this.pendingDiffs.forEach(l=>{this.state=Io.syncDiff(this.state,l,i,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Io.syncDiff(this.state,a,i,s),o())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),s=this.transformState(r),o={},l={};return this.map(i,(c,u)=>{s[c]||(l[c]=u)}),this.map(s,(c,u)=>{const f=i[c];if(f){const p=u.map(v=>v.presence_ref),h=f.map(v=>v.presence_ref),m=u.filter(v=>h.indexOf(v.presence_ref)<0),d=f.filter(v=>p.indexOf(v.presence_ref)<0);m.length>0&&(o[c]=m),d.length>0&&(l[c]=d)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(h=>h.presence_ref),p=u.filter(h=>f.indexOf(h.presence_ref)<0);t[o].unshift(...p)}n(o,u,l)}),this.map(s,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var gg;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(gg||(gg={}));var No;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(No||(No={}));var Gn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Gn||(Gn={}));class hs{constructor(t,r={config:{}},n){var a,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Wt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new qf(this,_n.join,this.params,this.timeout),this.rejoinTimer=new __(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Wt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Wt.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Wt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_n.reply,{},(s,o)=>{this._trigger(this._replyEventName(o),s)}),this.presence=new Io(this),this.broadcastEndpointURL=S_(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Wt.closed){const{config:{broadcast:s,presence:o,private:l}}=this.params,c=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[No.PRESENCE]&&this.bindings[No.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},p={broadcast:s,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(h=>t==null?void 0:t(Gn.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(Gn.CLOSED)),this.updateJoinPayload(Object.assign({config:p},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var m;if(this.socket._isManualToken()||this.socket.setAuth(),h===void 0){t==null||t(Gn.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,v=(m=d==null?void 0:d.length)!==null&&m!==void 0?m:0,g=[];for(let x=0;x<v;x++){const w=d[x],{filter:{event:_,schema:S,table:E,filter:k}}=w,R=h&&h[x];if(R&&R.event===_&&hs.isFilterValueEqual(R.schema,S)&&hs.isFilterValueEqual(R.table,E)&&hs.isFilterValueEqual(R.filter,k))g.push(Object.assign(Object.assign({},w),{id:R.id}));else{this.unsubscribe(),this.state=Wt.errored,t==null||t(Gn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Gn.SUBSCRIBED);return}}).receive("error",h=>{this.state=Wt.errored,t==null||t(Gn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Gn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Wt.joined&&t===No.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const s={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,s,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:s}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Wt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_n.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new qf(this,_n.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Wt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new qf(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>fI){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const s=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=_n;if(n&&[o,l,c,u].indexOf(s)>=0&&n!==this._joinRef())return;let p=this._onMessage(s,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var m,d,v;return((m=h.filter)===null||m===void 0?void 0:m.event)==="*"||((v=(d=h.filter)===null||d===void 0?void 0:d.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===s}).map(h=>h.callback(p,n)):(i=this.bindings[s])===null||i===void 0||i.filter(h=>{var m,d,v,g,x,w;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in h){const _=h.id,S=(m=h.filter)===null||m===void 0?void 0:m.event;return _&&((d=r.ids)===null||d===void 0?void 0:d.includes(_))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const _=(x=(g=h==null?void 0:h.filter)===null||g===void 0?void 0:g.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return _==="*"||_===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===s}).map(h=>{if(typeof p=="object"&&"ids"in p){const m=p.data,{schema:d,table:v,commit_timestamp:g,type:x,errors:w}=m;p=Object.assign(Object.assign({},{schema:d,table:v,commit_timestamp:g,eventType:x,new:{},old:{},errors:w}),this._getPayloadRecords(m))}h.callback(p,n)})}_isClosed(){return this.state===Wt.closed}_isJoined(){return this.state===Wt.joined}_isJoining(){return this.state===Wt.joining}_isLeaving(){return this.state===Wt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&hs.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(_n.close,{},t)}_onError(t){this._on(_n.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Wt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=pg(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=pg(t.columns,t.old_record)),r}}const Kf=()=>{},mc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},wI=[1e3,2e3,5e3,1e4],yI=1e4,_I=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class kI{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=gh,this.transport=null,this.heartbeatIntervalMs=mc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Kf,this.ref=0,this.reconnectTimer=null,this.vsn=dg,this.logger=Kf,this.conn=null,this.sendBuffer=[],this.serializer=new hI,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${vh.websocket}`,this.httpEndpoint=S_(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=sI.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case pa.connecting:return ri.Connecting;case pa.open:return ri.Open;case pa.closing:return ri.Closing;default:return ri.Closed}}isConnected(){return this.connectionState()===ri.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new hs(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,s=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(uI,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},mc.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(u){this.log("error","error in heartbeat callback",u)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:a,payload:i,ref:s}=r,o=s?`(${s})`:"",l=i.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),i),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(a,i,s)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===pa.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===pa.open||this.conn.readyState===pa.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(_n.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([_I],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const i={access_token:r,version:lI};r&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(_n.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new __(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},mc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,i,s,o,l,c,u,f,p,h;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:gh,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:mc.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(s=t==null?void 0:t.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Kf,this.vsn=(l=t==null?void 0:t.vsn)!==null&&l!==void 0?l:dg,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:m=>wI[m-1]||yI,this.vsn){case cI:this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(m,d)=>d(JSON.stringify(m)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:(m,d)=>d(JSON.parse(m));break;case y_:this.encode=(p=t==null?void 0:t.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var pl=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function SI(e,t,r){const n=new URL(t,e);if(r)for(const[a,i]of Object.entries(r))i!==void 0&&n.searchParams.set(a,i);return n.toString()}async function EI(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function TI(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:a,body:i,headers:s}){const o=SI(e.baseUrl,n,a),l=await EI(e.auth),c=await t(o,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...l,...s},body:i?JSON.stringify(i):void 0}),u=await c.text(),f=(c.headers.get("content-type")||"").includes("application/json"),p=f&&u?JSON.parse(u):u;if(!c.ok){const h=f?p:void 0,m=h==null?void 0:h.error;throw new pl((m==null?void 0:m.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:m==null?void 0:m.type,icebergCode:m==null?void 0:m.code,details:h})}return{status:c.status,headers:c.headers,data:p}}}}function gc(e){return e.join("")}var bI=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:gc(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${gc(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${gc(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${gc(e.namespace)}`}),!0}catch(t){if(t instanceof pl&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof pl&&r.status===409)return;throw r}}};function zi(e){return e.join("")}var CI=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${zi(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${zi(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${zi(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${zi(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${zi(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${zi(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof pl&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof pl&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},AI=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=TI({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new bI(this.client,t),this.tableOps=new CI(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Qu=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function Zu(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var vc=class extends Qu{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},E_=class extends Qu{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const FI=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),PI=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},wh=e=>{if(Array.isArray(e))return e.map(r=>wh(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=wh(n)}),t},RI=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function ml(e){"@babel/helpers - typeof";return ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ml(e)}function OI(e,t){if(ml(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ml(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function II(e){var t=OI(e,"string");return ml(t)=="symbol"?t:t+""}function NI(e,t,r){return(t=II(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Me(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vg(Object(r),!0).forEach(function(n){NI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vg(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const xg=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},DI=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const a=e,i=a.status||500;if(typeof a.json=="function")a.json().then(s=>{const o=(s==null?void 0:s.statusCode)||(s==null?void 0:s.code)||i+"";t(new vc(xg(s),i,o,n))}).catch(()=>{if(n==="vectors"){const s=i+"";t(new vc(a.statusText||`HTTP ${i} error`,i,s,n))}else{const s=i+"";t(new vc(a.statusText||`HTTP ${i} error`,i,s,n))}});else{const s=i+"";t(new vc(a.statusText||`HTTP ${i} error`,i,s,n))}}else t(new E_(xg(e),e,n))},LI=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!n?Me(Me({},a),r):(PI(n)?(a.headers=Me({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Me(Me({},a),r))};async function ao(e,t,r,n,a,i,s){return new Promise((o,l)=>{e(r,LI(t,n,a,i)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;if(s==="vectors"){const u=c.headers.get("content-type");if(c.headers.get("content-length")==="0"||c.status===204)return{};if(!u||!u.includes("application/json"))return{}}return c.json()}).then(c=>o(c)).catch(c=>DI(c,l,n,s))})}function T_(e="storage"){return{get:async(t,r,n,a)=>ao(t,"GET",r,n,a,void 0,e),post:async(t,r,n,a,i)=>ao(t,"POST",r,a,i,n,e),put:async(t,r,n,a,i)=>ao(t,"PUT",r,a,i,n,e),head:async(t,r,n,a)=>ao(t,"HEAD",r,Me(Me({},n),{},{noResolveJson:!0}),a,void 0,e),remove:async(t,r,n,a,i)=>ao(t,"DELETE",r,a,i,n,e)}}const BI=T_("storage"),{get:gl,post:wn,put:yh,head:UI,remove:yp}=BI,zr=T_("vectors");var Vs=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=FI(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zu(r))return{data:null,error:r};throw r}}},MI=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Zu(t))return{data:null,error:t};throw t}}};let b_;b_=Symbol.toStringTag;var jI=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[b_]="BlobDownloadBuilder",this.promise=null}asStream(){return new MI(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Zu(t))return{data:null,error:t};throw t}}};const $I={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},wg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var zI=class extends Vs{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var a=this;return a.handleOperation(async()=>{let i;const s=Me(Me({},wg),n);let o=Me(Me({},a.headers),e==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",a.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",s.cacheControl),l&&!i.has("metadata")&&i.append("metadata",a.encodeMetadata(l))):(i=r,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=a.toBase64(a.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!s.duplex&&(s.duplex="half")),n!=null&&n.headers&&(o=Me(Me({},o),n.headers));const c=a._removeEmptyFolders(t),u=a._getFinalPath(c),f=await(e=="PUT"?yh:wn)(a.fetch,`${a.url}/object/${u}`,i,Me({headers:o},s!=null&&s.duplex?{duplex:s.duplex}:{}));return{path:c,id:f.Id,fullPath:f.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var a=this;const i=a._removeEmptyFolders(e),s=a._getFinalPath(i),o=new URL(a.url+`/object/upload/sign/${s}`);return o.searchParams.set("token",t),a.handleOperation(async()=>{let l;const c=Me({upsert:wg.upsert},n),u=Me(Me({},a.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType),{path:i,fullPath:(await yh(a.fetch,o.toString(),l,{headers:u})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const a=Me({},r.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const i=await wn(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(r.url+i.url),o=s.searchParams.get("token");if(!o)throw new Qu("No token returned by API");return{signedUrl:s.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await wn(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await wn(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let a=n._getFinalPath(e),i=await wn(n.fetch,`${n.url}/object/sign/${a}`,Me({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${i.signedURL}${s}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const a=await wn(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a.map(s=>Me(Me({},s),{},{signedUrl:s.signedURL?encodeURI(`${n.url}${s.signedURL}${i}`):null}))})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=n?`?${n}`:"",i=this._getFinalPath(e),s=()=>gl(this.fetch,`${this.url}/${r}/${i}${a}`,{headers:this.headers,noResolveJson:!0});return new jI(s,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>wh(await gl(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await UI(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Zu(n)&&n instanceof E_){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const i=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});s!==""&&n.push(s);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await yp(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const a=Me(Me(Me({},$I),t),{},{prefix:e||""});return await wn(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=Me({},e);return await wn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const WI="2.93.3",Nl={"X-Client-Info":`storage-js/${WI}`};var HI=class extends Vs{constructor(e,t={},r,n){const a=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."));const i=a.href.replace(/\/$/,""),s=Me(Me({},Nl),t);super(i,s,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await gl(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await gl(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await wn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await yh(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await wn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await yp(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},VI=class extends Vs{constructor(e,t={},r){const n=e.replace(/\/$/,""),a=Me(Me({},Nl),t);super(n,a,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await wn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),a=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await gl(t.fetch,a,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await yp(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!RI(e))throw new Qu("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new AI({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(a,i){const s=a[i];return typeof s!="function"?s:async(...o)=>{try{return{data:await s.apply(a,o),error:null}}catch(l){if(n)throw l;return{data:null,error:l}}}}})}},GI=class extends Vs{constructor(e,t={},r){const n=e.replace(/\/$/,""),a=Me(Me({},Nl),{},{"Content-Type":"application/json"},t);super(n,a,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await zr.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await zr.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await zr.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await zr.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},qI=class extends Vs{constructor(e,t={},r){const n=e.replace(/\/$/,""),a=Me(Me({},Nl),{},{"Content-Type":"application/json"},t);super(n,a,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await zr.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await zr.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await zr.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await zr.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await zr.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},KI=class extends Vs{constructor(e,t={},r){const n=e.replace(/\/$/,""),a=Me(Me({},Nl),{},{"Content-Type":"application/json"},t);super(n,a,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await zr.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await zr.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await zr.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await zr.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},XI=class extends KI{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new YI(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},YI=class extends GI{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new JI(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},JI=class extends qI{constructor(e,t,r,n,a){super(e,t,a),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},QI=class extends HI{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new zI(this.url,this.headers,e,this.fetch)}get vectors(){return new XI(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new VI(this.url+"/iceberg",this.headers,this.fetch)}};const C_="2.93.3",Yi=30*1e3,_h=3,Xf=_h*Yi,ZI="http://localhost:9999",e5="supabase.auth.token",t5={"X-Client-Info":`gotrue-js/${C_}`},kh="X-Supabase-Api-Version",A_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},r5=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,n5=10*60*1e3;class vl extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ne(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class a5 extends vl{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function i5(e){return Ne(e)&&e.name==="AuthApiError"}class ni extends vl{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ca extends vl{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Br extends ca{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Yf(e){return Ne(e)&&e.name==="AuthSessionMissingError"}class Wi extends ca{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class xc extends ca{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class wc extends ca{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function s5(e){return Ne(e)&&e.name==="AuthImplicitGrantRedirectError"}class yg extends ca{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class o5 extends ca{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Sh extends ca{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Jf(e){return Ne(e)&&e.name==="AuthRetryableFetchError"}class _g extends ca{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Eh extends ca{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const xu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),kg=` 	
\r=`.split(""),l5=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<kg.length;t+=1)e[kg[t].charCodeAt(0)]=-2;for(let t=0;t<xu.length;t+=1)e[xu[t].charCodeAt(0)]=t;return e})();function Sg(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(xu[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(xu[n]),t.queuedBits-=6}}function F_(e,t,r){const n=l5[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Eg(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{f5(s,n,r)};for(let s=0;s<e.length;s+=1)F_(e.charCodeAt(s),a,i);return t.join("")}function c5(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function u5(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}c5(n,t)}}function f5(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Ss(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)F_(e.charCodeAt(a),r,n);return new Uint8Array(t)}function h5(e){const t=[];return u5(e,r=>t.push(r)),new Uint8Array(t)}function oi(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>Sg(a,r,n)),Sg(null,r,n),t.join("")}function d5(e){return Math.round(Date.now()/1e3)+e}function p5(){return Symbol("auth-callback")}const nr=()=>typeof window<"u"&&typeof document<"u",Xa={tested:!1,writable:!1},P_=()=>{if(!nr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Xa.tested)return Xa.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Xa.tested=!0,Xa.writable=!0}catch{Xa.tested=!0,Xa.writable=!1}return Xa.writable};function m5(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const R_=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),g5=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ji=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ya=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},tr=async(e,t)=>{await e.removeItem(t)};class ef{constructor(){this.promise=new ef.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}ef.promiseConstructor=Promise;function yc(e){const t=e.split(".");if(t.length!==3)throw new Eh("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!r5.test(t[n]))throw new Eh("JWT not in base64url format");return{header:JSON.parse(Eg(t[0])),payload:JSON.parse(Eg(t[1])),signature:Ss(t[2]),raw:{header:t[0],payload:t[1]}}}async function v5(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function x5(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await e(i);if(!t(i,null,s)){n(s);return}}catch(s){if(!t(i,s)){a(s);return}}})()})}function w5(e){return("0"+e.toString(16)).substr(-2)}function y5(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,w5).join("")}async function _5(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function k5(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await _5(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Hi(e,t,r=!1){const n=y5();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await Ji(e,`${t}-code-verifier`,a);const i=await k5(n);return[i,n===i?"plain":"s256"]}const S5=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function E5(e){const t=e.headers.get(kh);if(!t||!t.match(S5))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function T5(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function b5(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const C5=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Vi(e){if(!C5.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Qf(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function A5(e,t){return new Proxy(e,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,a)}})}function Tg(e){return JSON.parse(JSON.stringify(e))}const ei=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),F5=[502,503,504];async function bg(e){var t;if(!g5(e))throw new Sh(ei(e),0);if(F5.includes(e.status))throw new Sh(ei(e),e.status);let r;try{r=await e.json()}catch(i){throw new ni(ei(i),i)}let n;const a=E5(e);if(a&&a.getTime()>=A_["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new _g(ei(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Br}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new _g(ei(r),e.status,r.weak_password.reasons);throw new a5(ei(r),e.status||500,n)}const P5=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Ue(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[kh]||(i[kh]=A_["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await R5(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function R5(e,t,r,n,a,i){const s=P5(t,n,a,i);let o;try{o=await e(r,Object.assign({},s))}catch(l){throw console.error(l),new Sh(ei(l),0)}if(o.ok||await bg(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await bg(l)}}function vn(e){var t;let r=null;N5(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=d5(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Cg(e){const t=vn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function va(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function O5(e){return{data:e,error:null}}function I5(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,s=Mu(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},l=Object.assign({},s);return{data:{properties:o,user:l},error:null}}function Ag(e){return e}function N5(e){return e.access_token&&e.refresh_token&&e.expires_in}const Zf=["global","local","others"];class D5{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=R_(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Zf[0]){if(Zf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zf.join(", ")}`);try{return await Ue(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ne(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ue(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:va})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Mu(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Ue(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:I5,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ne(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ue(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:va})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,s,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ue(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:Ag});if(u.error)throw u.error;const f=await u.json(),p=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(m=>{const d=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(m.split(";")[1].split("=")[1]);c[`${v}Page`]=d}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Ne(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Vi(t);try{return await Ue(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:va})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Vi(t);try{return await Ue(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:va})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Vi(t);try{return await Ue(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:va})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Vi(t.userId);try{const{data:r,error:n}=await Ue(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Vi(t.userId),Vi(t.id);try{return{data:await Ue(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,i,s,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ue(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:Ag});if(u.error)throw u.error;const f=await u.json(),p=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(m=>{const d=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(m.split(";")[1].split("=")[1]);c[`${v}Page`]=d}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Ne(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Ue(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ue(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ue(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ne(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ue(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ue(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}}function Fg(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Gi={debug:!!(globalThis&&P_()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class O_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class L5 extends O_{}async function B5(e,t,r){Gi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Gi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Gi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Gi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Gi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new L5(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Gi.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function U5(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function I_(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function M5(e){return parseInt(e,16)}function j5(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function $5(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:i=new Date,nonce:s,notBefore:o,requestId:l,resources:c,scheme:u,uri:f,version:p}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(s&&s.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${s}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const h=I_(e.address),m=u?`${u}://${n}`:n,d=e.statement?`${e.statement}
`:"",v=`${m} wants you to sign in with your Ethereum account:
${h}

${d}`;let g=`URI: ${f}
Version: ${p}
Chain ID: ${r}${s?`
Nonce: ${s}`:""}
Issued At: ${i.toISOString()}`;if(a&&(g+=`
Expiration Time: ${a.toISOString()}`),o&&(g+=`
Not Before: ${o.toISOString()}`),l&&(g+=`
Request ID: ${l}`),c){let x=`
Resources:`;for(const w of c){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);x+=`
- ${w}`}g+=x}return`${v}
${g}`}class $t extends Error{constructor({message:t,code:r,cause:n,name:a}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=a??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class wu extends $t{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function z5({error:e,options:t}){var r,n,a;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $t({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new $t({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new $t({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new $t({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new $t({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new $t({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new $t({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new $t({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(N_(s)){if(i.rp.id!==s)return new $t({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new $t({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new $t({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new $t({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new $t({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function W5({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $t({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new $t({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(N_(n)){if(r.rpId!==n)return new $t({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new $t({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new $t({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new $t({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class H5{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const V5=new H5;function G5(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=Mu(e,["challenge","user","excludeCredentials"]),i=Ss(t).buffer,s=Object.assign(Object.assign({},r),{id:Ss(r.id).buffer}),o=Object.assign(Object.assign({},a),{challenge:i,user:s});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:Ss(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function q5(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Mu(e,["challenge","allowCredentials"]),a=Ss(t).buffer,i=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let s=0;s<r.length;s++){const o=r[s];i.allowCredentials[s]=Object.assign(Object.assign({},o),{id:Ss(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return i}function K5(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:oi(new Uint8Array(e.response.attestationObject)),clientDataJSON:oi(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function X5(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:oi(new Uint8Array(a.authenticatorData)),clientDataJSON:oi(new Uint8Array(a.clientDataJSON)),signature:oi(new Uint8Array(a.signature)),userHandle:a.userHandle?oi(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function N_(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Pg(){var e,t;return!!(nr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Y5(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new wu("Browser returned unexpected credential type",t)}:{data:null,error:new wu("Empty credential response",t)}}catch(t){return{data:null,error:z5({error:t,options:e})}}}async function J5(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new wu("Browser returned unexpected credential type",t)}:{data:null,error:new wu("Empty credential response",t)}}catch(t){return{data:null,error:W5({error:t,options:e})}}}const Q5={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Z5={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function yu(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const i in a){const s=a[i];if(s!==void 0)if(Array.isArray(s))n[i]=s;else if(r(s))n[i]=s;else if(t(s)){const o=n[i];t(o)?n[i]=yu(o,s):n[i]=yu(s)}else n[i]=s}return n}function eN(e,t){return yu(Q5,e,t||{})}function tN(e,t){return yu(Z5,e,t||{})}class rN{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},i){var s;try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const c=a??V5.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;if(!u.name){const f=n;if(f)u.name=`${u.id}:${f}`;else{const h=(await this.client.getUser()).data.user,m=((s=h==null?void 0:h.user_metadata)===null||s===void 0?void 0:s.name)||(h==null?void 0:h.email)||(h==null?void 0:h.id)||"User";u.name=`${u.id}:${m}`}}u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=eN(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:f,error:p}=await Y5({publicKey:u,signal:c});return f?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:p}}case"request":{const u=tN(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:f,error:p}=await J5(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:c}));return f?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:p}}}}catch(o){return Ne(o)?{data:null,error:o}:{data:null,error:new ni("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new vl("rpId is required for WebAuthn authentication")};try{if(!Pg())return{data:null,error:new ni("Browser does not support WebAuthn",null)};const{data:s,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:i});if(!s)return{data:null,error:o};const{webauthn:l}=s;return this._verify({factorId:t,challengeId:s.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(s){return Ne(s)?{data:null,error:s}:{data:null,error:new ni("Unexpected error in authenticate",s)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new vl("rpId is required for WebAuthn registration")};try{if(!Pg())return{data:null,error:new ni("Browser does not support WebAuthn",null)};const{data:s,error:o}=await this._enroll({friendlyName:t});if(!s)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===t&&p.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:s.id,friendlyName:s.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:i});return l?this._verify({factorId:s.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(s){return Ne(s)?{data:null,error:s}:{data:null,error:new ni("Unexpected error in register",s)}}}}U5();const nN={url:ZI,storageKey:e5,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:t5,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Rg(e,t,r){return await r()}const qi={};class xl{get jwks(){var t,r;return(r=(t=qi[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){qi[this.storageKey]=Object.assign(Object.assign({},qi[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=qi[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){qi[this.storageKey]=Object.assign(Object.assign({},qi[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},nN),t);if(this.storageKey=i.storageKey,this.instanceID=(r=xl.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,xl.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&nr()){const s=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(s),this.logDebugMessages&&console.trace(s)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new D5({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=R_(i.fetch),this.lock=i.lock||Rg,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&nr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=B5:this.lock=Rg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new rN(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:P_()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Fg(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Fg(this.memoryStorage)),nr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s);try{await this._notifyAllSubscribers(s.data.event,s.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}this.initialize().catch(s=>{this._debug("#initialize()","error",s)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${C_}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(nr()&&(r=m5(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),nr()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),s5(i)){const l=(t=i.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:s,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ne(r)?this._returnResult({error:r}):this._returnResult({error:new ni("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:vn}),{data:s,error:o}=i;if(o||!s)return this._returnResult({data:{user:null,session:null},error:o});const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(Ne(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:u,password:f,options:p}=t;let h=null,m=null;this.flowType==="pkce"&&([h,m]=await Hi(this.storage,this.storageKey)),i=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:u,password:f,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:h,code_challenge_method:m},xform:vn})}else if("phone"in t){const{phone:u,password:f,options:p}=t;i=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(a=p==null?void 0:p.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:vn})}else throw new xc("You must provide either an email or phone number and a password");const{data:s,error:o}=i;if(o||!s)return await tr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:s,options:o}=t;r=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Cg})}else if("phone"in t){const{phone:i,password:s,options:o}=t;r=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Cg})}else throw new xc("You must provide either an email or phone number and a password");const{data:n,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const i=new Wi;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,i,s,o,l,c,u,f,p;let h,m;if("message"in t)h=t.message,m=t.signature;else{const{chain:d,wallet:v,statement:g,options:x}=t;let w;if(nr())if(typeof v=="object")w=v;else{const C=window;if("ethereum"in C&&typeof C.ethereum=="object"&&"request"in C.ethereum&&typeof C.ethereum.request=="function")w=C.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=v}const _=new URL((r=x==null?void 0:x.url)!==null&&r!==void 0?r:window.location.href),S=await w.request({method:"eth_requestAccounts"}).then(C=>C).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=I_(S[0]);let k=(n=x==null?void 0:x.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!k){const C=await w.request({method:"eth_chainId"});k=M5(C)}const R={domain:_.host,address:E,statement:g,uri:_.href,version:"1",chainId:k,nonce:(a=x==null?void 0:x.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(s=(i=x==null?void 0:x.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&s!==void 0?s:new Date,expirationTime:(o=x==null?void 0:x.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=x==null?void 0:x.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=x==null?void 0:x.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=x==null?void 0:x.signInWithEthereum)===null||u===void 0?void 0:u.resources};h=$5(R),m=await w.request({method:"personal_sign",params:[j5(h),E]})}try{const{data:d,error:v}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:m},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:vn});if(v)throw v;if(!d||!d.session||!d.user){const g=new Wi;return this._returnResult({data:{user:null,session:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign({},d),error:v})}catch(d){if(Ne(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithSolana(t){var r,n,a,i,s,o,l,c,u,f,p,h;let m,d;if("message"in t)m=t.message,d=t.signature;else{const{chain:v,wallet:g,statement:x,options:w}=t;let _;if(nr())if(typeof g=="object")_=g;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))_=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=g}const S=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const E=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),x?{statement:x}:null));let k;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")k=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)k=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)m=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),d=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${S.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(a=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((f=(u=w==null?void 0:w.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...w.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const E=await _.signMessage(new TextEncoder().encode(m),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");d=E}}try{const{data:v,error:g}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:oi(d)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:vn});if(g)throw g;if(!v||!v.session||!v.user){const x=new Wi;return this._returnResult({data:{user:null,session:null},error:x})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:g})}catch(v){if(Ne(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(t){const r=await Ya(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new o5;const{data:i,error:s}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:vn});if(await tr(this.storage,`${this.storageKey}-code-verifier`),s)throw s;if(!i||!i.session||!i.user){const o=new Wi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=t,o=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:vn}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new Wi;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(r){if(Ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,a,i,s;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Hi(this.storage,this.storageKey));const{error:f}=await Ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u})}throw new xc("You must provide either an email or phone number.")}catch(o){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await Ue(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:vn});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,c=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(a){if(Ne(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,n,a,i,s;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await Hi(this.storage,this.storageKey));const c=await Ue(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:O5});return!((i=c.data)===null||i===void 0)&&i.url&&nr()&&!(!((s=t.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Br;const{error:a}=await Ue(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(Ne(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:s}=await Ue(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:s})}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:s,error:o}=await Ue(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:o})}throw new xc("You must provide either an email or phone number and a type")}catch(r){if(Ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ya(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Xf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const s=await Ya(this.userStorage,this.storageKey+"-user");s!=null&&s.user?t.user=s.user:t.user=Qf()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const s={value:this.suppressGetSessionWarning};t.user=A5(t.user,s),s.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:va}):await this._useSession(async r=>{var n,a,i;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Br}:await Ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:va})})}catch(r){if(Ne(r))return Yf(r)&&(await this._removeSession(),await tr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new Br;const s=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Hi(this.storage,this.storageKey));const{data:c,error:u}=await Ue(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:s.access_token,xform:va});if(u)throw u;return s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),this._returnResult({data:{user:s.user},error:null})})}catch(n){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Br;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=yc(t.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(Ne(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:o}=r;if(o)throw o;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Br;const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!nr())throw new wc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new wc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new yg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new yg("No code detected.");const{data:x,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:o,expires_at:l,token_type:c}=t;if(!i||!o||!s||!c)throw new wc("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let p=u+f;l&&(p=parseInt(l));const h=p-u;h*1e3<=Yi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const m=p-f;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,p,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,p,u);const{data:d,error:v}=await this._getUser(i);if(v)throw v;const g={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:p,refresh_token:s,token_type:c,user:d.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:t.type},error:null})}catch(n){if(Ne(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ya(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i&&!Yf(i))return this._returnResult({error:i});const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,t);if(o&&!(i5(o)&&(o.status===404||o.status===401||o.status===403)||Yf(o)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await tr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=p5(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Hi(this.storage,this.storageKey,!0));try{return await Ue(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,o,l,c,u;const{data:f,error:p}=i;if(p)throw p;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Ue(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return nr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Ne(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:i}}=r;if(a)throw a;const{options:s,provider:o,token:l,access_token:c,nonce:u}=t,f=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i==null?void 0:i.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:vn}),{data:p,error:h}=f;return h?this._returnResult({data:{user:null,session:null},error:h}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new Wi}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:h}))}catch(a){if(await tr(this.storage,`${this.storageKey}-code-verifier`),Ne(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await Ue(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await x5(async a=>(a>0&&await v5(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Ue(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:vn})),(a,i)=>{const s=200*Math.pow(2,a);return i&&Jf(i)&&Date.now()+s-n<Yi})}catch(n){if(this._debug(r,"error",n),Ne(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),nr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Ya(this.storage,this.storageKey);if(a&&this.userStorage){let s=await Ya(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:a.user},await Ji(this.userStorage,this.storageKey+"-user",s)),a.user=(t=s==null?void 0:s.user)!==null&&t!==void 0?t:Qf()}else if(a&&!a.user&&!a.user){const s=await Ya(this.storage,this.storageKey+"-user");s&&(s!=null&&s.user)?(a.user=s.user,await tr(this.storage,this.storageKey+"-user"),await Ji(this.storage,this.storageKey,a)):a.user=Qf()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Xf;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Xf}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),Jf(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:o}=await this._getUser(a.access_token);!o&&(s!=null&&s.user)?(a.user=s.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Br;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new ef;const{data:i,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new Br;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={data:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(a,"error",i),Ne(i)){const s={data:null,error:i};return Jf(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){i.push(l)}});if(await Promise.all(s),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await tr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ji(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=Tg(a);await Ji(this.storage,this.storageKey,i)}else{const a=Tg(r);await Ji(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await tr(this.storage,this.storageKey),await tr(this.storage,this.storageKey+"-code-verifier"),await tr(this.storage,this.storageKey+"-user"),this.userStorage&&await tr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&nr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Yi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Yi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Yi}ms, refresh threshold is ${_h} ticks`),a<=_h&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof O_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!nr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await Hi(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?this._returnResult({data:null,error:i}):await Ue(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:c}=await Ue(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&l.type==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const s=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?K5(t.webauthn.credential_response):X5(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:l}=await Ue(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:s,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const s=await Ue(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(s.error)return s;const{data:o}=s;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:G5(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:q5(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,a,i;if(t)try{const{payload:h}=yc(t);let m=null;h.aal&&(m=h.aal);let d=m;const{data:{user:v},error:g}=await this.getUser(t);if(g)return this._returnResult({data:null,error:g});((n=(r=v==null?void 0:v.factors)===null||r===void 0?void 0:r.filter(_=>_.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(d="aal2");const w=h.amr||[];return{data:{currentLevel:m,nextLevel:d,currentAuthenticationMethods:w},error:null}}catch(h){if(Ne(h))return this._returnResult({data:null,error:h});throw h}const{data:{session:s},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=yc(s.access_token);let c=null;l.aal&&(c=l.aal);let u=c;((i=(a=s.user.factors)===null||a===void 0?void 0:a.filter(h=>h.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(u="aal2");const p=l.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:p},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await Ue(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Br})})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Br});const s=await Ue(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return s.data&&s.data.redirect_url&&nr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(Ne(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Br});const s=await Ue(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return s.data&&s.data.redirect_url&&nr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(Ne(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Ue(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Br})})}catch(t){if(Ne(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?(await Ue(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Br})})}catch(r){if(Ne(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+n5>a)return n;const{data:i,error:s}=await Ue(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:h,error:m}=await this.getSession();if(m||!h.session)return this._returnResult({data:null,error:m});n=h.session.access_token}const{header:a,payload:i,signature:s,raw:{header:o,payload:l}}=yc(n);r!=null&&r.allowExpired||T5(i.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:a,signature:s},error:null}}const u=b5(a.alg),f=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,s,h5(`${o}.${l}`)))throw new Eh("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(Ne(n))return this._returnResult({data:null,error:n});throw n}}}xl.nextInstanceID={};const aN=xl,iN="2.93.3";let ho="";typeof Deno<"u"?ho="deno":typeof document<"u"?ho="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ho="react-native":ho="node";const sN={"X-Client-Info":`supabase-js-${ho}/${iN}`},oN={headers:sN},lN={schema:"public"},cN={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},uN={};function wl(e){"@babel/helpers - typeof";return wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wl(e)}function fN(e,t){if(wl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(wl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hN(e){var t=fN(e,"string");return wl(t)=="symbol"?t:t+""}function dN(e,t,r){return(t=hN(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Og(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function At(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Og(Object(r),!0).forEach(function(n){dN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Og(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const pN=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),mN=()=>Headers,gN=(e,t,r)=>{const n=pN(r),a=mN();return async(i,s)=>{var o;const l=(o=await t())!==null&&o!==void 0?o:e;let c=new a(s==null?void 0:s.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,At(At({},s),{},{headers:c}))}};function vN(e){return e.endsWith("/")?e:e+"/"}function xN(e,t){var r,n;const{db:a,auth:i,realtime:s,global:o}=e,{db:l,auth:c,realtime:u,global:f}=t,p={db:At(At({},l),a),auth:At(At({},c),i),realtime:At(At({},u),s),storage:{},global:At(At(At({},f),o),{},{headers:At(At({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}function wN(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(vN(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var yN=class extends aN{constructor(e){super(e)}},_N=class{constructor(e,t,r){var n,a;this.supabaseUrl=e,this.supabaseKey=t;const i=wN(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const s=`sb-${i.hostname.split(".")[0]}-auth-token`,o={db:lN,realtime:uN,auth:At(At({},cN),{},{storageKey:s}),global:oN},l=xN(r??{},o);if(this.storageKey=(n=l.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=l.global.headers)!==null&&a!==void 0?a:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(u,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=gN(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(At({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new iI(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new QI(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new eI(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,storageKey:i,flowType:s,lock:o,debug:l,throwOnError:c},u,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new yN({url:this.authUrl.href,headers:At(At({},p),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,flowType:s,lock:o,debug:l,throwOnError:c,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new kI(this.realtimeUrl.href,At(At({},e),{},{params:At(At({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const kN=(e,t,r)=>new _N(e,t,r);function SN(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}SN()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const e0="rmr_cop_user_auth",t0="rmr_cop_user_data",EN="https://ggaldcxmnafqufjqxcvz.supabase.co",TN="sb_publishable_KJT6A162DaR_AUGL34Ubmw_9dyUBYVA",bN="dbbb0954-8591-45a7-8b1a-a4eb07ee8941";let Th=null;Th=kN(EN,TN);class CN{isAuthenticated(){return localStorage.getItem(e0)==="true"}getCurrentUser(){const t=localStorage.getItem(t0);if(t)try{return JSON.parse(t)}catch{return null}return null}getUserRole(){const t=this.getCurrentUser();return(t==null?void 0:t.role)||"user"}canDelete(){const t=this.getUserRole();return t==="admin"||t==="user"}isAdmin(){return this.getUserRole()==="admin"}async login(t,r){if(!Th)return{success:!1,error:"Database connection not configured. Contact administrator."};try{const{data:n,error:a}=await Th.from("app_users").select("*").eq("app_id",bN).eq("username",t.toLowerCase().trim()).eq("pin",r.trim()).eq("is_active",!0).single();return a&&a.code!=="PGRST116"?(console.error("Login error:",a),{success:!1,error:"Login failed. Please try again."}):n?(localStorage.setItem(e0,"true"),localStorage.setItem(t0,JSON.stringify({id:n.id,username:n.username,display_name:n.display_name,role:n.role})),{success:!0,user:n}):{success:!1,error:"Invalid username or PIN."}}catch(n){return console.error("Login error:",n),{success:!1,error:"Network error. Please check your connection."}}}logout(){localStorage.removeItem(e0),localStorage.removeItem(t0)}}const D_=new CN;function AN({onLoginSuccess:e}){const[t,r]=fe.useState(""),[n,a]=fe.useState(""),[i,s]=fe.useState(null),[o,l]=fe.useState(!1),c=async f=>{f.preventDefault(),s(null),l(!0);try{const p=await D_.login(t,n);p.success?e(p.user):(s(p.error||"Invalid username or PIN."),a(""))}catch{s("Login failed. Please try again."),a("")}finally{l(!1)}},u=t.trim().length>0&&n.length>=4;return D.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",padding:"20px"},children:D.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"40px",maxWidth:"400px",width:"100%",boxShadow:"0 8px 32px rgba(0,0,0,0.1)",textAlign:"center"},children:[D.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:""}),D.jsx("h1",{style:{fontSize:"24px",marginBottom:"12px",color:"#1976d2"},children:"Access RMR COP App"}),D.jsx("p",{style:{color:"#666",marginBottom:"32px",fontSize:"14px"},children:"Enter your credentials to continue"}),D.jsxs("form",{onSubmit:c,children:[D.jsx("input",{type:"text",value:t,onChange:f=>r(f.target.value),placeholder:"Username",autoFocus:!0,autoComplete:"username",autoCapitalize:"off",style:{width:"100%",padding:"14px 16px",fontSize:"16px",textAlign:"left",borderRadius:"8px",border:"2px solid #ddd",marginBottom:"12px",boxSizing:"border-box"}}),D.jsx("input",{type:"tel",pattern:"[0-9]*",inputMode:"numeric",value:n,onChange:f=>a(f.target.value),placeholder:"PIN",maxLength:"6",autoComplete:"current-password",style:{width:"100%",padding:"14px 16px",fontSize:"20px",textAlign:"center",borderRadius:"8px",border:"2px solid #ddd",marginBottom:"20px",letterSpacing:"4px",boxSizing:"border-box"}}),i&&D.jsx("div",{style:{color:"#c62828",marginBottom:"20px",fontSize:"14px",padding:"10px",background:"#ffebee",borderRadius:"6px"},children:i}),D.jsx("button",{type:"submit",disabled:!u||o,style:{width:"100%",padding:"14px 24px",background:u&&!o?"#1976d2":"#ccc",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"600",cursor:u&&!o?"pointer":"not-allowed"},children:o?"Signing in...":"Sign In"})]}),D.jsx("p",{style:{marginTop:"24px",fontSize:"12px",color:"#999"},children:"Contact your administrator if you need access"})]})})}class Ig extends Ph.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("App Error:",t,r)}render(){var t;return this.state.hasError?D.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[D.jsx("h1",{children:" Something went wrong"}),D.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:((t=this.state.error)==null?void 0:t.message)||"An unexpected error occurred"}),D.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"12px 24px",backgroundColor:"#1976d2",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",cursor:"pointer"},children:"Reload App"})]}):this.props.children}}function FN(){const[e,t]=fe.useState(D_.isAuthenticated()),[r,n]=fe.useState(!0),[a,i]=fe.useState([]),[s,o]=fe.useState(null);fe.useEffect(()=>{l(),mi.init()},[e]);const l=async()=>{try{await $E.initialize(),e?await c():n(!1)}catch(h){console.error("Initialization error:",h),o(h.message),n(!1)}},c=async()=>{try{n(!0),console.log("Loading data from SharePoint via Service Account...");const[h,m]=await Promise.all([wt.loadSiteDetails(),wt.loadPhotoRequirements()]);console.log(`Loaded ${h.length} sites from SharePoint`),console.log(`Loaded ${m.length} photo requirements from SharePoint`),await ze.saveSites(h),await ze.savePhotoRequirements(m),i(h)}catch(h){console.error("Error loading from SharePoint:",h);const m=await ze.getSites();m.length>0?(console.log("Using cached data due to SharePoint error"),i(m)):o(`Failed to load data from SharePoint: ${h.message}`)}finally{n(!1)}},u=async()=>{await c()},f=()=>{t(!0)},p=async h=>{i(h),await ze.saveSites(h)};return r&&e?D.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)"},children:D.jsxs("div",{style:{textAlign:"center",color:"white",padding:"20px"},children:[D.jsx("div",{className:"spinner",style:{width:"40px",height:"40px",border:"4px solid rgba(255,255,255,0.3)",borderTop:"4px solid white",borderRadius:"50%",margin:"0 auto 16px auto",animation:"spin 1s linear infinite"}}),D.jsx("h2",{children:"Connecting to SharePoint..."}),D.jsx("p",{children:"Downloading Site List and Photo Requirements"}),D.jsx("p",{style:{fontSize:"12px",opacity:.8,marginTop:"8px"},children:"Using Service Account"}),D.jsx("style",{children:"@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }"})]})}):s?D.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"20px"},children:D.jsxs("div",{style:{textAlign:"center",maxWidth:"400px"},children:[D.jsx("h2",{style:{color:"#c62828",marginBottom:"16px"},children:" Error"}),D.jsx("p",{style:{marginBottom:"20px"},children:s}),D.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[D.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary",style:{padding:"12px 24px"},children:"Retry"}),D.jsx("button",{onClick:()=>{o(null),n(!1)},className:"btn btn-secondary",style:{padding:"12px 24px"},children:"Ignore & Continue"})]})]})}):e?D.jsx(Ig,{children:D.jsx("div",{className:"app-main-wrapper",style:{display:"flex",flexDirection:"column",height:"100vh"},children:D.jsx(yE,{children:D.jsxs(dE,{children:[D.jsx(Za,{path:"/",element:D.jsx(UE,{sites:a,onRefresh:u})}),D.jsx(Za,{path:"/admin",element:D.jsx(J6,{onDataLoaded:p})}),D.jsx(Za,{path:"/site/:siteId",element:D.jsx(K6,{})}),D.jsx(Za,{path:"/site/:siteId/photo/:photoReqId",element:D.jsx(X6,{})}),D.jsx(Za,{path:"/site/:siteId/questionnaire",element:D.jsx(Y6,{})}),D.jsx(Za,{path:"*",element:D.jsx(fE,{to:"/",replace:!0})})]})})})}):D.jsx(Ig,{children:D.jsx(AN,{onLoginSuccess:f})})}r0.createRoot(document.getElementById("root")).render(D.jsx(Ph.StrictMode,{children:D.jsx(FN,{})}));
